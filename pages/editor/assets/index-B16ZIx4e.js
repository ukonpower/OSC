var Df=Object.defineProperty;var Ff=(e,t,n)=>t in e?Df(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var c=(e,t,n)=>Ff(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Nf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ou={exports:{}},xs={},Vu={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zi=Symbol.for("react.element"),If=Symbol.for("react.portal"),Bf=Symbol.for("react.fragment"),Af=Symbol.for("react.strict_mode"),bf=Symbol.for("react.profiler"),Lf=Symbol.for("react.provider"),Uf=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),Of=Symbol.for("react.suspense"),Vf=Symbol.for("react.memo"),Gf=Symbol.for("react.lazy"),fl=Symbol.iterator;function Wf(e){return e===null||typeof e!="object"?null:(e=fl&&e[fl]||e["@@iterator"],typeof e=="function"?e:null)}var Gu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wu=Object.assign,Hu={};function Jn(e,t,n){this.props=e,this.context=t,this.refs=Hu,this.updater=n||Gu}Jn.prototype.isReactComponent={};Jn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $u(){}$u.prototype=Jn.prototype;function ma(e,t,n){this.props=e,this.context=t,this.refs=Hu,this.updater=n||Gu}var pa=ma.prototype=new $u;pa.constructor=ma;Wu(pa,Jn.prototype);pa.isPureReactComponent=!0;var hl=Array.isArray,Xu=Object.prototype.hasOwnProperty,va={current:null},Ku={key:!0,ref:!0,__self:!0,__source:!0};function Yu(e,t,n){var i,r={},s=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Xu.call(t,i)&&!Ku.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Zi,type:e,key:s,ref:o,props:r,_owner:va.current}}function Hf(e,t){return{$$typeof:Zi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ga(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zi}function $f(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ml=/\/+/g;function Ls(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$f(""+e.key):t.toString(36)}function Mr(e,t,n,i,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Zi:case If:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+Ls(o,0):i,hl(r)?(n="",e!=null&&(n=e.replace(ml,"$&/")+"/"),Mr(r,t,n,"",function(u){return u})):r!=null&&(ga(r)&&(r=Hf(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(ml,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",hl(e))for(var a=0;a<e.length;a++){s=e[a];var l=i+Ls(s,a);o+=Mr(s,t,n,l,r)}else if(l=Wf(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=i+Ls(s,a++),o+=Mr(s,t,n,l,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function rr(e,t,n){if(e==null)return e;var i=[],r=0;return Mr(e,i,"","",function(s){return t.call(n,s,r++)}),i}function Xf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Re={current:null},Rr={transition:null},Kf={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:Rr,ReactCurrentOwner:va};function Qu(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:rr,forEach:function(e,t,n){rr(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return rr(e,function(){t++}),t},toArray:function(e){return rr(e,function(t){return t})||[]},only:function(e){if(!ga(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};G.Component=Jn;G.Fragment=Bf;G.Profiler=bf;G.PureComponent=ma;G.StrictMode=Af;G.Suspense=Of;G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kf;G.act=Qu;G.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Wu({},e.props),r=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=va.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Xu.call(t,l)&&!Ku.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:Zi,type:e.type,key:r,ref:s,props:i,_owner:o}};G.createContext=function(e){return e={$$typeof:Uf,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lf,_context:e},e.Consumer=e};G.createElement=Yu;G.createFactory=function(e){var t=Yu.bind(null,e);return t.type=e,t};G.createRef=function(){return{current:null}};G.forwardRef=function(e){return{$$typeof:jf,render:e}};G.isValidElement=ga;G.lazy=function(e){return{$$typeof:Gf,_payload:{_status:-1,_result:e},_init:Xf}};G.memo=function(e,t){return{$$typeof:Vf,type:e,compare:t===void 0?null:t}};G.startTransition=function(e){var t=Rr.transition;Rr.transition={};try{e()}finally{Rr.transition=t}};G.unstable_act=Qu;G.useCallback=function(e,t){return Re.current.useCallback(e,t)};G.useContext=function(e){return Re.current.useContext(e)};G.useDebugValue=function(){};G.useDeferredValue=function(e){return Re.current.useDeferredValue(e)};G.useEffect=function(e,t){return Re.current.useEffect(e,t)};G.useId=function(){return Re.current.useId()};G.useImperativeHandle=function(e,t,n){return Re.current.useImperativeHandle(e,t,n)};G.useInsertionEffect=function(e,t){return Re.current.useInsertionEffect(e,t)};G.useLayoutEffect=function(e,t){return Re.current.useLayoutEffect(e,t)};G.useMemo=function(e,t){return Re.current.useMemo(e,t)};G.useReducer=function(e,t,n){return Re.current.useReducer(e,t,n)};G.useRef=function(e){return Re.current.useRef(e)};G.useState=function(e){return Re.current.useState(e)};G.useSyncExternalStore=function(e,t,n){return Re.current.useSyncExternalStore(e,t,n)};G.useTransition=function(){return Re.current.useTransition()};G.version="18.3.1";Vu.exports=G;var S=Vu.exports;const Gr=Nf(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yf=S,Qf=Symbol.for("react.element"),Zf=Symbol.for("react.fragment"),qf=Object.prototype.hasOwnProperty,Jf=Yf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eh={key:!0,ref:!0,__self:!0,__source:!0};function Zu(e,t,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)qf.call(t,i)&&!eh.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:Qf,type:e,key:s,ref:o,props:r,_owner:Jf.current}}xs.Fragment=Zf;xs.jsx=Zu;xs.jsxs=Zu;Ou.exports=xs;var m=Ou.exports;const th="_arrow_1rhr5_45",nh={arrow:th},ya=({open:e})=>m.jsx("div",{className:nh.arrow,"data-open":e,children:m.jsxs("svg",{width:"10",height:"10",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("g",{clipPath:"url(#clip0_57_2)",children:m.jsx("path",{d:"M18 10L3 18.6603L3 1.33974L18 10Z",fill:"#D9D9D9"})}),m.jsx("defs",{children:m.jsx("clipPath",{id:"clip0_57_2",children:m.jsx("rect",{width:"20",height:"20",fill:"white"})})})]})}),ih="_block_1l63f_45",rh="_head_1l63f_58",sh="_head_icon_1l63f_63",oh="_head_text_1l63f_72",ah="_content_1l63f_79",si={block:ih,head:rh,head_icon:sh,head_text:oh,content:ah},Hn=e=>{const[t,n]=Gr.useState(!e.defaultClose),i=S.useCallback(()=>{e.accordion===!0&&n(!t)},[t,e.accordion]),r=e.bg&&typeof e.bg=="string"&&e.bg||void 0;return m.jsxs("div",{className:si.block,"data-bg":e.bg!==void 0,"data-nomargin":e.noMargin,"data-no_indent":e.noIndent,style:{backgroundColor:r},children:[m.jsxs("div",{className:si.head,"data-accordion":e.accordion,"data-open":t,children:[e.accordion&&m.jsx("div",{className:si.head_icon,onClick:i,children:m.jsx(ya,{open:t})}),e.label&&m.jsx("span",{className:si.head_text,children:e.label})]}),t&&m.jsx("div",{className:si.content,"data-open":t,"data-no_indent":e.noIndent,children:e.children})]})},lh="_button_fci8n_45",uh={button:lh},fn=e=>m.jsx("button",{className:uh.button,onClick:t=>{e.onClick&&e.onClick(t),t.preventDefault()},type:e.type||"button",disabled:e.disabled,children:e.children}),ch=S.createContext(null),Us={didCatch:!1,error:null};class dh extends S.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Us}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(n=(i=this.props).onReset)===null||n===void 0||n.call(i,{args:s,reason:"imperative-api"}),this.setState(Us)}}componentDidCatch(t,n){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,t,n)}componentDidUpdate(t,n){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&n.error!==null&&fh(t.resetKeys,r)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:r,prev:t.resetKeys,reason:"keys"}),this.setState(Us)}}render(){const{children:t,fallbackRender:n,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let a=t;if(s){const l={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")a=n(l);else if(i)a=S.createElement(i,l);else if(r!==void 0)a=r;else throw o}return S.createElement(ch.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},a)}}function fh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,i)=>!Object.is(n,t[i]))}const hh="_mouseMenu_11xi2_1",mh="_hide_11xi2_10",ph="_menuItem_11xi2_19",vh="_menuItem_inner_11xi2_23",gh="_menuItem_inner_inner_11xi2_26",oi={mouseMenu:hh,hide:mh,menuItem:ph,menuItem_inner:vh,menuItem_inner_inner:gh},qu=S.createContext(void 0),Ju=S.createContext(null),xa=()=>{const e=S.useContext(Ju);if(e===null)throw new Error("useMouseMenu must be used within a MouseMenuProvider");return e},pl=()=>{const{itemList:e,containerRef:t,closeAll:n}=xa();return m.jsxs("div",{className:oi.mouseMenu,ref:t,children:[e&&e.length>0&&m.jsx("div",{className:oi.hide,onClick:()=>{n&&n()}}),e&&e.map((i,r)=>{const s=i.pos;return m.jsx(qu.Provider,{value:i,children:m.jsx("div",{className:oi.menuItem,style:{left:0,top:0,transform:`translate(${s.x}px, ${s.y}px)`},children:m.jsx("div",{className:oi.menuItem_inner,children:m.jsx("div",{className:oi.menuItem_inner_inner,"data-direction":i.direction,children:i.elm})})})},i.id)})]})};let yh=0;const xh=()=>{const e=S.useRef(null),t=S.useRef({x:0,y:0}),n=S.useCallback(u=>{t.current.x=u.clientX,t.current.y=u.clientY},[]);S.useEffect(()=>(window.addEventListener("pointermove",n),()=>{window.removeEventListener("pointermove",n)}),[n]);const[i,r]=S.useState([]),s=S.useRef(i);s.current=i;const o=S.useCallback(u=>{s.current=s.current.filter(d=>d.id!==u),r(s.current)},[]),a=S.useCallback(()=>{r([])},[]),l=S.useCallback(u=>{const d=yh++,h={x:t.current.x,y:t.current.y},f=(h.x<window.innerWidth/2?"right":"left")+"-"+(h.y<window.innerHeight/2?"bottom":"top"),v={id:d,elm:u,pos:h,direction:f,close:()=>o(d)};return r([...s.current,v]),v},[o]);return{itemList:i,pushContent:l,closeAll:a,containerRef:e}},_h="_panel_vqys8_45",wh="_panel_inner_vqys8_51",Sh="_content_vqys8_59",js={panel:_h,panel_inner:wh,content:Sh},Ue=e=>m.jsx("div",{className:js.panel,style:{backgroundColor:e.bgColor},children:m.jsx("div",{className:js.panel_inner,children:m.jsx("div",{className:js.content,style:{padding:e.noPadding?"0 0":void 0},children:e.children})})}),Ch="_panelContainer_xa08o_45",Eh="_header_xa08o_54",Th="_header_item_xa08o_60",zh="_content_xa08o_75",sr={panelContainer:Ch,header:Eh,header_item:Th,content:zh},ft=e=>{const[t,n]=S.useState(0);let i=e.children||[];return i=Array.isArray(i)?i:[i],m.jsxs("div",{className:sr.panelContainer,children:[m.jsx("div",{className:sr.header,children:i.map((r,s)=>m.jsx("div",{className:sr.header_item,onClick:()=>n(s),"data-active":s==t,children:m.jsx("p",{children:r.props.title})},s))}),m.jsx("div",{className:sr.content,children:i[t]})]})},Ph="_splitContainer_1a8nd_45",kh="_horizontal_1a8nd_52",Mh="_vertical_1a8nd_55",Rh="_pane_1a8nd_59",Dh="_splitter_1a8nd_65",Fh="_dragging_1a8nd_74",wn={splitContainer:Ph,horizontal:kh,vertical:Mh,pane:Rh,splitter:Dh,dragging:Fh},Dt=e=>{const{children:t,direction:n,sizes:i,minSizes:r=[],storageKey:s,splitterSize:o=4,enableTouch:a=!0}=e,l=S.Children.toArray(t),u=l.length,d=S.useRef(null),[h,f]=S.useState(null),[v,x]=S.useState([]);S.useEffect(()=>{if(s){const w=localStorage.getItem(s);if(w)try{const E=JSON.parse(w);if(E.length===u){x(E);return}}catch(E){console.warn("Failed to parse saved sizes:",E)}}const y=i&&i.length===u?i:new Array(u).fill(1);x(y)},[s,i,u]);const _=S.useCallback(y=>{x(y),s&&localStorage.setItem(s,JSON.stringify(y))},[s]),z=S.useCallback((y,w)=>{y.preventDefault(),f(w);const E=n==="horizontal"?"touches"in y?y.touches[0].clientX:y.clientX:"touches"in y?y.touches[0].clientY:y.clientY,k=d.current?n==="horizontal"?d.current.clientWidth:d.current.clientHeight:0,C=o*(u-1),T=k-C,F=v.map((V,me)=>{if(typeof V=="string")return V.endsWith("px")?parseFloat(V):V.endsWith("%")?parseFloat(V)/100*T:parseFloat(V)||0;const H=d.current&&d.current.children[me*2];return H?n==="horizontal"?H.clientWidth:H.clientHeight:0}),D=V=>{const H=(n==="horizontal"?"touches"in V?V.touches[0].clientX:V.clientX:"touches"in V?V.touches[0].clientY:V.clientY)-E,Ce=[...F];Ce[w]=F[w]+H,Ce[w+1]=F[w+1]-H;const tt=r[w]||50,Le=r[w+1]||50;Ce[w]<tt?(Ce[w]=tt,Ce[w+1]=F[w]+F[w+1]-tt):Ce[w+1]<Le&&(Ce[w+1]=Le,Ce[w]=F[w]+F[w+1]-Le);const N=[...v];N[w]=Ce[w],N[w+1]=Ce[w+1],_(N)},L=()=>{f(null),window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",D),window.removeEventListener("touchend",L)};window.addEventListener("mousemove",D),window.addEventListener("mouseup",L),a&&(window.addEventListener("touchmove",D),window.addEventListener("touchend",L))},[n,o,u,v,r,_,a]),g=[];l.forEach((y,w)=>{const E=v[w]||1,k={flex:typeof E=="string"?void 0:E,width:typeof E=="string"&&n==="horizontal"?E:void 0,height:typeof E=="string"&&n==="vertical"?E:void 0,minWidth:n==="horizontal"&&r[w]?r[w]+"px":void 0,minHeight:n==="vertical"&&r[w]?r[w]+"px":void 0};if(g.push(m.jsx("div",{className:wn.pane,style:k,children:y},`pane-${w}`)),w<u-1){const C=[wn.splitter,wn[n],h===w?wn.dragging:""].join(" "),T=n==="horizontal"?{width:o+"px"}:{height:o+"px"};g.push(m.jsx("div",{className:C,style:T,onMouseDown:F=>z(F,w),onTouchStart:a?F=>z(F,w):void 0},`splitter-${w}`))}});const p=[wn.splitContainer,wn[n]].join(" ");return m.jsx("div",{ref:d,className:p,children:g})},ec=S.createContext(void 0),_a=(e,t)=>{const[n,i]=S.useState(()=>e?e.serialize():{}),r=t?[...t]:[],s=S.useMemo(()=>r,r);return S.useEffect(()=>{if(e===void 0)return;i(e.serialize());const o=a=>{let l=s.length==0;for(let u=0;u<s.length;u++)if(a.find(d=>d==s[u])){l=!0;break}l&&i(e.serialize())};return e.on("fields/update",o),()=>{e.off("fields/update",o)}},[e,s]),{fields:n}},Nh=e=>(_a(e.target),{target:e.target}),Ih=()=>{const e=S.useContext(ec);if(!e)throw new Error("SerializeFieldViewContext is not defined");return e},Bh="_container_1xcsu_45",Ah="_label_1xcsu_55",bh="_item_1xcsu_62",Os={container:Bh,label:Ah,item:bh},Ke=e=>m.jsxs("div",{className:Os.container,"data-vertical":e.vertical,children:[m.jsx("div",{className:Os.label,style:{textAlign:e.labelAlign||"left"},"data-vertical":e.vertical,children:e.title}),m.jsx("div",{className:Os.item,"data-vertical":e.vertical,children:e.children})]}),Lh=()=>m.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("rect",{x:"2",y:"10.8486",width:"2.61726",height:"7.84447",transform:"rotate(-44.9331 2 10.8486)",fill:"#D9D9D9"}),m.jsx("rect",{x:"9.38757",y:"14.5518",width:"2.57272",height:"12.3494",transform:"rotate(-135 9.38757 14.5518)",fill:"#D9D9D9"})]}),Uh="_inputBoolean_1xgaw_45",jh="_input_1xgaw_45",Oh="_check_1xgaw_60",Vs={inputBoolean:Uh,input:jh,check:Oh},Vh=({onChange:e,...t})=>m.jsx("div",{className:Vs.inputBoolean,onClick:n=>{n.stopPropagation()},children:m.jsxs("label",{children:[m.jsx("input",{className:Vs.input,type:"checkbox",checked:t.checked,disabled:t.disabled,readOnly:t.readOnly,onChange:n=>{t.readOnly||e&&e(n.target.checked)}}),m.jsx("div",{className:Vs.check,"data-read_only":t.readOnly,children:t.checked&&m.jsx(Lh,{})})]})}),Gh="_input_1rofd_45",vl={input:Gh},tc=e=>{const t=S.useRef(!1),n=S.useRef();n.current=e.onChange;const i=S.useRef();i.current=e.value;const r=S.useCallback(a=>{const l=i.current;if(t.current===!1)return;const u=a.movementX;if(typeof l=="number"){const d=u*.05*(e.step||1);n.current&&n.current(l+d),a.stopPropagation()}a.preventDefault()},[e.step]),s=S.useCallback(a=>{t.current=!0;const l=()=>{t.current=!1,window.removeEventListener("pointerup",l),window.removeEventListener("pointermove",r)};window.addEventListener("pointerup",l),window.addEventListener("pointermove",r)},[r]),o=Number((e.value||0).toFixed(e.step??3));return m.jsx("div",{className:vl.inputNumber,children:m.jsx("input",{className:vl.input,type:"number",value:o,disabled:e.disabled,readOnly:e.readOnly,"data-lo":e.readOnly,step:e.step||1,min:e.min,max:e.max,onChange:a=>{var l;(l=e.onChange)==null||l.call(e,Number(a.target.value))},onPointerDown:s})})},Wh="_inputSelect_d7lo3_45",Hh="_input_d7lo3_45",or={inputSelect:Wh,input:Hh},$h=({onChange:e,value:t,...n})=>{if(n.readOnly)return m.jsx("div",{className:or.inputSelect,children:m.jsx("input",{className:or.input,value:t,readOnly:!0})});let i=n.selectList;return typeof i=="function"&&(i=i()),m.jsx("div",{className:or.inputSelect,children:m.jsx("select",{className:or.input,onChange:r=>{e&&e(r.target.value)},value:t,children:i.map((r,s)=>{let o="",a="";return typeof r=="string"?(o=r,a=r):(o=r.label,a=r.value),m.jsx("option",{value:a,children:o},s)})})})},Xh="_input_ndjbn_45",gl={input:Xh},go=({onChange:e,value:t,...n})=>{const[i,r]=S.useState(t),s=S.useCallback(()=>{e&&e(i)},[i,e]);return S.useEffect(()=>{r(t)},[t]),m.jsx("div",{className:gl.container,children:m.jsx("input",{className:gl.input,type:"text",value:i,placeholder:n.readOnly?"-":"",disabled:n.disabled,readOnly:n.readOnly,"data-lo":n.readOnly,onChange:o=>{r(o.target.value)},onBlur:o=>{s()},onKeyDown:o=>{o.key==="Enter"&&o.currentTarget.blur()}})})},Kh={},Yh=["x","y","z","w"],nc=({onChange:e,disabled:t,...n})=>{const i=S.useRef();i.current=n.value;const r=S.useCallback((o,a)=>{if(e&&i.current){const l={};for(let u=0;u<i.current.length;u++)l[u]=i.current[u];l[o]=a,e(l)}},[e]),s=[];for(let o=0;o<n.value.length;o++)s.push(m.jsx(Ke,{title:Yh[o],labelAlign:"right",children:m.jsx(tc,{disabled:t,value:n.value[o],step:n.step,onChange:a=>{r(o,a)}})},o));return m.jsx("div",{className:Kh.vector,children:s.map(o=>o)})},at=e=>{let t=null;const n=e.onChange,i=e.value,r=e.format,s=o=>{n&&n(o)};if(i==null)return null;if(r&&(r.type=="vector"&&Array.isArray(i)?t=m.jsx(nc,{value:i,onChange:s}):r.type=="select"&&(t=m.jsx($h,{value:i,onChange:s,selectList:r.list}))),!t)if(typeof i=="number")t=m.jsx(tc,{...e,value:i,onChange:s});else if(typeof i=="string")t=m.jsx(go,{...e,value:i,onChange:s});else if(typeof i=="boolean")t=m.jsx(Vh,{...e,checked:i,onChange:s});else if(typeof i=="function"){const o=e.label||"Run";t=m.jsx(fn,{onClick:()=>{i()},children:o})}else t=m.jsx(go,{...e,value:JSON.stringify(i),onChange:()=>{}});return t},Qh="_container_dlq1w_1",Zh={container:Qh},qh=e=>{const t=[],n=e.value,i=e.format,r=(i==null?void 0:i.type)=="array"?i.labels:void 0;if(n===void 0)return null;for(let s=0;s<n.length;s++){const o=n[s];let a=s.toString();r&&(a+="/ "+r(o,s)),t.push(m.jsx(Ke,{title:a,children:m.jsx(at,{...e,value:o,onChange:l=>{const u=n.concat();u[s]=l,e.onChange&&e.onChange(u)}})},s))}return m.jsx("div",{className:Zh.container,children:t})},Jh=e=>{const{target:t}=Ih(),n=e.field.value,i=typeof n,r=e.field.opt,s=r==null?void 0:r.format,o=(r==null?void 0:r.label)||e.path.split("/").pop(),a=s&&s.type=="vector";let l=null;if(Array.isArray(n))(s==null?void 0:s.type)=="vector"?l=m.jsx(nc,{value:n,...r,onChange:u=>{t.setField(e.path,u)}}):l=m.jsx(qh,{value:n,...r,onChange:u=>{t.setField(e.path,u)}});else if(l=m.jsx(at,{value:n,...r,onChange:u=>{t.setField(e.path,u)}}),i==="function")return l;return m.jsx(Ke,{title:o,vertical:a,children:l})},em="_container_3297g_1",tm="_field_3297g_5",nm="_block_3297g_9",yl={container:em,field:tm,block:nm},ic=e=>{const t=[],n=Object.keys(e.fields.childs);for(let i=0;i<n.length;i++){const r=n[i],s=e.fields.childs[r],{opt:o}=s;let a=!1;if(o&&(typeof o.hidden=="function"?a=o.hidden(s.type=="value"?s.value:null):a=o.hidden||!1),a)continue;const l="field"+r,u=(e.basePath?e.basePath+"/":"")+r;let d=null;s.type==="value"?d=m.jsx(Jh,{path:u,field:s},l):d=m.jsx("div",{className:yl.block,children:m.jsx(Hn,{accordion:!0,label:r,children:m.jsx(ic,{fields:s,basePath:u})},l)},l),d&&t.push(d)}return m.jsx("div",{className:yl.container,children:t})},rc=e=>{const t=Nh(e),n=t.target.serializeToDirectory();return m.jsx(ec.Provider,{value:t,children:m.jsx(ic,{fields:n})})},sc=S.createContext(null),Mt=()=>{const e=S.useContext(sc);if(e===null)throw new Error("useEditor must be used within a EditorProvider");return e},ce=(e,t)=>{const n=s=>{e==null||e.setField(t,s)},{fields:i}=_a(e,[t]);return[i&&i[t],n]};class oc{constructor(t){c(this,"gl");c(this,"extDisJointTimerQuery");this.gl=t,this.gl.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_color_buffer_half_float"),this.gl.getExtension("OES_texture_float_linear"),this.extDisJointTimerQuery=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")}}class im{constructor(t,n){c(this,"gl");c(this,"vao");c(this,"program");c(this,"indexBuffer");c(this,"attributes");c(this,"vertCount");c(this,"indexCount");c(this,"instanceCount");c(this,"attribPointerDiect");c(this,"attribTypeDict");this.gl=t,this.program=n,this.vao=this.gl.createVertexArray(),this.attributes=new Map,this.indexBuffer=null,this.vertCount=0,this.indexCount=0,this.instanceCount=0,this.attribPointerDiect=new Map([["Float32Array",this.gl.vertexAttribPointer.bind(this.gl)],["Int32Array",this.gl.vertexAttribIPointer.bind(this.gl)],["Int16Array",this.gl.vertexAttribIPointer.bind(this.gl)],["Int8Array",this.gl.vertexAttribIPointer.bind(this.gl)],["UInt32Array",this.gl.vertexAttribIPointer.bind(this.gl)],["UInt16Array",this.gl.vertexAttribIPointer.bind(this.gl)],["UInt8Array",this.gl.vertexAttribIPointer.bind(this.gl)]]),this.attribTypeDict=new Map([["Float32Array",this.gl.FLOAT],["Int32Array",this.gl.INT],["Int16Array",this.gl.SHORT],["Int8Array",this.gl.BYTE],["UInt32Array",this.gl.UNSIGNED_INT],["UInt16Array",this.gl.UNSIGNED_SHORT],["UInt8Array",this.gl.UNSIGNED_BYTE]])}calcVertCount(){this.vertCount=0,this.instanceCount=0,this.attributes.forEach((t,n)=>{t.instanceDivisor==null&&n!="index"&&(this.vertCount=Math.max(this.vertCount,t.count)),t.instanceDivisor!==void 0&&t.instanceDivisor>0&&(this.instanceCount==0?this.instanceCount=t.count:this.instanceCount=Math.min(this.instanceCount,t.count))})}setAttribute(t,n,i,r){if(n.array===null)return;const s={buffer:n,size:i,count:n.array?n.array.length/i:0,location:void 0,...r};this.attributes.set(t,s),this.gl.bindVertexArray(this.vao),s.location=this.gl.getAttribLocation(this.program,t);const o=this.attribPointerDiect.get(n.array.constructor.name),a=this.attribTypeDict.get(n.array.constructor.name);if(s.location>-1)if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.buffer.buffer),s.size==16){for(let l=0;l<4;l++)this.gl.enableVertexAttribArray(s.location+l);for(let l=0;l<4;l++)this.gl.vertexAttribPointer(s.location+l,4,a,!1,64,16*l);if(s.instanceDivisor!==void 0)for(let l=0;l<4;l++)this.gl.vertexAttribDivisor(s.location+l,s.instanceDivisor)}else this.gl.enableVertexAttribArray(s.location),o(s.location,s.size,a,!1,0,0),s.instanceDivisor!==void 0&&this.gl.vertexAttribDivisor(s.location,s.instanceDivisor);return this.gl.bindVertexArray(null),this.calcVertCount(),this}removeAttribute(t){return this.attributes.delete(t),this.calcVertCount(),this}setIndex(t){this.indexBuffer=t,this.vao&&(this.gl.bindVertexArray(this.vao),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer?this.indexBuffer.buffer:null),this.gl.bindVertexArray(null),this.indexBuffer&&this.indexBuffer.array&&(this.indexCount=this.indexBuffer.array.length))}use(t){this.gl.bindVertexArray(this.vao),t&&t(this),this.gl.bindVertexArray(null)}getVAO(){return this.vao}dispose(){this.attributes.forEach(t=>{t.buffer.dispose()})}}class ac{constructor(t){c(this,"gl");c(this,"program");c(this,"vao");c(this,"uniforms");this.gl=t,this.program=this.gl.createProgram(),this.vao=new Map,this.uniforms=new Map}setShader(t,n,i){if(this.program===null){console.warn("program is null.");return}const r=this.createShader(t,this.gl.VERTEX_SHADER),s=this.createShader(n,this.gl.FRAGMENT_SHADER);if(!(!r||!s))return this.gl.attachShader(this.program,r),this.gl.attachShader(this.program,s),i&&i.transformFeedbackVaryings&&this.gl.transformFeedbackVaryings(this.program,i.transformFeedbackVaryings,this.gl.SEPARATE_ATTRIBS),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)||console.error("program link error:",this.gl.getProgramInfoLog(this.program)),this}createShader(t,n){const i=this.gl.createShader(n);if(!i)return null;if(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i}setUniform(t,n,i){const r=this.uniforms.get(t);if(r)if(r.type=n,r.value=i,r.cache){for(let s=0;s<i.length;s++)if(r.cache[s]!==i[s]){r.needsUpdate=!0;break}}else r.needsUpdate=!0;else this.uniforms.set(t,{value:i,type:n,location:null,needsUpdate:!0}),this.updateUniformLocations()}updateUniformLocations(t){this.program&&this.uniforms.forEach((n,i)=>{(n.location===null||t)&&(n.location=this.gl.getUniformLocation(this.program,i))})}uploadUniforms(){this.uniforms.forEach(t=>{t.needsUpdate&&t.location!==null&&(/Matrix[2|3|4]fv/.test(t.type)?this.gl["uniform"+t.type](t.location,!1,t.value):/[1|2|3|4][f|i]$/.test(t.type)?this.gl["uniform"+t.type](t.location,...t.value):this.gl["uniform"+t.type](t.location,t.value),t.cache=t.value.concat(),t.needsUpdate=!1)})}resetUniforms(){this.uniforms.forEach(t=>{if(t.location===null)return;let n=1;t.type.includes("Matrix4")?n=16:t.type.includes("Matrix3")?n=9:t.type.includes("Matrix2")||t.type.includes("4")?n=4:t.type.includes("3")?n=3:t.type.includes("2")&&(n=2),t.value=new Array(n).fill(0),t.needsUpdate=!0})}getVAO(t="_"){if(!this.program)return null;let n=this.vao.get(t);return n||(n=new im(this.gl,this.program),this.vao.set(t,n),n)}use(t){this.program&&(this.gl.useProgram(this.program),t&&t(this),this.gl.useProgram(null))}getProgram(){return this.program}dispose(){this.vao.forEach(t=>{t.dispose()}),this.vao.clear(),this.gl.deleteProgram(this.program)}}class Dr{constructor(t){c(this,"gl");c(this,"buffer");c(this,"array");this.gl=t,this.buffer=this.gl.createBuffer(),this.array=null}setData(t,n="vbo",i){const r=n=="vbo"?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;return this.gl.bindBuffer(r,this.buffer),this.gl.bufferData(r,t,i||this.gl.STATIC_DRAW),this.gl.bindBuffer(r,null),this.array=t,this}dispose(){this.gl.deleteBuffer(this.buffer)}}class M{constructor(t,n,i,r){c(this,"x");c(this,"y");c(this,"z");c(this,"w");this.x=0,this.y=0,this.z=0,this.w=0,this.set(t,n,i,r)}get isVector(){return!0}set(t,n,i,r){return this.x=t??0,this.y=n??0,this.z=i??0,this.w=r??0,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setFromArray(t){return this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0,this.w=t[3]||0,this}add(t){return typeof t=="number"?(this.x+=t,this.y+=t,this.z+=t,this.w+=t):(this.x+=t.x??0,this.y+=t.y??0,this.z+=t.z??0,this.w+=t.w??0),this}sub(t){return typeof t=="number"?(this.x-=t,this.y-=t,this.z-=t):(this.x-=t.x??0,this.y-=t.y??0,this.z-=t.z??0,this.w-=t.w??0),this}multiply(t){return typeof t=="number"?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w),this}divide(t){return typeof t=="number"?(this.x/=t,this.y/=t,this.z/=t,this.w/=t):(this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distanceTo(t){const n=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return Math.sqrt(n*n+i*i+r*r)}normalize(){const t=this.length()||1;return this.x/=t,this.y/=t,this.z/=t,this}cross(t){const n=this.x,i=this.y,r=this.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}applyMatrix3(t){const n=t.elm,i=n[0],r=n[1],s=n[2],o=n[4],a=n[5],l=n[6],u=n[8],d=n[9],h=n[10],f=this.x*i+this.y*o+this.z*u,v=this.x*r+this.y*a+this.z*d,x=this.x*s+this.y*l+this.z*h;return this.x=f,this.y=v,this.z=x,this.w=0,this}applyMatrix4(t){const n=t.elm,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],u=n[6],d=n[7],h=n[8],f=n[9],v=n[10],x=n[11],_=n[12],z=n[13],g=n[14],p=n[15],y=this.x*i+this.y*a+this.z*h+this.w*_,w=this.x*r+this.y*l+this.z*f+this.w*z,E=this.x*s+this.y*u+this.z*v+this.w*g,k=this.x*o+this.y*d+this.z*x+this.w*p;return this.x=y,this.y=w,this.z=E,this.w=k,this}applyMatrix4AsPosition(t){const n=this.w;return this.w=1,this.applyMatrix4(t),this.w=n,this}applyMatrix4AsDirection(t){const n=this.w;return this.w=0,this.applyMatrix4(t),this.w=n,this}floor(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w)}lerp(t,n){return this.x=this.x+(t.x-this.x)*n,this.y=this.y+(t.y-this.y)*n,this.z=this.z+(t.z-this.z)*n,this.w=this.w+(t.w-this.w)*n,this}copy(t){return this.x=t.x??0,this.y=t.y??0,this.z=t.z??0,this.w=t.w??0,this}clone(){return new M(this.x,this.y,this.z,this.w)}getElm(t){return t=="vec2"?[this.x,this.y]:t=="vec3"?[this.x,this.y,this.z]:[this.x,this.y,this.z,this.w]}}class W{constructor(t){c(this,"unit");c(this,"image");c(this,"size");c(this,"gl");c(this,"glTex");c(this,"textureType");c(this,"_setting");this.gl=t,this.image=null,this.unit=0,this.size=new M,this.glTex=this.gl.createTexture(),this._setting={type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.RGBA,format:this.gl.RGBA,magFilter:this.gl.NEAREST,minFilter:this.gl.NEAREST,generateMipmap:!1,wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE},this.textureType=t.TEXTURE_2D}get isTexture(){return!0}setting(t){return this._setting={...this._setting,...t},this.attach(this.image),this}attach(t){if(this.image=t,this.gl.bindTexture(this.textureType,this.glTex),this.image){const n=Array.isArray(this.image)?this.image[0]:this.image;this.size.set(n.width,n.height),n instanceof HTMLImageElement||n instanceof HTMLCanvasElement?this.gl.texImage2D(this.textureType,0,this._setting.internalFormat,this._setting.format,this._setting.type,n):this.gl.texImage2D(this.textureType,0,this._setting.internalFormat,n.width,n.height,0,this._setting.format,this._setting.type,n.data||null)}else this.size.set(1,1),this.gl.texImage2D(this.textureType,0,this._setting.internalFormat,this.size.x,this.size.y,0,this._setting.format,this._setting.type,null);return this._setting.generateMipmap&&this.gl.generateMipmap(this.textureType),this.gl.texParameteri(this.textureType,this.gl.TEXTURE_MAG_FILTER,this._setting.magFilter),this.gl.texParameteri(this.textureType,this.gl.TEXTURE_MIN_FILTER,this._setting.minFilter),this.gl.texParameterf(this.textureType,this.gl.TEXTURE_WRAP_S,this._setting.wrapS),this.gl.texParameterf(this.textureType,this.gl.TEXTURE_WRAP_T,this._setting.wrapT),this.gl.bindTexture(this.textureType,null),this}activate(t){return this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.textureType,this.glTex),this.unit=t,this}load(t,n){const i=new Image;return i.onload=()=>{this.attach(i),n&&n()},i.src=t,this}getTexture(){return this.glTex}get type(){return this.textureType}dispose(){this.gl.deleteTexture(this.glTex)}}class Z{constructor(t,n){c(this,"size");c(this,"gl");c(this,"glFrameBuffer");c(this,"textures");c(this,"depthTexture");c(this,"textureAttachmentList");this.gl=t,this.size=new M(1,1),this.glFrameBuffer=this.gl.createFramebuffer(),this.depthTexture=null,this.textures=[],this.textureAttachmentList=[],(!n||!n.disableDepthBuffer)&&this.setDepthTexture(new W(this.gl).setting({internalFormat:this.gl.DEPTH_COMPONENT32F,format:this.gl.DEPTH_COMPONENT,type:this.gl.FLOAT,magFilter:this.gl.NEAREST,minFilter:this.gl.NEAREST}))}setDepthTexture(t){this.depthTexture=t,this.depthTexture&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.glFrameBuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.getTexture(),0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null))}setTexture(t){return this.textures=t,this.textureAttachmentList=[],this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.glFrameBuffer),this.textures.forEach((n,i)=>{n.attach({width:this.size.x,height:this.size.y});const r=this.gl.COLOR_ATTACHMENT0+i;this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,r,this.gl.TEXTURE_2D,n.getTexture(),0),this.textureAttachmentList.push(r)}),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this}setSize(t,n){return typeof t=="number"?(this.size.x=t,n!==void 0&&(this.size.y=n)):this.size.copy(t),this.size.floor(),this.setTexture(this.textures),this.textures.forEach(i=>{i.attach({width:this.size.x,height:this.size.y})}),this.depthTexture&&this.depthTexture.attach({width:this.size.x,height:this.size.y}),this}getFrameBuffer(){return this.glFrameBuffer}dispose(){this.gl.deleteFramebuffer(this.glFrameBuffer)}}class rm extends Z{constructor(n,i){super(n,i);c(this,"cubeTarget");c(this,"textures");c(this,"currentFace");this.textures=[],this.cubeTarget=[this.gl.TEXTURE_CUBE_MAP_POSITIVE_X,this.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,this.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z],this.currentFace=this.cubeTarget[0]}setTexture(n){return this.textures=n,this.textureAttachmentList=[],this.textures.forEach(i=>{i.attach({width:this.size.x,height:this.size.y})}),this}face(n){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.glFrameBuffer),this.textureAttachmentList=[],this.textures.forEach((i,r)=>{const s=this.gl.COLOR_ATTACHMENT0+r;this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,s,this.cubeTarget[n],i.getTexture(),0),this.textureAttachmentList.push(s)}),this.currentFace=this.cubeTarget[n],this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}}class sm extends W{constructor(n){super(n);c(this,"cubeTarget");this.textureType=n.TEXTURE_CUBE_MAP,this.cubeTarget=[this.gl.TEXTURE_CUBE_MAP_POSITIVE_X,this.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,this.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]}attach(n){if(this.image=n,this.gl.bindTexture(this.textureType,this.glTex),this.image)for(let i=0;i<6;i++){const r=Array.isArray(this.image)?this.image[i]:this.image;this.size.set(r.width,r.height),r instanceof HTMLImageElement||r instanceof HTMLCanvasElement?this.gl.texImage2D(this.cubeTarget[i],0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r):this.gl.texImage2D(this.cubeTarget[i],0,this._setting.internalFormat,r.width,r.height,0,this._setting.format,this._setting.type,r.data||null)}return this._setting.generateMipmap&&this.gl.generateMipmap(this.textureType),this.gl.texParameteri(this.textureType,this.gl.TEXTURE_MAG_FILTER,this._setting.magFilter),this.gl.texParameteri(this.textureType,this.gl.TEXTURE_MIN_FILTER,this._setting.minFilter),this.gl.texParameterf(this.textureType,this.gl.TEXTURE_WRAP_S,this._setting.wrapS),this.gl.texParameterf(this.textureType,this.gl.TEXTURE_WRAP_T,this._setting.wrapT),this.gl.bindTexture(this.textureType,null),this}}class om{constructor(t){c(this,"gl");c(this,"transformFeedback");c(this,"feedbackBuffer");this.gl=t,this.transformFeedback=this.gl.createTransformFeedback(),this.feedbackBuffer=new Map}bind(t){this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,this.transformFeedback),t&&t(),this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,null)}setBuffer(t,n,i){this.feedbackBuffer.set(t,{buffer:n,varyingIndex:i})}use(t){this.bind(()=>{this.feedbackBuffer.forEach(n=>{this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,n.varyingIndex,n.buffer.buffer)}),t&&t(this),this.feedbackBuffer.forEach(n=>{this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,n.varyingIndex,null)})})}}class K{constructor(t){c(this,"elm");this.elm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t&&this.set(t)}identity(){return this.elm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}clone(){return new K().copy(this)}copy(t){return this.set(t.elm),this}perspective(t,n,i,r){const s=1/Math.tan(t*Math.PI/360),o=r-i;return this.elm=[s/n,0,0,0,0,s,0,0,0,0,-(r+i)/o,-1,0,0,-(r*i*2)/o,0],this}orthographic(t,n,i,r){}lookAt(t,n,i){const r=t.clone().sub(n).normalize(),s=i.clone().cross(r).normalize(),o=r.clone().cross(s).normalize();return this.elm=[s.x,s.y,s.z,0,o.x,o.y,o.z,0,r.x,r.y,r.z,0,t.x,t.y,t.z,1],this}inverse(){const t=this.elm[0],n=this.elm[1],i=this.elm[2],r=this.elm[3],s=this.elm[4],o=this.elm[5],a=this.elm[6],l=this.elm[7],u=this.elm[8],d=this.elm[9],h=this.elm[10],f=this.elm[11],v=this.elm[12],x=this.elm[13],_=this.elm[14],z=this.elm[15],g=t*o-n*s,p=t*a-i*s,y=t*l-r*s,w=n*a-i*o,E=n*l-r*o,k=i*l-r*a,C=u*x-d*v,T=u*_-h*v,F=u*z-f*v,D=d*_-h*x,L=d*z-f*x,V=h*z-f*_,me=g*V-p*L+y*D+w*F-E*T+k*C,H=1/me;return me==0?this.identity():(this.elm[0]=(o*V-a*L+l*D)*H,this.elm[1]=(-n*V+i*L-r*D)*H,this.elm[2]=(x*k-_*E+z*w)*H,this.elm[3]=(-d*k+h*E-f*w)*H,this.elm[4]=(-s*V+a*F-l*T)*H,this.elm[5]=(t*V-i*F+r*T)*H,this.elm[6]=(-v*k+_*y-z*p)*H,this.elm[7]=(u*k-h*y+f*p)*H,this.elm[8]=(s*L-o*F+l*C)*H,this.elm[9]=(-t*L+n*F-r*C)*H,this.elm[10]=(v*E-x*y+z*g)*H,this.elm[11]=(-u*E+d*y-f*g)*H,this.elm[12]=(-s*D+o*T-a*C)*H,this.elm[13]=(t*D-n*T+i*C)*H,this.elm[14]=(-v*w+x*p-_*g)*H,this.elm[15]=(u*w-d*p+h*g)*H,this)}transpose(){const t=this.elm[0],n=this.elm[1],i=this.elm[2],r=this.elm[3],s=this.elm[4],o=this.elm[5],a=this.elm[6],l=this.elm[7],u=this.elm[8],d=this.elm[9],h=this.elm[10],f=this.elm[11],v=this.elm[12],x=this.elm[13],_=this.elm[14],z=this.elm[15];return this.elm[0]=t,this.elm[1]=s,this.elm[2]=u,this.elm[3]=v,this.elm[4]=n,this.elm[5]=o,this.elm[6]=d,this.elm[7]=x,this.elm[8]=i,this.elm[9]=a,this.elm[10]=h,this.elm[11]=_,this.elm[12]=r,this.elm[13]=l,this.elm[14]=f,this.elm[15]=z,this}set(t){for(let n=0;n<this.elm.length;n++)this.elm[n]=t[n]??0;return this}setFromTransform(t,n,i){return this.identity(),t&&this.applyPosition(t),n&&this.applyQuaternion(n),i&&this.applyScale(i),this}applyPosition(t){return this.matmul([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1]),this}applyQuaternion(t){const n=t.x,i=t.y,r=t.z,s=t.w,o=n*n,a=i*i,l=r*r,u=s*s,d=n*i,h=n*r,f=n*s,v=i*r,x=i*s,_=r*s;return this.matmul([o-a-l+u,2*(d+_),2*(h-x),0,2*(d-_),-o+a-l+u,2*(v+f),0,2*(h+x),2*(v-f),-o-a+l+u,0,0,0,0,1]),this}applyScale(t){return this.matmul([t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1]),this}matmul(t){const n=new Array(16);for(let i=0;i<4;i++)for(let r=0;r<4;r++){let s=0;for(let o=0;o<4;o++)s+=this.elm[o*4+r]*t[o+i*4];n[r+i*4]=s}this.elm=n}setRotationFromDirection(t,n){}makeRotationAxis(t,n){return this}multiply(t){return this.matmul(t.elm),this}preMultiply(t){const n=this.copyToArray([]);return this.set(t.elm),this.matmul(n),this}decompose(t,n,i){t&&(t.x=this.elm[12],t.y=this.elm[13],t.z=this.elm[14]),n&&n.setFromMatrix(this)}copyToArray(t){t.length=this.elm.length;for(let n=0;n<this.elm.length;n++)t[n]=this.elm[n];return t}}class En extends M{constructor(n,i,r,s){super(n,i,r,0);c(this,"order");this.order=s||"XYZ"}copy(n){return"order"in n&&(this.order=n.order),super.copy(n)}setFromQuaternion(n){const i=new K().applyQuaternion(n);return this.setFromRotationMatrix(i),this}setFromRotationMatrix(n){const i=n.elm,r=i[0],s=i[4],o=i[8];i[1];const a=i[5],l=i[9];i[2];const u=i[6],d=i[10];return this.order="XYZ",this.y=Math.asin(Math.min(1,Math.max(-1,o))),Math.abs(o)<.9999999?(this.x=Math.atan2(-l,d),this.z=Math.atan2(-s,r)):(this.x=Math.atan2(u,a),this.z=0),this}}class qi{constructor(t,n,i,r){c(this,"x");c(this,"y");c(this,"z");c(this,"w");c(this,"updated",!1);this.x=t||0,this.y=n||0,this.z=i||0,this.w=r||1}set(t,n,i,r){this.x=t??this.x,this.y=n??this.y,this.z=i??this.z,this.w=r??this.w,this.updated=!0}setFromEuler(t,n){const i=n||("order"in t?t.order:"XYZ"),r=Math.sin(t.x/2),s=Math.sin(t.y/2),o=Math.sin(t.z/2),a=Math.cos(t.x/2),l=Math.cos(t.y/2),u=Math.cos(t.z/2);return i=="XYZ"?(this.x=a*s*o+r*l*u,this.y=-r*l*o+a*s*u,this.z=a*l*o+r*s*u,this.w=-r*s*o+a*l*u):i=="XZY"?(this.x=-a*s*o+r*l*u,this.y=a*s*u-r*l*o,this.z=r*s*u+a*l*o,this.w=r*s*o+a*l*u):i=="YZX"?(this.x=r*l*u+a*s*o,this.y=r*l*o+a*s*u,this.z=-r*s*u+a*l*o,this.w=-r*s*o+a*l*u):i=="ZYX"&&(this.x=r*l*u-a*s*o,this.y=r*l*o+a*s*u,this.z=-r*s*u+a*l*o,this.w=r*s*o+a*l*u),this.updated=!0,this}setFromMatrix(t){const n=t.elm,i=n[0]+n[5]+n[10];let r,s,o,a;if(i>0){const u=Math.sqrt(i+1)*2;a=.25*u,r=(n[6]-n[9])/u,s=(n[8]-n[2])/u,o=(n[1]-n[4])/u}else if(n[0]>n[5]&&n[0]>n[10]){const u=Math.sqrt(1+n[0]-n[5]-n[10])*2;a=(n[6]-n[9])/u,r=.25*u,s=(n[1]+n[4])/u,o=(n[2]+n[8])/u}else if(n[5]>n[10]){const u=Math.sqrt(1+n[5]-n[0]-n[10])*2;a=(n[8]-n[2])/u,r=(n[1]+n[4])/u,s=.25*u,o=(n[6]+n[9])/u}else{const u=Math.sqrt(1+n[10]-n[0]-n[5])*2;a=(n[1]-n[4])/u,r=(n[2]+n[8])/u,s=(n[6]+n[9])/u,o=.25*u}const l=Math.sqrt(r*r+s*s+o*o+a*a);return r/=l,s/=l,o/=l,a/=l,this.x=r,this.y=s,this.z=o,this.w=a,this.updated=!0,this}multiply(t){const n=this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z,i=this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,r=this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,s=this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w;return this.set(i,r,s,n),this.updated=!0,this}preMultiply(t){const n=t.clone().multiply(this);this.set(n.x,n.y,n.z,n.w)}inverse(){return this.set(-this.x,-this.y,-this.z,this.w),this.updated=!0,this}copy(t){return this.x=t.x??0,this.y=t.y??0,this.z=t.z??0,this.w=t.w??0,this.updated=!0,this}clone(){return new qi(this.x,this.y,this.z,this.w)}}var ct;(e=>{e.gauss=(t,n,i)=>{const r=t-n,s=-(r*r)/(2*i*i);return 1/Math.sqrt(2*Math.PI*i)*Math.exp(s)},e.gaussWeights=t=>{let n=0;const i=[];if(t<=1)return[.5];for(let r=0;r<t;r++){const s=r/(t-1),o=(0,e.gauss)(s,0,1);n+=o*(r>0?2:1),i.push(o)}for(let r=0;r<t;r++)i[r]/=n;return i},e.randomSeed=t=>{t^=t<<13,t^=0,t^=t<<5;let n=123456789^t;t^=t<<13,t^=0,t^=t<<5;let i=362436069^t;t^=t<<13,t^=0,t^=t<<5;let r=521288629^t;t^=t<<13,t^=0,t^=t<<5;let s=88675123^t,o;return()=>(o=n^n<<11,n=i,i=r,r=s,s=(s^s>>>19^(o^o>>>8))>>>0,s/4294967296)},e.randomRange=(t=-1,n=1)=>t+Math.random()*(n-t),e.randomVector=(t=new M(-1,-1,-1,-1),n=new M(1,1,1,1))=>new M((0,e.randomRange)(t.x,n.x),(0,e.randomRange)(t.y,n.y),(0,e.randomRange)(t.z,n.z),(0,e.randomRange)(t.w,n.w)),e.randomInSphere=(t=1,n=Math.random)=>{const i=n(),r=n(),s=n(),o=2*Math.PI*i,a=Math.acos(2*r-1),l=Math.cbrt(s)*t,u=Math.sin(a);return{x:l*u*Math.cos(o),y:l*u*Math.sin(o),z:l*Math.cos(a)}},e.smoothstep=(t,n,i)=>i<=t?0:i>=n?1:(i=(i-t)/(n-t),i*i*(3-2*i))})(ct||(ct={}));var It;(e=>{e.NEWTON_ITERATIONS=4,e.NEWTON_MIN_SLOPE=.001,e.SUBDIVISION_PRECISION=1e-7,e.SUBDIVISION_MAX_ITERATIONS=10,e.BEZIER_EASING_CACHE_SIZE=11,e.BEZIER_EASING_SAMPLE_STEP_SIZE=1/e.BEZIER_EASING_CACHE_SIZE;function t(u){return-u.p0+3*u.p1-3*u.p2+u.p3}function n(u){return 3*u.p0-6*u.p1+3*u.p2}function i(u){return-3*u.p0+3*u.p1}function r(u,d){return 3*t(u)*d*d+2*n(u)*d+i(u)}e.calcBezierSlope=r;function s(u,d){return((t(u)*d+n(u))*d+i(u))*d+u.p0}e.calcBezier=s;function o(u,d,h,f){let v=0,x=0;for(let _=0;_<e.SUBDIVISION_MAX_ITERATIONS;_++)x=d+(h-d)/2,v=s(f,x),v>u?h=x:d=x;return x}function a(u,d,h){for(let f=0;f<e.NEWTON_ITERATIONS;f++){const v=r(d,h);if(v==0)return h;const x=s(d,h)-u;h-=x/v}return h}function l(u,d,h){u.p1=Math.max(u.p0,Math.min(u.p3,u.p1)),u.p2=Math.max(u.p0,Math.min(u.p3,u.p2));let f=0;for(let _=1;_<h.length&&(f=_-1,!(d<h[_]));_++);const v=f/(e.BEZIER_EASING_CACHE_SIZE-1),x=r(u,v)/(u.p3-u.p0);return x==0?v:x>.01?a(d,u,v):o(d,v,v+e.BEZIER_EASING_SAMPLE_STEP_SIZE,u)}e.getBezierTfromX=l})(It||(It={}));var yo;(e=>{function t(n,i,r,s){const o=new Array(It.BEZIER_EASING_CACHE_SIZE);for(let a=0;a<It.BEZIER_EASING_CACHE_SIZE;++a)o[a]=It.calcBezier({p0:n.x,p1:i.x,p2:r.x,p3:s.x},a/(It.BEZIER_EASING_CACHE_SIZE-1));return a=>a<=n.x?n.y:s.x<=a?s.y:It.calcBezier({p0:n.y,p1:i.y,p2:r.y,p3:s.y},It.getBezierTfromX({p0:n.x,p1:i.x,p2:r.x,p3:s.x},a,o))}e.bezier=t})(yo||(yo={}));class De{constructor(){c(this,"listeners");this.listeners=[]}on(t,n){this.listeners.push({event:t,cb:n})}once(t,n){this.listeners.push({event:t,cb:n,once:!0})}off(t,n){this.listeners=this.listeners.filter(i=>n==null?i.event!=t:!(i.event==t&&i.cb==n))}emit(t,n){const i=this.listeners.concat();for(let r=0;r<i.length;r++){const s=i[r];s.event==t&&(s.cb.apply(this,n||[]),s.once&&this.off(t,s.cb))}}hasEvent(t){return this.listeners.some(n=>n.event==t)}}class am extends De{constructor(n){super();c(this,"keyframes",[]);c(this,"cache",{frame:NaN,value:NaN});c(this,"frameStart");c(this,"frameEnd");c(this,"frameDuration");this.frameStart=0,this.frameEnd=0,this.frameDuration=0,this.set(n)}set(n){n&&(this.keyframes=[],n.forEach(i=>{this.addKeyFrame(i)}))}addKeyFrame(n){let i=0;for(let r=0;r<this.keyframes.length&&this.keyframes[r].coordinate.x<n.coordinate.x;r++)i++;this.keyframes.splice(i,0,n),this.frameStart=this.keyframes[0].coordinate.x,this.frameEnd=this.keyframes[this.keyframes.length-1].coordinate.x}getValue(n){if(n==this.cache.frame)return this.cache.value;let i=null;for(let r=0;r<this.keyframes.length;r++){const s=this.keyframes[r];if(n<s.coordinate.x){const o=this.keyframes[r-1];o?i=o.to(s,n):i=s.coordinate.y;break}}return i===null&&this.keyframes.length>0&&(i=this.keyframes[this.keyframes.length-1].coordinate.y),i!==null?(this.cache={frame:n,value:i},i):0}}class lm extends De{constructor(n,i,r,s,o){super();c(this,"name");c(this,"curves");c(this,"frameStart");c(this,"frameEnd");c(this,"frameDuration");c(this,"updatedFrame",-1);c(this,"value");this.name=n||"",this.frameStart=0,this.frameEnd=0,this.frameDuration=0,this.curves=new Map,this.value=new M,i&&this.setFCurve(i,"x"),r&&this.setFCurve(r,"y"),s&&this.setFCurve(s,"z"),o&&this.setFCurve(o,"w")}setFCurve(n,i){this.curves.set(i,n);let r=1/0,s=-1/0;this.curves.forEach(o=>{o.frameStart<r&&(r=o.frameStart),o.frameEnd>s&&(s=o.frameEnd)}),(r==-1/0||s==1/0)&&(r=0,s=1),this.frameStart=r,this.frameEnd=s,this.frameDuration=this.frameEnd-this.frameStart}getFCurve(n){return this.curves.get(n)||null}setFrame(n){if(n==this.updatedFrame)return this;const i=this.curves.get("x"),r=this.curves.get("y"),s=this.curves.get("z"),o=this.curves.get("w");return i&&(this.value.x=i.getValue(n)),r&&(this.value.y=r.getValue(n)),s&&(this.value.z=s.getValue(n)),o&&(this.value.w=o.getValue(n)),this.updatedFrame=n,this}}class um extends De{constructor(n,i,r,s){super();c(this,"coordinate",{x:0,y:0});c(this,"handleLeft",{x:0,y:0});c(this,"handleRight",{x:0,y:0});c(this,"interpolation","BEZIER");c(this,"easing",null);c(this,"nextFrame",null);this.set(n,i,r,s)}set(n,i,r,s){this.coordinate=n,this.handleLeft=i||n,this.handleRight=r||n,this.interpolation=s||"BEZIER"}getEasing(n,i){return n=="BEZIER"?yo.bezier(this.coordinate,this.handleRight,i.handleLeft,i.coordinate):n=="CONSTANT"?()=>this.coordinate.y:r=>{const s=i.coordinate.y-this.coordinate.y;return r=(r-this.coordinate.x)/(i.coordinate.x-this.coordinate.x),this.coordinate.y+r*s}}to(n,i){return(this.nextFrame==null||this.nextFrame.coordinate.x!=n.coordinate.x||this.nextFrame.coordinate.y!=n.coordinate.y)&&(this.easing=this.getEasing(this.interpolation,n),this.nextFrame=n),this.easing?this.easing(i):0}}var xo;(e=>{function t(){const n=Date.now()&65535,i=Math.floor(Math.random()*65536);return((n<<16|i)>>>0).toString(16).padStart(8,"0")}e.genUUID=t})(xo||(xo={}));class ei extends De{constructor(){super();c(this,"uuid");c(this,"initiator");c(this,"fields_");this.uuid=xo.genUUID(),this.fields_=new Map,this.initiator="script"}serialize(n){const i=n||{mode:"view"},r={};return this.fields_.forEach((s,o)=>{const a=this.getFieldOpt(o);i.mode=="export"&&a&&a&&a.noExport||(r[o]=s.get(i))}),r}serializeToDirectory(){return{type:"folder",childs:{},opt:{}}}deserialize(n){const i=Object.keys(n);for(let r=0;r<i.length;r++){const s=i[r],o=this.fields_.get(s);o&&o.set(n[s])}}exportEditor(){}field(n,i,r,s){const o=typeof r=="function"?r:void 0,a=typeof r=="object"&&r||s||{};o||(a.readOnly=!0,a.noExport=!0);const l=n.startsWith("/")?n.slice(1):n;this.fields_.set(l,{get:i,set:u=>{o&&o(u),this.noticeField(n)},opt:a})}fieldDir(n,i){const r=n;return this.field(r+"/",()=>null,void 0,{...i,isFolder:!0}),{dir:s=>this.fieldDir(`${r}/${s}`),field:(s,o,a,l)=>{this.field(`${r}/${s}`,o,a,l)}}}setField(n,i){this.deserialize({[n]:i})}getField(n,i){const r=this.fields_.get(n);if(r)return i=i||{mode:"view"},r.get(i)}getFieldOpt(n){const i=this.fields_.get(n);if(i)return i.opt}noticeField(n){this.emit("fields/update/"+n),this.emit("fields/update",[[n]])}}class b extends ei{constructor(n){super();c(this,"disableEdit");c(this,"order");c(this,"_entity");c(this,"_enabled");c(this,"_tag");c(this,"_disposed");this.disableEdit=!1,this._entity=n.entity,this._enabled=!0,this._disposed=!1,this._tag="",this.order=0,this.field("enabled",()=>this.enabled,i=>this.enabled=i,{hidden:!0,noExport:!0}),this.field("tag",()=>this.tag,i=>this._tag=i,{readOnly:!0,noExport:!0,hidden:i=>i==""})}get tag(){return this._tag}get entity(){return this._entity}set enabled(n){this._enabled=n}get enabled(){return this._enabled}update(n){this.enabled&&this.updateImpl(n)}updateImpl(n){}postUpdate(n){this.enabled&&this.postUpdateImpl(n)}postUpdateImpl(n){}beforeRender(n){this.enabled&&this.beforeRenderImpl(n)}beforeRenderImpl(n){}afterRender(n){this.enabled&&this.afterRenderImpl(n)}afterRenderImpl(n){}dispose(){this._disposed=!0,this.disposeImpl(),this.emit("dispose")}disposeImpl(){}}class ti extends ei{constructor(){super();c(this,"vertCount");c(this,"attributes");c(this,"vaoCache");this.vertCount=0,this.attributes=new Map,this.vaoCache=new Map}setAttribute(n,i,r,s){const o=this.attributes.get(n);return o&&o.buffer&&o.buffer.dispose(),this.attributes.set(n,{array:i,size:r,opt:s}),this.updateVertCount(),this}getAttribute(n){return this.attributes.get(n)}updateVertCount(){this.vertCount=this.attributes.size>0?1/0:0,this.attributes.forEach((n,i)=>{i=="index"||n.opt&&n.opt.instanceDivisor||(this.vertCount=Math.min(n.array.length/n.size,this.vertCount))})}applyMatrix(n){const i=new M,r=(a,l,u)=>{for(let d=0;d<a.length;d+=3)i.set(a[d],a[d+1],a[d+2]),u?i.applyMatrix4AsPosition(l):i.applyMatrix4AsDirection(l).normalize(),a[d]=i.x,a[d+1]=i.y,a[d+2]=i.z},s=this.attributes.get("position");s&&r(s.array,n,!0);const o=this.attributes.get("normal");return o&&r(o.array,n.clone().inverse().transpose(),!1),this.requestUpdate(),this}createBuffers(n){this.attributes.forEach((i,r)=>{i.buffer||(i.buffer=new Dr(n).setData(i.array,r=="index"?"ibo":"vbo",i.opt&&i.opt.usage))})}requestUpdate(){this.vaoCache.clear()}dispose(){this.attributes.forEach(n=>{var i;(i=n.buffer)==null||i.dispose()})}}const cm=`// @shader-file: packages/maxpower/Material/shaders/basic.fs
#include<common>
#include<packing>
#include<frag_h>
void main(){
#include<frag_in>

#include<frag_out>
}`,dm=`// @shader-file: packages/maxpower/Material/shaders/basic.vs
#include<common>
#include<vert_h>
void main(){
#include<vert_in>

#include<vert_out>
}`;class X extends ei{constructor(n){super();c(this,"name");c(this,"vert");c(this,"frag");c(this,"defines");c(this,"uniforms");c(this,"useLight");c(this,"depthTest");c(this,"depthWrite");c(this,"cullFace");c(this,"drawType");c(this,"blending");c(this,"visibilityFlag");c(this,"programCache");n=n||{},this.name=n.name||"",this.visibilityFlag={},this.setVisibility(n.phase||["shadowMap","deferred"]),this.useLight=!0,this.depthTest=!0,this.cullFace=!1,this.depthWrite=n.depthTest!==void 0?n.depthTest:!0,this.drawType=n.drawType||"TRIANGLES",this.blending=n.blending||"NORMAL",this.vert=n.vert||dm,this.frag=n.frag||cm,this.defines=n.defines||{},this.uniforms=n.uniforms||{},this.programCache={}}setVisibility(n){this.visibilityFlag={shadowMap:n.indexOf("shadowMap")>-1,deferred:n.indexOf("deferred")>-1,forward:n.indexOf("forward")>-1,ui:n.indexOf("ui")>-1,envMap:n.indexOf("envMap")>-1,postprocess:n.indexOf("postprocess")>-1}}requestUpdate(){this.programCache={}}}const fm=new ti,hm=new X;class B extends b{constructor(n){super(n);c(this,"geometry");c(this,"material");const i=n.args||{};this.geometry=i.geometry||fm,this.material=i.material||hm,this.field("material",()=>this.material.name)}}class oe extends ei{constructor(n){super();c(this,"name");c(this,"position");c(this,"euler");c(this,"quaternion");c(this,"scale");c(this,"matrix");c(this,"matrixWorld");c(this,"matrixWorldPrev");c(this,"autoMatrixUpdate");c(this,"parent");c(this,"children");c(this,"components");c(this,"componentsSorted");c(this,"visible");c(this,"userData");this.name=n&&n.name||"",this.position=new M(0,0,0,1),this.euler=new En,this.quaternion=new qi(0,0,0,1),this.scale=new M(1,1,1),this.matrix=new K,this.matrixWorld=new K,this.matrixWorldPrev=new K,this.autoMatrixUpdate=!0,this.parent=null,this.children=[],this.components=new Map,this.componentsSorted=[],this.visible=!0,this.userData={},this.field("name",()=>this.name,i=>this.name=i),this.field("position",()=>this.position.getElm("vec3"),i=>this.position.setFromArray(i),{format:{type:"vector"}}),this.field("euler",()=>this.euler.getElm("vec3"),i=>this.euler.setFromArray(i),{format:{type:"vector"}}),this.field("scale",()=>this.scale.getElm("vec3"),i=>this.scale.setFromArray(i),{format:{type:"vector"}}),this.field("children",()=>this.children.map(i=>i.uuid),{hidden:!0}),this.field("components",()=>{const i=[];return this.components.forEach(r=>i.push(r.uuid)),i},{hidden:!0})}update(n){const i={...n};i.matrix=this.matrixWorld,this.updateImpl(n);for(let r=0;r<this.componentsSorted.length;r++)this.componentsSorted[r].update(i);this.autoMatrixUpdate&&this.updateMatrix();for(let r=0;r<this.children.length;r++)this.children[r].update(i)}updateImpl(n){}onBeforeRender(n){for(let i=0;i<this.componentsSorted.length;i++)this.componentsSorted[i].beforeRender(n);for(let i=0;i<this.children.length;i++)this.children[i].onBeforeRender(n)}onAfterRender(n){this.matrixWorldPrev.copy(this.matrixWorld);for(let i=0;i<this.componentsSorted.length;i++)this.componentsSorted[i].afterRender(n);for(let i=0;i<this.children.length;i++)this.children[i].onAfterRender(n)}add(n){n.parent&&n.parent.remove(n),n.parent=this,this.children.push(n),this.noticeField("children")}remove(n){this.children=this.children.filter(i=>i.uuid!=n.uuid),this.noticeField("children")}updateMatrix(n){this.parent&&n&&this.parent.updateMatrix(!0);const i=this.parent?this.parent.matrixWorld:new K;this.quaternion.updated?this.euler.setFromQuaternion(this.quaternion):this.quaternion.setFromEuler(this.euler),this.quaternion.updated=!1,this.matrix.setFromTransform(this.position,this.quaternion,this.scale),this.matrixWorld.copy(this.matrix).preMultiply(i)}decomposeMatrix(n){n.decompose(this.position,this.quaternion,this.scale),this.updateMatrix()}applyMatrix(n){this.decomposeMatrix(this.matrix.clone().multiply(n))}lookAt(n){this.updateMatrix();const i=new K,r=new M;this.matrixWorld.decompose(r);const s=this.position.clone().add(n.clone().sub(r));i.lookAt(this.position,s,new M(0,1,0)),this.decomposeMatrix(i)}addComponent(n,...i){this.removeComponent(n);const[r]=i,s=new n({entity:this,args:r||{}});return this.components.set(n,s),this.componentsSorted.push(s),this.componentsSorted.sort((o,a)=>o.order-a.order),this.noticeField("components"),s}removeComponent(n){const i=this.components.get(n);i&&i.dispose(),this.components.delete(n),this.componentsSorted=this.componentsSorted.filter(r=>r!==i),this.noticeField("components")}removeComponentByUUID(n){for(const i of this.components){const r=i[0],s=i[1];if(s.uuid===n)return s.dispose(),this.components.delete(r),this.noticeField("components"),s}}getComponent(n){return this.components.get(n)}getComponentByUUID(n){for(const i of this.components.values())if(i.uuid===n)return i;return null}getComponentByTag(n){for(const i of this.components.values())if(i.tag===n)return i;return null}getComponentsByTag(n){const i=[];return this.components.forEach(r=>{r.tag==n&&i.push(r)}),i}findEntityByName(n){if(this.name==n)return this;for(let i=0;i<this.children.length;i++){const s=this.children[i].findEntityByName(n);if(s)return s}}findEntityByUUID(n){if(this.uuid==n)return this;for(let i=0;i<this.children.length;i++){const s=this.children[i].findEntityByUUID(n);if(s)return s}}getRootEntity(){return this.parent?this.parent.getRootEntity():this}getScenePath(n){let i="/"+this.name;return n&&n.uuid==this.uuid||this.parent&&(i=this.parent.getScenePath(n)+i),i}traverse(n){n(this),this.children.forEach(i=>i.traverse(n))}isVisibleTraverse(){return this.visible?this.parent?this.parent.isVisibleTraverse():!0:!1}dispose(){this.emit("dispose"),this.parent&&this.parent.remove(this),this.components.forEach(n=>{n.dispose()}),this.components.clear(),this.componentsSorted=[]}disposeRecursive(){this.dispose(),this.children.concat().forEach(n=>{n.disposeRecursive()}),this.children=[]}}class mm extends De{constructor(n,i){super();c(this,"gl");c(this,"connection");c(this,"frame");c(this,"nodes");c(this,"curveGroups");c(this,"root");c(this,"gltf");c(this,"currentData");this.gl=n,this.root=null,this.nodes=[],this.curveGroups=[],this.currentData=null,this.frame={start:0,end:100,current:0,fps:30,playing:!1},i&&this.connect(i)}connect(n,i){}disconnect(){}binaryStringToArrayBuffer(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);i[r]=s}return i.buffer}async loadScene(n,i){const r=JSON.parse(JSON.stringify(n));await new Promise(l=>{setTimeout(()=>{l(null)},100)}),this.frame.start=r.frame.start,this.frame.end=r.frame.end,this.frame.fps=r.frame.fps,this.curveGroups=[],this.nodes=[];const s=Object.keys(r.animations);r.version===2&&r.fcurves.forEach(l=>{for(let u=1;u<l.k.length;u++)l.k[u][1][0]+=l.k[u-1][1][0]});for(let l=0;l<s.length;l++){const u=s[l],d=new lm(u);r.animations[l].forEach(h=>{const f=r.fcurves[h],v=new am;v.set(f.k.map(x=>{const _=x[1];return new um({x:_[0],y:_[1]},_[2]!==void 0&&{x:_[2],y:_[3]}||void 0,_[4]!==void 0&&{x:_[4],y:_[5]}||void 0,["LINEAR","CONSTANT","BEZIER"][x[0]])})),d.setFCurve(v,f.axis)}),this.curveGroups.push(d)}this.nodes=[];const a=l=>{const u={name:l.name,class:l.class,uuid:l.uuid,children:[],animations:l.animation||{},position:l.position||[0,0,0],rotation:l.rotation||[0,0,0],scale:l.scale||[1,1,1],uniforms:l.uniforms||{},type:l.type||"empty",visible:l.visible!==void 0?l.visible:!0},d=l.param;return d&&"position"in d?u.param={position:new Float32Array(this.binaryStringToArrayBuffer(atob(d.position))),normal:new Float32Array(this.binaryStringToArrayBuffer(atob(d.normal))),uv:new Float32Array(this.binaryStringToArrayBuffer(atob(d.uv))),index:new Uint16Array(this.binaryStringToArrayBuffer(atob(d.index)))}:u.param=d,l.children&&l.children.forEach(h=>{u.children.push(a(h))}),this.nodes.push(u),u};this.root=a(r.root),this.currentData=r,this.emit("sync/scene",[this])}onSyncTimeline(n){this.frame=n,this.emit("sync/timeline",[this.frame])}onOpen(){}onMessage(n){}onClose(){this.disconnect()}getCurveGroup(n){return this.curveGroups[n]}setFrame(n){this.onSyncTimeline({...this.frame,playing:!0,current:n})}get gltfPrm(){return this.gltf?Promise.resolve(this.gltf):new Promise(n=>{this.on("gltfLoaded",i=>{n(i)})})}dispose(){this.disconnect()}}class Je extends ti{constructor(t){super();const n=[],i=[],r=[],s=[],o=[],{width:a,height:l,depth:u,segmentsWidth:d,segmentsHeight:h,segmentsDepth:f}={width:1,height:1,depth:1,segmentsWidth:1,segmentsHeight:1,segmentsDepth:1,...t},v=[{normal:[0,0,1],dir:[1,0,0],up:[0,1,0],w:a,h:l,d:u,segW:d,segH:h},{normal:[0,0,-1],dir:[-1,0,0],up:[0,1,0],w:a,h:l,d:u,segW:d,segH:h},{normal:[1,0,0],dir:[0,0,-1],up:[0,1,0],w:u,h:l,d:a,segW:f,segH:h},{normal:[-1,0,0],dir:[0,0,1],up:[0,1,0],w:u,h:l,d:a,segW:f,segH:h},{normal:[0,1,0],dir:[-1,0,0],up:[0,0,1],w:a,h:u,d:l,segW:d,segH:f},{normal:[0,-1,0],dir:[-1,0,0],up:[0,0,-1],w:a,h:u,d:l,segW:d,segH:f}];let x=0;for(const _ of v){const z=_.normal,g=_.dir,p=_.up,y=_.segW,w=_.segH,E=_.w/2,k=_.h/2,C=_.d/2,T=_.w/y,F=_.h/w;for(let D=0;D<=w;D++)for(let L=0;L<=y;L++){const V=-E+L*T,me=-k+D*F,H=-C,Ce=L/y,tt=D/w,Le=V*-g[0]+me*p[0]+H*-z[0],N=V*-g[1]+me*p[1]+H*-z[1],U=V*-g[2]+me*p[2]+H*-z[2];if(n.push(Le,N,U),i.push(...z),r.push(Ce,tt),o.push(D/w*p[1]+Math.max(0,p[2])),D<w&&L<y){const j=x+D*(y+1)+L,te=x+(D+1)*(y+1)+L,fe=x+(D+1)*(y+1)+(L+1),en=x+D*(y+1)+(L+1);s.push(j,te,en),s.push(te,fe,en)}}x+=(y+1)*(w+1)}this.setAttribute("position",new Float32Array(n),3),this.setAttribute("normal",new Float32Array(i),3),this.setAttribute("uv",new Float32Array(r),2),this.setAttribute("posY",new Float32Array(o),1),this.setAttribute("index",new Uint16Array(s),1)}}class _s extends ti{constructor(t){super();const n=[],i=[],r=[],s=[],{height:o,radiusTop:a,radiusBottom:l,radSegments:u,heightSegments:d,caps:h}={height:1,radiusTop:1,radiusBottom:1,radSegments:8,heightSegments:1,caps:!0,...t};for(let f=0;f<=d+2;f++)for(let v=0;v<=u;v++){const x=Math.PI*2/u*v;if(f<=d){const _=1-f/d,z=(1-_)*a+_*l,g=Math.cos(x)*z,p=-(o/2)+o/d*f,y=Math.sin(x)*z;n.push(g,p,y),r.push(v/u,f/d);const w=new M(Math.cos(x),0,Math.sin(x)).normalize();if(i.push(w.x,w.y,w.z),f<d){const E=u+1;s.push(f*E+v,(f+1)*E+(v+1)%E,f*E+(v+1)%E,f*E+v,(f+1)*E+v,(f+1)*E+(v+1)%E)}}else{if(!h)continue;const _=f-d-1,z=_?a:l,g=Math.cos(x)*z,p=-(o/2)+o*_,y=Math.sin(x)*z;n.push(g,p,y),r.push((g+z)*.5/z,(y+z)*.5/z),i.push(0,-1+_*2,0);const w=(u+1)*(d+(_+1));v<=u-2&&(_==0?s.push(w,w+v,w+v+1):s.push(w,w+v+1,w+v))}}this.setAttribute("position",new Float32Array(n),3),this.setAttribute("normal",new Float32Array(i),3),this.setAttribute("uv",new Float32Array(r),2),this.setAttribute("index",new Uint16Array(s),1)}}class yn extends ti{constructor(t){super();const{width:n,height:i,widthSegments:r,heightSegments:s,floor:o}={width:1,height:1,widthSegments:1,heightSegments:1,...t},a=n/2,l=i/2,u=[],d=[],h=[],f=[];for(let v=0;v<=s;v++)for(let x=0;x<=r;x++){const _=x/r,z=v/s;if(o?(u.push(-a+n*_,0,l-i*z),d.push(0,1,0)):(u.push(-a+n*_,-l+i*z,0),d.push(0,0,1)),h.push(_,z),v>0&&x>0){const g=r+1,p=g*v+x,y=g*(v-1)+x-1;f.push(p,g*v+x-1,y,p,y,g*(v-1)+x)}}this.setAttribute("position",new Float32Array(u),3),this.setAttribute("normal",new Float32Array(d),3),this.setAttribute("uv",new Float32Array(h),2),this.setAttribute("index",new Uint16Array(f),1)}}class xt extends ti{constructor(t){super();const n=[],i=[],r=[],s=[],{radius:o,widthSegments:a,heightSegments:l}={radius:.5,widthSegments:8,heightSegments:8,...t};for(let u=0;u<=l;u++){const d=u/l*Math.PI;for(let h=0;h<=a;h++){const f=h/a*Math.PI*2,v=Math.sin(d)*o,x=Math.cos(f)*v,_=-Math.cos(d)*o,z=-Math.sin(f)*v;n.push(x,_,z),r.push(h/a,u/l);const g=new M(x,_,z).normalize();if(i.push(g.x,g.y,g.z),h<a&&u<l){const p=a+1;s.push(u*p+h,u*p+(h+1)%p,(u+1)*p+(h+1)%p,u*p+h,(u+1)*p+(h+1)%p,(u+1)*p+h)}}}for(let u=0;u<s.length;u++)s[u]=Math.min(n.length/3-1,s[u]);this.setAttribute("position",new Float32Array(n),3),this.setAttribute("normal",new Float32Array(i),3),this.setAttribute("uv",new Float32Array(r),2),this.setAttribute("index",new Uint16Array(s),1)}}class wa extends b{constructor(n){super(n);c(this,"cameraType");c(this,"fov");c(this,"aspect");c(this,"near");c(this,"far");c(this,"orthWidth");c(this,"orthHeight");c(this,"projectionMatrix");c(this,"viewMatrix");c(this,"projectionMatrixPrev");c(this,"viewMatrixPrev");c(this,"needsUpdateProjectionMatrix");c(this,"displayOut");c(this,"viewPort");this.cameraType="perspective",this.viewMatrix=new K,this.projectionMatrix=new K,this.viewMatrixPrev=new K,this.projectionMatrixPrev=new K,this.viewPort=null,this.fov=50,this.near=.1,this.far=1e3,this.aspect=1,this.orthWidth=1,this.orthHeight=1,this.needsUpdateProjectionMatrix=!0,this.displayOut=!0,this._tag="camera"}updateProjectionMatrix(){this.cameraType=="perspective"?this.projectionMatrix.perspective(this.fov,this.aspect,this.near,this.far):this.projectionMatrix.orthographic(this.orthWidth,this.orthHeight,this.near,this.far),this.needsUpdateProjectionMatrix=!1}updateViewMatrix(){this.viewMatrix.copy(this.entity.matrixWorld).inverse()}beforeRenderImpl(n){this.updateViewMatrix(),this.needsUpdateProjectionMatrix&&this.updateProjectionMatrix()}afterRenderImpl(n){this.viewMatrixPrev.copy(this.viewMatrix),this.projectionMatrixPrev.copy(this.projectionMatrix)}}class pm extends wa{constructor(n){super(n);c(this,"renderTarget");c(this,"viewMatrixOffset");this.renderTarget=null,this.viewMatrixOffset=new qi().setFromEuler({x:-Math.PI/2,y:0,z:0}),this.near=.1,this.far=100}beforeRenderImpl(n){super.beforeRenderImpl(n),this.viewMatrix.copy(this.entity.matrixWorld).applyQuaternion(this.viewMatrixOffset).inverse()}}class Tn extends pm{constructor(n){super(n);c(this,"_lightType");c(this,"color");c(this,"intensity");c(this,"castShadow");c(this,"_shadowMapSize");c(this,"angle");c(this,"blend");c(this,"distance");c(this,"decay");this._lightType="spot",this.cameraType="perspective",this.color=new M(1,1,1,0),this.intensity=1,this.castShadow=!0,this._shadowMapSize=new M(256,256),this.orthWidth=4,this.orthHeight=4,this.angle=Math.PI*.5,this.blend=1,this.distance=30,this.decay=2,this.field("type",()=>this._lightType,i=>{this._lightType=i,this.updateProjectionMatrix()},{format:{type:"select",list:[{label:"Directional",value:"directional"},{label:"Spot",value:"spot"}]}}),this.field("intensity",()=>this.intensity,i=>this.intensity=i,{noExport:!0}),this.field("blend",()=>this.blend,i=>this.blend=i,{noExport:!0}),this.field("angle",()=>this.angle,i=>{this.angle=i,this.updateProjectionMatrix()},{noExport:!0}),this.field("color",()=>this.color.getElm("vec3"),i=>this.color.setFromArray(i),{noExport:!0}),this.field("castShadow",()=>this.castShadow,i=>this.castShadow=i,{noExport:!0}),this.field("distance",()=>this.distance,i=>this.distance=i,{noExport:!0}),this.field("decay",()=>this.decay,i=>this.decay=i,{noExport:!0}),this.updateProjectionMatrix()}get lightType(){return this._lightType}set lightType(n){this._lightType=n,this.updateProjectionMatrix()}updateProjectionMatrix(){this.fov=this.angle/Math.PI*180,super.updateProjectionMatrix()}setShadowMap(n){this.renderTarget=n,this.renderTarget.setSize(this._shadowMapSize)}setShadowMapSize(n){this._shadowMapSize.copy(n),this.renderTarget&&this.renderTarget.setSize(this._shadowMapSize)}lookAt(n){this.entity.lookAt(n),this.entity.quaternion.multiply(new qi().setFromEuler(new En(Math.PI/2)))}}class vt extends b{constructor(n){super(n);c(this,"node");c(this,"rotationOffsetX");c(this,"animations");c(this,"uniforms");c(this,"uniformCurves");c(this,"transformAutoUpdate");c(this,"_blidge");c(this,"_cameraComponent");c(this,"_lightComponent");this.rotationOffsetX=0,this.animations=new Map,this.uniforms={},this.uniformCurves=new Map,this.transformAutoUpdate=!0,this._blidge=n.args.blidge,this.node=n.args.node,this.node.type=="camera"&&(this.rotationOffsetX=-Math.PI/2);const i=Object.keys(this.node.animations);for(let o=0;o<i.length;o++){const a=i[o];this.animations.set(a,this._blidge.getCurveGroup(this.node.animations[a]))}const r=Object.keys(this.node.uniforms);for(let o=0;o<r.length;o++){const a=r[o],l=this.node.uniforms[a],u=this._blidge.curveGroups[l];u&&(this.uniformCurves.set(a,u),this.uniforms[a]={type:"4fv",value:u.value})}const s=this.entity;if(this.node.uuid&&(s.uuid=this.node.uuid),s.name=this.node.name,s.position.set(this.node.position[0],this.node.position[1],this.node.position[2]),s.quaternion.setFromEuler({x:this.node.rotation[0]+this.rotationOffsetX,y:this.node.rotation[1],z:this.node.rotation[2]},"YZX"),s.quaternion.updated=!1,s.euler.setFromQuaternion(s.quaternion),s.scale.set(this.node.scale[0],this.node.scale[1],this.node.scale[2]),this.node.type=="cube"){const o=s.addComponent(B),a=this.node.param;o.geometry=new Je({width:a.x,height:a.y,depth:a.z,segmentsWidth:10,segmentsHeight:10,segmentsDepth:10})}else if(this.node.type=="sphere"){const o=s.addComponent(B),a=this.node.param;o.geometry=new xt({radius:a.r,widthSegments:32,heightSegments:16})}else if(this.node.type=="cylinder"){const o=s.addComponent(B);o.geometry=new _s}else if(this.node.type=="plane"){const o=s.addComponent(B),a=this.node.param;o.geometry=new yn({width:a.x,height:a.y})}else if(this.node.type=="mesh"){const o=s.addComponent(B),a=this.node.param,l=new ti;l.setAttribute("position",a.position,3),l.setAttribute("uv",a.uv,2),l.setAttribute("normal",a.normal,3),l.setAttribute("index",a.index,3),o.geometry=l}else if(this.node.type=="gltf"){const o=s.addComponent(B);this._blidge.gltfPrm.then(a=>{const l=a.scene.findEntityByName(this.node.name);if(l){const u=l.getComponent(B);u&&(o.geometry=u.geometry,o.material=u.material)}this.emit("update/blidge/scene",[s])})}if(this.node.type=="light"){const o=this.node.param;this._lightComponent=s.addComponent(Tn),this._lightComponent.deserialize({...o,lightType:o.type,color:new M().copy(o.color).getElm("vec3"),castShadow:o.shadow_map!==void 0?o.shadow_map:!0})}if(this.node.type=="camera"&&(this._cameraComponent=s.getComponentsByTag("camera")[0],this._cameraComponent)){const o=this.node.param;this._cameraComponent.fov=o.fov}s.visible=this.node.visible}bindUniforms(n){Object.assign(n,this.uniforms)}updateImpl(n){if(!this._blidge||!this.node)return;const i=n.timeCode*this._blidge.frame.fps;if(this.animations.forEach(s=>{s.setFrame(i)}),this.transformAutoUpdate){const s=this.animations.get("position");if(s){const l=s.value;s.getFCurve("x")&&(this.entity.position.x=l.x),s.getFCurve("y")&&(this.entity.position.y=l.y),s.getFCurve("z")&&(this.entity.position.z=l.z)}const o=this.animations.get("rotation");if(o){const l={x:this.node.rotation[0],y:this.node.rotation[1],z:this.node.rotation[2]},u=o.value;o.getFCurve("x")&&(l.x=u.x),o.getFCurve("y")&&(l.y=u.y),o.getFCurve("z")&&(l.z=u.z),this.entity.quaternion.setFromEuler({x:l.x+this.rotationOffsetX,y:l.y,z:l.z},"YZX")}const a=this.animations.get("scale");if(a){const l=a.setFrame(i).value;a.getFCurve("x")&&(this.entity.scale.x=l.x),a.getFCurve("y")&&(this.entity.scale.y=l.y),a.getFCurve("z")&&(this.entity.scale.z=l.z)}}const r=this.animations.get("hide");if(r&&(this.entity.visible=r.value.x<.5),this._lightComponent){const s=this.animations.get("light");if(s){const o=s.setFrame(i).value;this._lightComponent.intensity=o.x}}this.uniformCurves.forEach((s,o)=>{this.uniforms[o].value=s.setFrame(i).value})}}class et extends ei{constructor(n){super();c(this,"name");c(this,"enabled");c(this,"_passes");const r=("pipeline"in n?void 0:n)||{};this.name=r.name||"",this.enabled=!0,this._passes=r.passes||[]}get passes(){return this._passes}get hasOutput(){return this._passes.length>0&&this._passes.some(n=>n.enabled)}get output(){for(let n=this._passes.length-1;n>=0;n--){const i=this._passes[n];if(!i.passThrough&&i.enabled)return i.renderTarget}return null}resize(n){if(this._passes)for(let i=0;i<this._passes.length;i++)this._passes[i].resize(n)}dispose(){this.emit("dispose")}}class vm extends et{constructor(n){super({...n});c(this,"_passes");c(this,"date");this._passes=n.passes,this.date=new Date}get passes(){return this._passes}compute(n){const i=Math.min(.016666666666666666,(new Date().getTime()-this.date.getTime())/1e3);this.date=new Date,this.passes.forEach(r=>{r.uniforms.uDeltaTime.value=i}),n.renderPostProcess(this)}}const gm=`// @shader-file: packages/maxpower/PostProcess/PostProcessPass/shaders/pass.fs
#include<common>
uniform sampler2D uBackBuffer0;layout(location=0)out vec4 outColor;in vec2 vUv;void main(){outColor=texture(uBackBuffer0,vUv);outColor.w=1.;}`,ym=`// @shader-file: packages/maxpower/PostProcess/PostProcessPass/shaders/quad.vs
layout(location=0)in vec3 position;layout(location=1)in vec2 uv;out vec2 vUv;void main(){gl_Position=vec4(position.xy,0,1);vUv=uv;}`;class Q extends X{constructor(n,i){super({...i,frag:i.frag||gm,vert:i.vert||ym});c(this,"enabled");c(this,"renderTarget");c(this,"backBufferOverride");c(this,"clearColor");c(this,"clearDepth");c(this,"resolutionRatio");c(this,"passThrough");c(this,"resolution");c(this,"resolutionInv");c(this,"viewPort");c(this,"_fixedResolution");this.enabled=!0,this._fixedResolution=i.fixedResotluion?i.fixedResotluion.clone():null,this.resolution=new M,this.resolutionInv=new M,this.viewPort=null,this.uniforms.uPPResolution={value:this.resolution,type:"2fv"},this.uniforms.uPPPixelSize={value:this.resolutionInv,type:"2fv"},this.renderTarget=i.renderTarget!==void 0?i.renderTarget:new Z(n).setTexture([new W(n).setting({magFilter:n.LINEAR,minFilter:n.LINEAR})]),this.clearColor=i.clearColor??null,this.clearDepth=i.clearDepth??null,this.depthTest=i.depthTest!==void 0?i.depthTest:!1,this.resolutionRatio=i.resolutionRatio||1,this.passThrough=i.passThrough??!1,this.viewPort=i.viewPort||null,this.backBufferOverride=i.backBufferOverride||null}get fixedResolution(){return this._fixedResolution}set fixedResolution(n){this._fixedResolution=n,this.resize(n||new M)}onAfterRender(){}resize(n){this._fixedResolution?this.resolution.copy(this._fixedResolution):this.resolution.copy(n).multiply(this.resolutionRatio),this.resolutionInv.set(1/this.resolution.x,1/this.resolution.y),this.renderTarget&&this.renderTarget.setSize(this.resolution)}setRendertarget(n){this.renderTarget=n,this.renderTarget&&(this.renderTarget.size.x!=this.resolution.x||this.renderTarget.size.y!=this.resolution.y)&&this.renderTarget.setSize(this.resolution)}}var A;(e=>{e.assign=(t,...n)=>{for(let i=0;i<n.length;i++)n[i]!=null&&Object.assign(t,n[i]);return t},e.merge=(...t)=>{const n={};return(0,e.assign)(n,...t)}})(A||(A={}));const xm=`// @shader-file: packages/maxpower/Component/GPUComputePass/shaders/quad.vs
layout(location=0)in vec3 position;layout(location=1)in vec2 uv;out vec2 vUv;void main(){gl_Position=vec4(position.xy,0,1);vUv=uv;}`;class _m extends Q{constructor(n,i){const r=Object.assign({type:n.FLOAT,internalFormat:n.RGBA32F,format:n.RGBA,magFilter:n.NEAREST,minFilter:n.NEAREST},i.textureParam),s=new Z(n).setTexture(new Array(i.dataLayerCount).fill(0).map(()=>new W(n).setting(r))).setSize(i.size),o=new Z(n).setTexture(new Array(i.dataLayerCount).fill(0).map(()=>new W(n).setting(r))).setSize(i.size),a={uGPUResolution:{value:i.size,type:"2fv"}};for(let l=0;l<i.dataLayerCount;l++)a["uGPUSampler"+l]={value:o.textures[l],type:"1i"};super(n,{...i,vert:i.vert||xm,renderTarget:s,uniforms:A.merge(i.uniforms,a,{uDeltaTime:{value:0,type:"1f"}})});c(this,"gl");c(this,"size");c(this,"layerCnt");c(this,"clearColor");c(this,"rt1");c(this,"rt2");c(this,"outputUniforms");this.gl=n,this.size=i.size,this.layerCnt=i.dataLayerCount,this.rt1=s,this.rt2=o,this.renderTarget=this.rt1,this.clearColor=i.clearColor??null,this.outputUniforms=a}onAfterRender(){super.onAfterRender();for(let i=0;i<this.layerCnt;i++)this.outputUniforms["uGPUSampler"+i].value=this.renderTarget.textures[i];const n=this.rt1;this.rt1=this.rt2,this.rt2=n,this.renderTarget=this.rt1}initTexture(n){for(let i=0;i<this.layerCnt;i++){this.gl.bindTexture(this.gl.TEXTURE_2D,this.rt2.textures[i].getTexture());const r=[];for(let s=0;s<this.size.y;s++)for(let o=0;o<this.size.x;o++){const a=o,l=s;r.push(...n(i,a,l))}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.size.x,this.size.y,this.gl.RGBA,this.gl.FLOAT,new Float32Array(r))}this.gl.bindTexture(this.gl.TEXTURE_2D,null)}}class Wr extends wa{constructor(n){super(n);c(this,"dofParams");c(this,"_gl");c(this,"_renderTarget");c(this,"_gBuffer");c(this,"_resolution");this.dofParams={focusDistance:.5,kFilmHeight:.008};const i=n.args.gl;this._gl=i,this._resolution=new M,this._gBuffer=new Z(i),this._gBuffer.setTexture([new W(i).setting({type:i.FLOAT,internalFormat:i.RGBA32F,format:i.RGBA,magFilter:i.NEAREST,minFilter:i.NEAREST}),new W(i).setting({type:i.FLOAT,internalFormat:i.RGBA32F,format:i.RGBA}),new W(i),new W(i),new W(i).setting({type:i.FLOAT,internalFormat:i.RGBA32F,format:i.RGBA})]);const r=new Z(i,{disableDepthBuffer:!0});r.setTexture([new W(i).setting({type:i.FLOAT,internalFormat:i.RGBA16F,format:i.RGBA}),new W(i).setting({type:i.FLOAT,internalFormat:i.RGBA16F,format:i.RGBA})]);const s=new Z(i,{disableDepthBuffer:!0});s.setDepthTexture(this._gBuffer.depthTexture),s.setTexture([r.textures[0],this._gBuffer.textures[0],this._gBuffer.textures[4]]);const o=new Z(i,{disableDepthBuffer:!0});o.setDepthTexture(this._gBuffer.depthTexture),o.setTexture([new W(i)]),this._renderTarget={gBuffer:this._gBuffer,shadingBuffer:r,forwardBuffer:s,uiBuffer:o},this.resize(this._resolution)}get resolution(){return this._resolution}get gBuffer(){return this._gBuffer}get renderTarget(){return this._renderTarget}resize(n){n.x==this._resolution.x&&n.y==this._resolution.y||(this._resolution.copy(n),this.aspect=n.x/n.y,this._renderTarget&&(this._renderTarget.gBuffer.setSize(this._resolution),this._renderTarget.shadingBuffer.setSize(this._resolution),this._renderTarget.forwardBuffer.setSize(this._resolution),this._renderTarget.uiBuffer.setSize(this._resolution)),this.needsUpdateProjectionMatrix=!0)}}new X;class lc extends b{constructor(n){super(n);c(this,"_resolution");c(this,"_postProcesses");c(this,"_postProcessesDict");this._postProcesses=[],this._postProcessesDict=new Map,this._resolution=new M,this.field("postprocess",()=>this._postProcesses.map((i,r)=>i.enabled),i=>{i.forEach((r,s)=>{const o=this._postProcesses[s];o&&(o.enabled=r)})},{format:{type:"array",labels:(i,r)=>this._postProcesses[r].name}})}get postProcesses(){return this._postProcesses}add(n,...i){const[r]=i,s=new n({pipeline:this,args:r||{}});return this.postProcesses.push(s),s.resize(this._resolution),s}remove(n){const i=this._postProcesses.indexOf(n);i>-1&&this._postProcesses.splice(i,1)}resize(n){this._resolution.copy(n),this.postProcesses.forEach(i=>{i.resize(n)})}}const wm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/common.module.glsl
#define PI 3.14159265359
#define TPI 6.28318530718
#define HPI 1.57079632679
#define saturate(x)clamp(x,0.,1.)
struct Geometry{vec3 position;vec3 normal;float depth;vec3 viewDir;vec3 viewDirWorld;float occulusion;};struct Material{vec3 color;float roughness;float metalic;vec3 emission;vec3 diffuseColor;vec3 specularColor;float envMapIntensity;float gradient;};float sinn(float e){return sin(e-HPI)*.5+.5;}float atan2(float e,float s){return s==0.?sign(e)*PI/2.:atan(e,s);}
#define linearstep(edge0,edge1,x)min(max(((x)-(edge0))/((edge1)-(edge0)),0.0),1.0)
float easeInOut(float e){return e<.5?8.*e*e*e*e:1.-pow(-2.*e+2.,4.)/2.;}float easeOut(float e,float s){return(exp(-clamp(e,0.,1.)*s)-1.)/(exp(-s)-1.);}float easeIn(float e,float s){return 1.-easeOut(1.-e,s);}float easeBounce(float e,float s){e=1.-e;return 1.-e*e*(s*e-s+1.);}vec3 rgb2hsv(vec3 e){vec4 s=vec4(0,-1./3.,2./3.,-1),v=mix(vec4(e.zy,s.wz),vec4(e.yz,s),step(e.z,e.y));s=mix(vec4(v.xyw,e.x),vec4(e.x,v.yzx),step(v.x,e.x));float f=s.x-min(s.w,s.y);return vec3(abs(s.z+(s.w-s.y)/(6.*f+1e-10)),f/(s.x+1e-10),s);}vec3 hsv2rgb(vec3 e){return((clamp(abs(fract(e.x+vec3(0,2,1)/3.)*6.-3.)-1.,0.,1.)-1.)*e.y+1.)*e.z;}vec3 srgbToLinear(vec3 e){return mix(e/12.92,pow((e+.055)/1.055,vec3(2.4)),step(.04045,e));}vec3 linearToSrgb(vec3 e){return mix(e*12.92,pow(e,vec3(1./2.4))*1.055-.055,step(.0031308,e));}vec4 floatToRGBA(float e){vec4 s=fract(vec4(1,255,65025,16581375)*e);return s-s.yzww*vec4(1./255.,1./255.,1./255.,0);}float rgbaToFloat(vec4 e){return dot(e,vec4(1,1./255.,1./65025.,1./16581375.));}`,Sm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/hash.module.glsl
float hash11(float f){f=fract(f*.1031);f*=f+33.33;f*=f+f;return fract(f);}float hash12(vec2 f){vec3 v=fract(vec3(f.xyx)*.1031);v+=dot(v,v.yzx+33.33);return fract((v.x+v.y)*v.z);}float hash13(vec3 v){v=fract(v*.1031);v+=dot(v,v.zyx+31.32);return fract((v.x+v.y)*v.z);}float hash14(vec4 v){v=fract(v*vec4(.1031,.103,.0973,.1099));v+=dot(v,v.wzxy+33.33);return fract((v.x+v.y)*(v.z+v.w));}vec2 hash21(float v){vec3 f=fract(vec3(v)*vec3(.1031,.103,.0973));f+=dot(f,f.yzx+33.33);return fract((f.xx+f.yz)*f.zy);}vec2 hash22(vec2 v){vec3 f=fract(vec3(v.xyx)*vec3(.1031,.103,.0973));f+=dot(f,f.yzx+33.33);return fract((f.xx+f.yz)*f.zy);}vec2 hash23(vec3 v){v=fract(v*vec3(.1031,.103,.0973));v+=dot(v,v.yzx+33.33);return fract((v.xx+v.yz)*v.zy);}vec3 hash31(float v){vec3 f=fract(vec3(v)*vec3(.1031,.103,.0973));f+=dot(f,f.yzx+33.33);return fract((f.xxy+f.yzz)*f.zyx);}vec3 hash32(vec2 v){vec3 f=fract(vec3(v.xyx)*vec3(.1031,.103,.0973));f+=dot(f,f.yxz+33.33);return fract((f.xxy+f.yzz)*f.zyx);}vec3 hash33(vec3 v){v=fract(v*vec3(.1031,.103,.0973));v+=dot(v,v.yxz+33.33);return fract((v.xxy+v.yxx)*v.zyx);}vec4 hash41(float v){vec4 f=fract(vec4(v)*vec4(.1031,.103,.0973,.1099));f+=dot(f,f.wzxy+33.33);return fract((f.xxyz+f.yzzw)*f.zywx);}vec4 hash42(vec2 v){vec4 f=fract(vec4(v.xyxy)*vec4(.1031,.103,.0973,.1099));f+=dot(f,f.wzxy+33.33);return fract((f.xxyz+f.yzzw)*f.zywx);}vec4 hash43(vec3 v){vec4 f=fract(vec4(v.xyzx)*vec4(.1031,.103,.0973,.1099));f+=dot(f,f.wzxy+33.33);return fract((f.xxyz+f.yzzw)*f.zywx);}vec4 hash44(vec4 v){v=fract(v*vec4(.1031,.103,.0973,.1099));v+=dot(v,v.wzxy+33.33);return fract((v.xxyz+v.yzzw)*v.zywx);}`,Cm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/light.module.glsl
struct DirectionalLight{vec3 direction;vec3 color;};struct SpotLight{vec3 position;vec3 direction;vec3 color;float angle;float blend;float distance;float decay;};struct LightCamera{float near;float far;mat4 viewMatrix;mat4 projectionMatrix;vec2 resolution;};struct Light{vec3 direction;vec3 color;};
#if NUM_LIGHT_DIR>0
uniform DirectionalLight uDirectionalLight[NUM_LIGHT_DIR];uniform LightCamera uDirectionalLightCamera[NUM_LIGHT_DIR];
#if NUM_SHADOWMAP_DIR>0
uniform sampler2D uDirectionalLightShadowMap[NUM_SHADOWMAP_DIR];
#endif
#endif
#if NUM_LIGHT_SPOT>0
uniform SpotLight uSpotLight[NUM_LIGHT_SPOT];uniform LightCamera uSpotLightCamera[NUM_LIGHT_SPOT];
#if NUM_SHADOWMAP_SPOT>0
uniform sampler2D uSpotLightShadowMap[NUM_SHADOWMAP_SPOT];
#endif
#endif
float compareShadowDepth(float f,sampler2D d,vec2 L,float v){float g=rgbaToFloat(texture(d,L));return L.x>=0.&&L.x<=1.&&L.y>=0.&&L.y<=1.?step(f,g+v):1.;}void setShadowCoord(vec3 f,LightCamera c,inout vec2 v,inout float s){vec4 L=c.viewMatrix*vec4(f,1),g=c.projectionMatrix*L;v=g.xy/g.w*.5+.5;float d=c.near;s=(-L.z-d)/(c.far-d);}float getShadow(vec3 f,LightCamera L,sampler2D d,float s){vec2 g;float v;setShadowCoord(f,L,g,v);return compareShadowDepth(v,d,g,s);}
#define SHADOW_SAMPLE_COUNT 2
float getShadowSmooth(vec3 f,LightCamera L,sampler2D g,float s){vec2 d;float v;setShadowCoord(f,L,d,v);float u=compareShadowDepth(v,g,d,s);for(int f=0;f<SHADOW_SAMPLE_COUNT;f++){vec2 c=1./L.resolution*(float(f+1)/float(SHADOW_SAMPLE_COUNT));u+=compareShadowDepth(v,g,d+vec2(-c.x,-c.y),s);u+=compareShadowDepth(v,g,d+vec2(0,-c.y),s);u+=compareShadowDepth(v,g,d+vec2(c.x,-c.y),s);u+=compareShadowDepth(v,g,d+vec2(-c.x,0),s);u+=compareShadowDepth(v,g,d+vec2(c.x,0),s);u+=compareShadowDepth(v,g,d+vec2(-c.x,c.y),s);u+=compareShadowDepth(v,g,d+vec2(0,c.y),s);u+=compareShadowDepth(v,g,d+vec2(c),s);}return u/(float(SHADOW_SAMPLE_COUNT)*8.);}float ggx(float f,float v){v*=v;v*=v;f*=f;return f<=0.?0.:v/(PI*pow(f*(v-1.)+1.,2.));}vec3 lambert(vec3 v){return v/PI;}float gSchlick(float v,float s){return v==0.?0.:v/(v*(1.-s)+s);}float gSmith(float v,float f,float s){s=clamp(s*sqrt(2./PI),0.,1.);return gSchlick(v,s)*gSchlick(f,s);}float fresnel(float v){return.04+.96*pow(1.-v,5.);}vec3 RE(Geometry v,Material f,Light c){vec3 s=normalize(c.direction),g=normalize(v.viewDir+s);float d=clamp(dot(v.normal,v.viewDir),0.,1.),L=clamp(dot(v.normal,s),0.,1.);vec3 u=c.color*L,i=lambert(f.diffuseColor)*u;float D=ggx(clamp(dot(v.normal,g),0.,1.),f.roughness),p=gSmith(d,L,f.roughness),T=fresnel(clamp(dot(s,g),0.,1.));return vec3(0)+i*(1.-T)+D*p*T/(4.*L*d+1e-4)*f.specularColor*u;}`,Em=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/matrix.module.glsl
mat4 makeScale(float m){return mat4(m,0.,0.,0.,0.,m,0.,0.,0.,0.,m,0.,0.,0.,0.,1.);}mat4 makeScale(vec3 m){return mat4(m.x,0.,0.,0.,0.,m.y,0.,0.,0.,0.,m.z,0.,0.,0.,0.,1.);}mat4 makeTranslation(vec3 m){return mat4(1.,0.,0.,0.,0.,1.,0.,0.,0.,0.,1.,0.,m.x,m.y,m.z,1.);}mat4 makeRotationX(float m){float x=cos(m);m=sin(m);return mat4(1.,0.,0.,0.,0.,x,-m,0.,0.,m,x,0.,0.,0.,0.,1.);}mat4 makeRotationY(float m){float x=cos(m);m=sin(m);return mat4(x,0.,m,0.,0.,1.,0.,0.,-m,0.,x,0.,0.,0.,0.,1.);}mat4 makeRotationZ(float m){float x=cos(m);m=sin(m);return mat4(x,-m,0.,0.,m,x,0.,0.,0.,0.,1.,0.,0.,0.,0.,1.);}mat4 makeRotationXY(float m){return makeRotationZ(m);}mat4 makeRotationYZ(float m){return makeRotationX(m);}mat4 makeRotationXZ(float m){return makeRotationY(-m);}mat4 makeRotationFromEuler(vec3 m){return makeRotationZ(m.z)*makeRotationY(m.y)*makeRotationX(m.x);}mat4 mat3ToMat4(mat3 m){return mat4(m[0][0],m[0][1],m[0][2],0.,m[1][0],m[1][1],m[1][2],0.,m[2][0],m[2][1],m[2][2],0.,0.,0.,0.,1.);}mat3 normalMatrix(mat4 m){return mat3(m[0][0],m[0][1],m[0][2],m[1][0],m[1][1],m[1][2],m[2][0],m[2][1],m[2][2]);}`,Tm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/noiseCyclic.module.glsl
vec3 noiseCyc(vec3 c){vec4 f=vec4(0);float n=1.;for(int r=0;r<8;r++)c+=sin(c.zxy),f+=vec4(cross(sin(c.xyz),cos(c.yzx)),1)*n,n*=.6,c*=1.5;f.xyz/=f.w;return f.xyz;}`,zm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/noiseSimplex.module.glsl
vec4 mod289(vec4 v){return v-floor(v*(1./289.))*289.;}vec3 mod289(vec3 v){return v-floor(v*(1./289.))*289.;}float mod289(float v){return v-floor(v*(1./289.))*289.;}vec4 permute(vec4 v){return mod289((v*34.+10.)*v);}float permute(float v){return mod289((v*34.+10.)*v);}vec4 taylorInvSqrt(vec4 v){return 1.79284291400159-.85373472095314*v;}float taylorInvSqrt(float v){return 1.79284291400159-.85373472095314*v;}vec4 grad4(float v,vec4 z){vec4 y,d;y.xyz=floor(fract(vec3(v)*z.xyz)*7.)*z.z-1.;y.w=1.5-dot(abs(y.xyz),vec3(1));d=vec4(lessThan(y,vec4(0)));y.xyz=y.xyz+(d.xyz*2.-1.)*d.www;return y;}
#define F4 0.309016994374947451
float noiseSimplex(vec4 v){const vec4 d=vec4(.138196601125011,.276393202250021,.414589803375032,-.447213595499958);vec4 y=floor(v+dot(v,vec4(F4))),z=v-y+dot(y,d.xxxx);vec3 w=step(z.yzw,z.xxx),f=step(z.zww,z.yyz);v.x=w.x+w.y+w.z;v.yzw=1.-w;v.y+=f.x+f.y;v.zw+=1.-f.xy;v.z+=f.z;v.w+=1.-f.z;vec4 p=clamp(v,0.,1.),x=clamp(v-1.,0.,1.),a=clamp(v-2.,0.,1.),F=z-a+d.xxxx,l=z-x+d.yyyy,I=z-p+d.zzzz;v=z+d.wwww;y=mod289(y);float m=permute(permute(permute(permute(y.w)+y.z)+y.y)+y.x);p=permute(permute(permute(permute(y.w+vec4(a.w,x.w,p.w,1))+y.z+vec4(a.z,x.z,p.z,1))+y.y+vec4(a.y,x.y,p.y,1))+y.x+vec4(a.x,x.x,p.x,1));x=vec4(1./294.,1./49.,1./7.,0);a=grad4(m,x);y=grad4(p.x,x);vec4 r=grad4(p.y,x),c=grad4(p.z,x);x=grad4(p.w,x);p=taylorInvSqrt(vec4(dot(a,a),dot(y,y),dot(r,r),dot(c,c)));a*=p.x;y*=p.y;r*=p.z;c*=p.w;x*=taylorInvSqrt(dot(x,x));w=max(.6-vec3(dot(z,z),dot(F,F),dot(l,l)),0.);vec2 g=max(.6-vec2(dot(I,I),dot(v,v)),0.);w*=w;g*=g;return 49.*(dot(w*w,vec3(dot(a,z),dot(y,F),dot(r,l)))+dot(g*g,vec2(dot(c,I),dot(x,v))));}float noiseSimplex(vec3 v){const vec2 d=vec2(1./6.,1./3.);const vec4 D=vec4(0,.5,1,2);vec3 y=floor(v+dot(v,d.yyy)),z=v-y+dot(y,d.xxx),x=step(z.yzx,z.xyz),p=1.-x,w=min(x.xyz,p.zxy),a=max(x.xyz,p.zxy);v=z-w+d.xxx;p=z-a+d.yyy;x=z-D.yyy;y=mod289(y);vec4 f=permute(permute(permute(y.z+vec4(0,w.z,a.z,1))+y.y+vec4(0,w.y,a.y,1))+y.x+vec4(0,w.x,a.x,1));y=.142857142857*D.wyz-D.xzx;f-=49.*floor(f*y.z*y.z);vec4 g=floor(f*y.z),r=g*y.x+y.yyyy,c=floor(f-7.*g)*y.x+y.yyyy,F=1.-abs(r)-abs(c),m=vec4(r.xy,c);c=vec4(r.zw,c.zw);r=-step(F,vec4(0));g=m.xzyw+(floor(m)*2.+1.).xzyw*r.xxyy;f=c.xzyw+(floor(c)*2.+1.).xzyw*r.zzww;y=vec3(g.xy,F.x);w=vec3(g.zw,F.y);a=vec3(f.xy,F.z);vec3 l=vec3(f.zw,F.w);g=taylorInvSqrt(vec4(dot(y,y),dot(w,w),dot(a,a),dot(l,l)));y*=g.x;w*=g.y;a*=g.z;l*=g.w;g=max(.5-vec4(dot(z,z),dot(v,v),dot(p,p),dot(x,x)),0.);g*=g;return 105.*dot(g*g,vec4(dot(y,z),dot(w,v),dot(a,p),dot(l,x)));}`,Pm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/noiseValue.module.glsl
float hashv(float f){f=fract(f*.011);f*=f+7.5;f*=f+f;return fract(f);}float hashv(vec2 f){vec3 v=fract(vec3(f.xyx)*.13);v+=dot(v,v.yzx+3.333);return fract((v.x+v.y)*v.z);}
#define NUM_NOISE_OCTAVES 5
float noiseValue(vec3 f){const vec3 v=vec3(110,241,171);vec3 h=fract(f);float m=dot(floor(f),v);h=h*h*(3.-2.*h);return mix(mix(mix(hashv(m+dot(v,vec3(0))),hashv(m+dot(v,vec3(1,0,0))),h.x),mix(hashv(m+dot(v,vec3(0,1,0))),hashv(m+dot(v,vec3(1,1,0))),h.x),h.y),mix(mix(hashv(m+dot(v,vec3(0,0,1))),hashv(m+dot(v,vec3(1,0,1))),h.x),mix(hashv(m+dot(v,vec3(0,1,1))),hashv(m+dot(v,vec3(1))),h.x),h.y),h.z);}float fbm(vec3 f){float m=0.,h=.5;vec3 d=vec3(100);for(int v=0;v<NUM_NOISE_OCTAVES;++v){m+=h*noiseValue(f);f=f*2.+d;h*=.5;if(v==-1)break;}return m;}float fbm(float f){return fbm(vec3(f));}`,km=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/pmrem.module.glsl
float getPmremFace(vec3 v){vec3 g=abs(v);return g.x>g.z?g.x>g.y?v.x>0.?0.:3.:v.y>0.?1.:4.:g.z>g.y?v.z>0.?2.:5.:v.y>0.?1.:4.;}vec2 getPmremUV(vec3 v,float g){return.5*((g==0.?vec2(v.zy)/abs(v.x):g==1.?vec2(-v.x,-v.z)/abs(v.y):g==2.?vec2(-v.x,v.y)/abs(v.z):g==3.?vec2(-v.z,v.y)/abs(v.x):g==4.?vec2(-v.x,v.z)/abs(v.y):vec2(v)/abs(v.z))+1.);}vec3 getPmremDir(vec2 v,float g){vec3 y=vec3(0);if(g==0.)y=vec3(1,(vec2(v.yx)-.5)*2.);else if(g==1.){vec2 g=(vec2(-v.x,-v.y)+.5)*2.;y=vec3(g.x,1,g.y);}else if(g==2.)y=vec3(vec2(-v.x+.5,v.y-.5)*2.,1);else if(g==3.)y=vec3(-1,(vec2(-v.x+.5,v.y-.5)*2.).yx);else if(g==4.){vec2 g=vec2(-v.x+.5,v.y-.5)*2.;y=vec3(g.x,-1,g.y);}else if(g==5.)y=vec3((vec2(v)-.5)*2.,-1);return normalize(y);}
#define MAXMIP 5.0
float roughnessToMip(float g){return g*(MAXMIP-1.);}vec3 getPmremMip(sampler2D v,vec3 g,float y){float f=getPmremFace(g);vec2 i=getPmremUV(g,f),a=vec2(textureSize(v,0))*pow(.5,floor(y));i=(i*(a-4.)+2.)/a;i.x+=mod(f,3.);i.y+=floor(f/3.);i.y*=.5;i.y*=.5;i.x/=3.;f=1.-pow(2.,-floor(y));i.y*=1.-f;i.x*=1.-f;i.y+=f;vec4 n=textureGrad(v,i,vec2(0),vec2(0));return n.xyz/n.w;}vec3 getPmrem(sampler2D v,vec3 g,float y){y=roughnessToMip(y);float f=fract(y);y=floor(y);vec3 i=getPmremMip(v,g,y);if(f==0.)return i;{vec3 x=getPmremMip(v,g,y+1.);return mix(i,x,f);}}`,Mm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/random.module.glsl
float random(vec2 f){return fract(sin(dot(f.xy,vec2(12.9898,78.233)))*43758.5453);}vec3 hash(vec3 f){f=fract(f*vec3(.1031,.103,.0973));f+=dot(f,f.yxz+33.33);return fract((f.xxy+f.yxx)*f.zyx);}`,Rm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/raymarch_normal.module.glsl
vec3 N(vec3 v,float z){return normalize(vec3(D(vec3(v.x+z,v.yz)).d-D(vec3(v.x-z,v.yz)).d,D(vec3(v.x,v.y+z,v.z)).d-D(vec3(v.x,v.y-z,v.z)).d,D(vec3(v.xy,v.z+z)).d-D(vec3(v.xy,v.z-z)).d));}`,Dm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/rotate.module.glsl
mat2 rotate(float c){return mat2(cos(c),sin(c),-sin(c),cos(c));}void rotate(inout vec2 m,inout vec2 r,float c){mat2 n=rotate(c);m*=n;r*=n;}mat3 makeRotationDir(vec3 c,vec3 m){m=normalize(cross(m,c));vec3 r=normalize(cross(c,m));return mat3(m.x,r.x,c.x,m.y,r.y,c.y,m.z,r.z,c.z);}`,Fm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/sdf.module.glsl
float sdSphere(vec3 v,float s){return length(v)-s;}float sdBox(vec3 v,vec3 s){v=abs(v)-s;return length(max(v,0.))+min(max(v.x,max(v.y,v.z)),0.);}float sdPlane(vec3 v,vec3 f,float s){return dot(v,f)+s;}float sdCappedCylinder(vec3 v,float s,float f){vec2 m=abs(vec2(length(v.xz),v.y))-vec2(s,f);return min(max(m.x,m.y),0.)+length(max(m,0.));}float sdVerticalCapsule(vec3 v,float f,float s){v.y-=clamp(v.y,0.,f);return length(v)-s;}float sdRoundedCylinder(vec3 v,float s,float m,float o){vec2 f=vec2(length(v.xz)-2.*s+m,abs(v.y)-o);return min(max(f.x,f.y),0.)+length(max(f,0.))-m;}float sdVesicaSegment(vec3 v,vec3 s,vec3 m,float o){vec3 y=(s+m)*.5;float f=length(m-s);vec3 r=(m-s)/f;float d=dot(v-y,r);vec2 l=vec2(length(v-y-d*r),abs(d));d=.5*f;f=.5*(d*d-o*o)/o;r=d*l.x<f*(l.y-d)?vec3(0,d,0):vec3(-f,0,f+o);return length(l-r.xy)-r.z;}float sdTriPrism(vec3 v,vec2 s){vec3 m=abs(v);return max(m.z-s.y,max(m.x*.866025+v.y*.5,-v.y)-s.x*.5);}float dot2(vec3 v){return dot(v,v);}float udTriangle(vec3 v,vec3 f,vec3 s,vec3 o){vec3 m=s-f,y=v-f,d=o-s,r=v-s;s=f-o;f=v-o;v=cross(m,s);return sqrt(sign(dot(cross(m,v),y))+sign(dot(cross(d,v),r))+sign(dot(cross(s,v),f))<2.?min(min(dot2(m*clamp(dot(m,y)/dot2(m),0.,1.)-y),dot2(d*clamp(dot(d,r)/dot2(d),0.,1.)-r)),dot2(s*clamp(dot(s,f)/dot2(s),0.,1.)-f)):dot(v,y)*dot(v,y)/dot2(v));}float sdRing(vec2 v,vec2 f,float s,float o){v.x=abs(v.x);v=mat2(f.x,f.y,-f.y,f.x)*v;return max(abs(length(v)-s)-o*.5,length(vec2(v.x,max(0.,abs(s-v.y)-o*.5)))*sign(v.x));}float sdBox(vec2 v,vec2 s){vec2 f=abs(v)-s;return length(max(f,0.))+min(max(f.x,f.y),0.);}float sdRoundBox(vec3 v,vec3 s,float o){v=abs(v)-s+o;return length(max(v,0.))+min(max(v.x,max(v.y,v.z)),0.)-o;}float sdSegment(vec2 v,vec2 s,vec2 o){vec2 m=v-s,f=o-s;return length(m-f*clamp(dot(m,f)/dot(f,f),0.,1.));}float opAdd(float s,float o){return s<o?s:o;}vec2 opAdd(vec2 v,vec2 s){return v.x<s.x?v:s;}float opSub(float s,float v){v*=-1.;return s<v?v:s;}vec2 opSub(vec2 s,vec2 v){v*=-1.;return s.x<v.x?v:s;}vec2 opAnd(vec2 s,vec2 v){return s.x<v.x?v:s;}float opAnd(float s,float v){return s<v?v:s;}float opSmoothAdd(float v,float s,float o){float f=clamp(.5+.5*(s-v)/o,0.,1.);return mix(s,v,f)-o*f*(1.-f);}float opSmoothSub(float s,float v,float o){float f=clamp(.5-.5*(v+s)/o,0.,1.);return mix(v,-s,f)+o*f*(1.-f);}float opRound(float s,float v){return s-v;}vec2 pmod(vec2 v,float s){s=mod(atan(v.y,v.x),TPI/s)-.5*TPI/s;return length(v)*vec2(sin(s),cos(s));}`,Nm=`// @shader-file: packages/maxpower/Utils/ShaderParser/shaderModules/subsurface.module.glsl
float subsurface(vec3 i,vec3 s,float c){float f=0.;for(int r=0;r<8;r++){float N=c*float(r)/float(8);f+=clamp(D(i+s*N).d/N,0.,1.);}f/=float(8);return f*f*(3.-2.*f);}`,Im="in vec2 vUv;\rin vec3 vNormal;\rin vec3 vViewNormal;\rin vec3 vPos;\rin vec3 vMVPosition;\rin vec3 vMVPPosition;\rin vec2 vVelocity;\r\runiform mat4 uModelMatrix;\runiform mat4 uModelMatrixInverse;\runiform mat4 uViewMatrix;\runiform mat4 uViewMatrixInverse;\runiform mat4 uProjectionMatrix;\runiform mat4 uProjectionMatrixInverse;\runiform vec3 uCameraPosition;\runiform vec2 uResolution;\r\r#ifdef IS_DEPTH\r	uniform float uCameraNear;\r	uniform float uCameraFar;\r#endif\r\r#ifdef IS_DEFERRED\r	layout (location = 0) out vec4 outColor0;\r	layout (location = 1) out vec4 outColor1;\r	layout (location = 2) out vec4 outColor2;\r	layout (location = 3) out vec4 outColor3;\r	layout (location = 4) out vec4 outColor4;\r#endif\r\r#ifdef IS_FORWARD\r	uniform sampler2D uDeferredTexture;\r	uniform vec2 uDeferredResolution;\r#endif\r\r#if defined(IS_FORWARD) || defined(IS_DEPTH)\r	layout (location = 0) out vec4 outColor0;\r	layout (location = 1) out vec4 outColor1;\r	layout (location = 2) out vec4 outColor2;\r#endif",Bm="vec4 outColor = vec4(1.0);\rvec3 outNormal = normalize(vNormal);\rvec3 outNormalMap = vec3( 0.0 );\rfloat outSSN = 0.0;\rvec3 outEmission = vec3(0.0);\rfloat outRoughness = 0.5;\rfloat outMetalic = 0.0;\rvec3 outPos = vPos;\rfloat outEnv = 1.0;\rfloat outGradient = 0.0;",Am="#if defined(IS_DEPTH) || defined(IS_DEFERRED)\r	vec4 mv = uViewMatrix * vec4(outPos, 1.0);\r#endif\r\r#ifdef IS_DEPTH\r	float depth_z = (-mv.z - uCameraNear) / (uCameraFar - uCameraNear);\r	outColor0 = vec4(floatToRGBA( depth_z ));\r#endif\r\r#ifdef IS_DEFERRED\r\r	#ifdef USE_NORMAL_MAP \r\r		vec3 tangent;\r		vec3 bitangent;\r\r		#ifdef USE_TANGENT\r\r			tangent = normalize( vTangent );\r			bitangent = normalize( vBitangent );\r\r		#else\r\r			tangent = cross(outNormal, vec3( 0.0, 1.0, 0.0 ));\r			bitangent = cross(tangent, outNormal);\r\r		#endif\r\r		#ifdef DOUBLE_SIDED\r\r			tangent *= faceDirection;\r			bitangent *= faceDirection;\r			\r		#endif\r\r		mat3 vTBN = mat3( tangent, bitangent, outNormal );\r		outNormal = normalize( vTBN * outNormalMap );\r\r	#endif\r\r	vec4 mvp = uProjectionMatrix * mv;\r	gl_FragDepth = ( mvp.z / mvp.w ) * 0.5 + 0.5;\r	outColor0 = vec4( outPos, outEmission.x );\r	outColor1 = vec4( normalize( outNormal * ( gl_FrontFacing ? 1.0 : -1.0 ) ), outEmission.y );\r	outColor2 = vec4( outColor.xyz, outGradient );\r	outColor3 = vec4( outRoughness, outMetalic, outSSN, outEnv );\r	outColor4 = vec4( vVelocity, 0.0, outEmission.z );\r#endif\r\r#ifdef IS_FORWARD\r	outColor0 = outColor;\r	outColor1 = vec4(outPos, 1.0);\r	outColor2 = vec4(vVelocity, 0.0, 1.0);\r#endif",bm="vec3 refDir = reflect( -geo.viewDir, geo.normal );\rfloat dNV = clamp( dot( geo.normal, geo.viewDir ), 0.0, 1.0 );\rfloat EF = mix( fresnel( dNV ), 1.0, mat.metalic );\routColor.xyz += getPmrem( uEnvMap, geo.normal, 1.0) * mat.diffuseColor * mat.envMapIntensity;\routColor.xyz = mix( outColor.xyz, getPmrem( uEnvMap, refDir, mat.roughness ), EF * mat.specularColor * mat.envMapIntensity );",Lm="Geometry geo = Geometry(\r	outPos,\r	outNormal,\r	0.0,\r	normalize( uCameraPosition - outPos ),\r	vec3( 0.0 ),\r	0.0\r);\r\rMaterial mat = Material(\r	vec3( 1.0 ),\r	outRoughness,\r	outMetalic,\r	outEmission,\r	mix( outColor.xyz, vec3( 0.0, 0.0, 0.0 ), outMetalic ),\r	mix( vec3( 1.0, 1.0, 1.0 ), outColor.xyz, outMetalic ),\r	outEnv,\r	outGradient\r);\r\routColor.xyz *= 0.0;",Um="// required common, light,\r\rfloat shadow;\r\r// direcitonalLight\r\rLight light;\rLightCamera lightCamera;\r\r#if NUM_LIGHT_DIR > 0\r\r	DirectionalLight dLight;\r\r	#pragma loop_start NUM_LIGHT_DIR\r\r		dLight = uDirectionalLight[ LOOP_INDEX ];\r		light.direction = dLight.direction;\r		light.color = dLight.color;\r\r		// shadow\r\r		#if LOOP_INDEX < NUM_SHADOWMAP_DIR\r\r			shadow = getShadowSmooth( geo.position, uDirectionalLightCamera[ LOOP_INDEX ], uDirectionalLightShadowMap[ LOOP_INDEX ], 0.0001 );\r\r		#else\r\r			shadow = 1.0;\r\r		#endif\r		\r		// lighting\r\r		outColor.xyz += RE( geo, mat, light );// * shadow;\r\r	#pragma loop_end\r\r#endif\r\r#if NUM_LIGHT_SPOT > 0\r\r	SpotLight sLight;\r	\r	vec3 spotDirection;\r	float spotDistance;\r	float spotAngleCos;\r	float spotAttenuation;\r	vec3 radiance;\r\r	#pragma loop_start NUM_LIGHT_SPOT\r\r		// shadow\r\r		#if LOOP_INDEX < NUM_SHADOWMAP_SPOT\r\r			shadow = getShadowSmooth( geo.position, uSpotLightCamera[ LOOP_INDEX ], uSpotLightShadowMap[ LOOP_INDEX ], 0.01 );\r\r		#else\r\r			shadow = 1.0;\r\r		#endif\r\r		// lighting\r\r		sLight = uSpotLight[ LOOP_INDEX ];\r\r		spotDirection = normalize(sLight.position - geo.position);\r		spotDistance = length( sLight.position - geo.position );\r		spotAngleCos = dot( sLight.direction, spotDirection );\r		spotAttenuation = 0.0;\r\r		if( spotAngleCos > sLight.angle ) {\r\r			spotAttenuation = smoothstep( sLight.angle, sLight.angle + ( 1.0 - sLight.angle ) * sLight.blend, spotAngleCos );\r\r		}\r\r		light.direction = spotDirection;\r		light.color = sLight.color * spotAttenuation * pow( clamp( 1.0 - spotDistance / sLight.distance, 0.0, 1.0 ),  sLight.decay );\r\r		radiance = RE( geo, mat, light );\r		outColor.xyz += shadow * radiance;\r\r	#pragma loop_end\r\r#endif",jm="struct SDFResult {\r	float d;\r	vec3 pos;\r	float mat;\r	vec4 matparam;\r};",Om="SDFResult dist;bool hit = false;for( int i = 0; i < ARG1; i++ ) {	dist = D( rayPos );	rayPos += dist.d * rayDir * ARG3;	if( dist.d < ARG2 ) {		hit = true;		break;	}}",Vm="vec4 worldNormal = normalize(uModelMatrix * vec4( outNormal, 0.0 ));\rvec4 viewNormal = normalize(uViewMatrix * worldNormal);\routNormal = worldNormal.xyz;\r\rvec4 modelPosition = uModelMatrix * vec4( rayPos, 1.0 );\rvec4 mvpPosition = uProjectionMatrix * uViewMatrix * modelPosition;\routPos = modelPosition.xyz;\rgl_FragDepth =  ( mvpPosition.z / mvpPosition.w ) * 0.5 + 0.5;",Gm="vec3 rayPos = ( uModelMatrixInverse * vec4( vPos, 1.0 ) ).xyz;\rvec3 rayDir = normalize( ( uModelMatrixInverse * vec4( normalize( vPos - uCameraPosition ), 0.0 ) ).xyz );",Wm="vec3 rayPos = ( uModelMatrixInverse * vec4( uCameraPosition, 1.0 ) ).xyz;\rvec4 clipSpacePos = vec4((gl_FragCoord.xy / uResolution) * 2.0 - 1.0, -1.0, 1.0);\rvec4 viewSpacePos = uProjectionMatrixInverse * clipSpacePos;\rviewSpacePos /= viewSpacePos.w;\rvec3 viewDir = normalize(viewSpacePos.xyz);\rvec3 rayDir = normalize((uModelMatrixInverse* uViewMatrixInverse * vec4(viewDir, 0.0)).xyz);",Hm="uniform float uTime;\runiform float uTimeF;\runiform float uTimeE;\runiform float uTimeEF;",$m="uniform mat4 uModelMatrix;\runiform mat4 uViewMatrix;\runiform mat4 uProjectionMatrix;\runiform mat4 uNormalMatrix;\r\runiform mat4 uModelMatrixPrev;\runiform mat4 uModelViewMatrix;\runiform mat4 uViewMatrixPrev;\runiform mat4 uProjectionMatrixPrev;\r\rout vec2 vUv;\rout vec3 vViewNormal;\rout vec3 vNormal;\rout vec3 vMVPosition;\rout vec3 vMVPPosition;\rout vec3 vPos;\r\rout vec2 vVelocity;\r\rlayout ( location = 0 ) in vec3 position;\rlayout ( location = 1 ) in vec2 uv;\rlayout ( location = 2 ) in vec3 normal;\r\r#ifdef TF_MODELER\r	out vec3 o_position;\r	out vec3 o_normal;\r#endif",Xm="vec3 outPos = position;\rvec3 outNormal = normal;\rvec2 outUv = uv;",Km="#ifdef TF_MODELER\r		o_position = outPos;\r		o_normal = outNormal;\r		return;\r#endif\r\rvec4 modelPosition = uModelMatrix * vec4(outPos, 1.0);\rvec4 mvPosition = uViewMatrix * modelPosition;\rgl_Position = uProjectionMatrix * mvPosition;\r\rvec4 modelPositionPrev = uModelMatrixPrev * vec4(outPos, 1.0);\rvec4 mvPositionPrev = uViewMatrixPrev * modelPositionPrev;\rvec4 positionPrev = uProjectionMatrixPrev * mvPositionPrev;\r\rvUv = outUv;\rvViewNormal = normalize( (uNormalMatrix * vec4(outNormal, 0.0)).xyz );\rvNormal = (uModelMatrix * vec4(outNormal, 0.0)).xyz;\rvPos = modelPosition.xyz;\rvMVPosition = mvPosition.xyz;\rvMVPPosition = gl_Position.xyz / gl_Position.w;\r\rvVelocity = vMVPPosition.xy - positionPrev.xy / positionPrev.w;\rvVelocity *= 0.2;",Ym=(e,t)=>{if(!t)return e;const n=Object.keys(t);let i="";for(let r=0;r<n.length;r++)i+="#define "+n[r]+" "+t[n[r]]+`
`;return i=i+e,i},Qm=e=>{const t=new Map([["common",wm],["hash",Sm],["sdf",Fm],["rotate",Dm],["matrix",Em],["random",Mm],["noise_simplex",zm],["noise_cyclic",Tm],["noise_value",Pm],["light",Cm],["lighting_light",Um],["lighting_env",bm],["lighting_forwardIn",Lm],["vert_h",$m],["vert_in",Xm],["vert_out",Km],["frag_h",Im],["frag_in",Bm],["frag_out",Am],["rm_h",jm],["rm_normal",Rm],["rm_ray_obj",Gm],["rm_ray_screen",Wm],["rm_out_obj",Vm],["rm_loop",Om],["uni_time",Hm],["pmrem",km],["subsurface",Nm]]);return e=e.replace(/#include\s?<([\S]*)>/g,(n,i)=>{let r="";const s=i.split(","),o=s[0],a=s.slice(1);let l=t.get(o)||"";l=l.replace(/#define GLSLIFY .*\n/g,"");for(let u=0;u<a.length;u++)a[u]&&(l=l.replace(new RegExp("ARG"+(u+1),"g"),a[u]));return r+=l,r}),e},Zm=(e,t)=>(e=e.replaceAll("NUM_LIGHT_DIR",t?t.directional.length.toString():"0"),e=e.replaceAll("NUM_SHADOWMAP_DIR",t?Math.min(2,t.directional.filter(n=>n.component.castShadow).length).toString():"0"),e=e.replaceAll("NUM_LIGHT_SPOT",t?t.spot.length.toString():"0"),e=e.replaceAll("NUM_SHADOWMAP_SPOT",t?Math.min(2,t.spot.filter(n=>n.component.castShadow).length).toString():"0"),e),qm=e=>(e=e.replace(/#pragma\sloop_start\s(\d+)*([\s\S]+?)#pragma\sloop_end/g,(t,n,i)=>{let r="";for(let s=0;s<Number(n);s++)r+=i.replaceAll("LOOP_INDEX",s.toString());return r}),e),Hr=(e,t,n)=>(e=Ym(e,t),e=`#version 300 es
precision highp float;
`+e,e=Qm(e),e=Zm(e,n),e=qm(e),e=e.replace(/#define GLSLIFY .*\n/g,""),e),Jm=`// @shader-file: packages/maxpower/Component/Renderer/DeferredRenderer/shaders/deferredShading.fs
#include<common>
#include<packing>
#include<light>
#include<pmrem>
#include<random>
uniform sampler2D sampler0,sampler1,sampler2,sampler3,sampler4,uSSAOTexture,uEnvMap,uNoiseSimpleTex;uniform vec3 uColor;uniform mat4 uViewMatrix,uCameraMatrix;uniform vec3 uCameraPosition;in vec2 vUv;layout(location=0)out vec4 glFragOut0;layout(location=1)out vec4 glFragOut1;void main(){float occlusion=texture(uSSAOTexture,vUv).x;
vec4 tex0=texture(sampler0,vUv);
vec4 tex1=texture(sampler1,vUv);
vec4 tex2=texture(sampler2,vUv);
vec4 tex3=texture(sampler3,vUv);
vec4 tex4=texture(sampler4,vUv);
vec3 normal=tex1.xyz;
vec3 color=tex2.xyz;
float gradient=tex2.w;
float roughness=tex3.x;
float metalic=tex3.y;
vec3 emission=vec3(tex0.w,tex1.w,tex4.w);
float envMapIntensity=tex3.w;
Geometry geo=Geometry(
tex0.xyz,
normal,
0.0,
normalize(uCameraPosition-tex0.xyz),
vec3(0.0),
occlusion
);
Material mat=Material(
color,
roughness,
metalic,
emission,
mix(color,vec3(0.0,0.0,0.0),metalic),
mix(vec3(1.0,1.0,1.0),color,metalic),
envMapIntensity,
gradient
);
vec3 outColor=vec3(0.0);

#include<lighting_light>

#include<lighting_env>
outColor.xyz*=max(0.,1.-geo.occulusion*1.5);outColor.xyz+=mat.emission;float t=random(vUv);vec3 r=texture(uNoiseSimpleTex,vUv*.3*vec2(1,.5)).xyz,v=rgb2hsv(outColor.xyz);v.x+=r.x*gradient*t*.11;v.z-=r.y*gradient*t*.25;outColor.xyz=hsv2rgb(v);glFragOut0=glFragOut1=vec4(max(vec3(0),outColor.xyz),1);}`,ep=`// @shader-file: packages/maxpower/Component/Renderer/DeferredRenderer/shaders/ssao.fs
#include<common>
#include<packing>
#include<light>
#include<random>
uniform sampler2D uSSAOBackBuffer,uDepthTexture,sampler0,sampler1;uniform float uTimeEF;uniform mat4 uCameraMatrix,uViewMatrix,uProjectionMatrix,uProjectionMatrixInverse;uniform vec3 uCameraPosition;
#define SAMPLE 16
uniform vec3 uSSAOKernel[16];in vec2 vUv;layout(location=0)out vec4 outColor;void main(){vec3 v=texture(sampler0,vUv).xyz;if(v.x+v.y+v.z==0.||length(v-uCameraPosition)>1e2)return;vec3 u=texture(sampler1,vUv).xyz;float s=0.;vec2 m=vUv+uTimeEF;vec3 i=vec3(random(vec2(m)),random(vec2(m+.25)),random(vec2(m+.5)))*2.-1.;i=normalize(i-u*dot(i,u));mat3 x=mat3(i,cross(i,u),u);for(int u=0;u<SAMPLE;u++){vec3 m=x*uSSAOKernel[u],i=v+m*.5;vec4 f=uProjectionMatrix*uViewMatrix*vec4(i,1);f.xy/=f.w;f.xy=f.xy*.5+.5;f=uViewMatrix*vec4(texture(sampler0,f.xy).xyz,1);vec4 S=uViewMatrix*vec4(i,1);if(S.z<f.z&&S.z>=f.z-.2)s+=1.-pow(length(m),2.);}s/=float(SAMPLE);outColor=vec4(mix(texture(uSSAOBackBuffer,vUv).xyz,vec3(s),.5),1);}`,xl=`// @shader-file: packages/maxpower/Component/Renderer/DeferredRenderer/shaders/ssaoBlur.fs
#include<common>
#include<packing>
#include<light>
#include<random>
uniform sampler2D uSSAOTexture;uniform vec2 uPPPixelSize;uniform sampler2D uNormalTexture,uDepthTexture;uniform float uWeights[SSAOSAMPLE];in vec2 vUv;layout(location=0)out vec4 outColor;float v(vec2 v,vec3 u,float s){return pow((dot(u,texture(uNormalTexture,v).xyz)+1.)/2.,32.)*pow(1./(abs(s-texture(uDepthTexture,v).w)+.001),.25);}void main(){float u=0.;vec3 e=texture(uNormalTexture,vUv).xyz;float s=texture(uDepthTexture,vUv).w;vec2 x;
#ifdef IS_VIRT
x=vec2(0,1);
#else
x=vec2(1,0);
#endif
float f=0.;u+=texture(uSSAOTexture,vUv).x*uWeights[0];f+=uWeights[0];for(int i=1;i<SSAOSAMPLE;i++){vec2 t=float(i)*x*uPPPixelSize,a=vUv+t;t=vUv-t;float p=v(a,e,s)*uWeights[i],r=v(t,e,s)*uWeights[i];u=u+texture(uSSAOTexture,a).x*p+texture(uSSAOTexture,t).x*r;f+=p+r;}u/=f;outColor=vec4(vec3(u),1);}`,tp=e=>{const t=[];for(let n=0;n<e;n++){const i=new M;i.x=Math.random()*2-1,i.y=Math.random()*2-1,i.z=n/e*.95+.05,i.normalize(),i.multiply(n/e*.95+.05),t.push(...i.getElm("vec3"))}return t};class np extends De{constructor(n){super();c(this,"timeUniforms_");c(this,"postprocess");c(this,"ssao");c(this,"rtSSAO1");c(this,"rtSSAO2");c(this,"ssaoBlur");c(this,"ssaoBlurUni");c(this,"shading");const i=n.gl,r={uTimeEF:{value:0,type:"1f"}},s=new Z(i).setTexture([new W(i).setting({magFilter:i.LINEAR,minFilter:i.LINEAR})]),o=new Z(i).setTexture([new W(i).setting({magFilter:i.LINEAR,minFilter:i.LINEAR})]),a=new Q(i,{name:"ssao",frag:ep,renderTarget:s,uniforms:A.merge(r,{uSSAOBackBuffer:{value:o.textures[0],type:"1i"},uSSAOKernel:{value:tp(16),type:"3fv"}}),resolutionRatio:.5,passThrough:!0}),l=8,u=A.merge(r,{uSSAOTexture:{value:o.textures[0],type:"1i"},uDepthTexture:{value:null,type:"1i"},uNormalTexture:{value:null,type:"1i"},uWeights:{type:"1fv",value:ct.gaussWeights(l)}}),d=new Q(i,{name:"ssaoBlur/h",frag:xl,uniforms:u,resolutionRatio:1,passThrough:!0,defines:{SSAOSAMPLE:l}}),h=new Q(i,{name:"ssaoBlur/v",frag:xl,uniforms:A.merge(u,{uSSAOTexture:{value:d.renderTarget.textures[0],type:"1i"}}),defines:{SSAOSAMPLE:l,IS_VIRT:""},resolutionRatio:1,passThrough:!0}),f=new Q(i,{name:"deferredShading",frag:Jm,uniforms:A.merge({uSSAOTexture:{value:h.renderTarget.textures[0],type:"1i"},uSSAOResolutionInv:{value:a.resolutionInv,type:"2fv"},uEnvMap:{value:n.envMap,type:"1i"}})});this.postprocess=new et({passes:[a,d,h,f]}),this.timeUniforms_=r,this.shading=f,this.ssao=a,this.rtSSAO1=s,this.rtSSAO2=o,this.ssaoBlur=d,this.ssaoBlurUni=u}update(n){this.timeUniforms_.uTimeEF.value=(this.timeUniforms_.uTimeEF.value+n.timeDelta)%1;let i=this.rtSSAO1;this.rtSSAO1=this.rtSSAO2,this.rtSSAO2=i,this.ssao.setRendertarget(this.rtSSAO1),this.ssaoBlur.uniforms.uSSAOTexture.value=this.rtSSAO1.textures[0],this.ssao.uniforms.uSSAOBackBuffer.value=this.rtSSAO2.textures[0]}setRenderCamera(n){const i=n.renderTarget;if(i){for(let r=0;r<i.gBuffer.textures.length;r++){const s=i.gBuffer.textures[r];this.shading.uniforms["sampler"+r]=this.ssao.uniforms["sampler"+r]={type:"1i",value:s}}this.ssaoBlur.uniforms.uDepthTexture.value=i.gBuffer.textures[0],this.shading.renderTarget=i.shadingBuffer,this.ssaoBlurUni.uNormalTexture.value=i.gBuffer.textures[1]}}resize(n){this.postprocess.resize(n)}}const ip=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/colorCollection.fs
#include<common>
uniform sampler2D uBackBuffer0,uBloomTexture[4];uniform vec3 uCameraPosition;uniform float uCameraNear,uCameraFar;in vec2 vUv;layout(location=0)out vec4 outColor;const mat3 v=mat3(.59719,.076,.0284,.35458,.90834,.13383,.04823,.01566,.83777),u=mat3(1.60475,-.10208,-.00327,-.53108,1.10813,-.07276,-.07367,-.00605,1.07602);vec3 m(vec3 v){return(v*(v+.0245786f)-90537e-9f)/(v*(.983729f*v+.432951f)+.238081f);}void main(){outColor=vec4(clamp(u*m(v*texture(uBackBuffer0,vUv).xyz),0.,1.)*1.3,1);}`,rp=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/dofBokeh.fs
#include<common>
uniform sampler2D uCocTex;uniform vec4 uParams;in vec2 vUv;layout(location=0)out vec4 outColor;
#define BOKEH_SAMPLE 43
vec2 v[BOKEH_SAMPLE]=vec2[](vec2(0),vec2(.36363637,0),vec2(.22672357,.28430238),vec2(-.08091671,.35451925),vec2(-.32762504,.15777594),vec2(-.32762504,-.15777591),vec2(-.08091656,-.35451928),vec2(.22672352,-.2843024),vec2(.6818182,0),vec2(.614297,.29582983),vec2(.42510667,.5330669),vec2(.15171885,.6647236),vec2(-.15171883,.6647236),vec2(-.4251068,.53306687),vec2(-.614297,.29582986),vec2(-.6818182,0),vec2(-.614297,-.29582983),vec2(-.42510656,-.53306705),vec2(-.15171856,-.66472363),vec2(.1517192,-.6647235),vec2(.4251066,-.53306705),vec2(.614297,-.29582983),vec2(1,0),vec2(.9555728,.2947552),vec2(.82623875,.5633201),vec2(.6234898,.7818315),vec2(.36534098,.93087375),vec2(.07473,.9972038),vec2(-.22252095,.9749279),vec2(-.50000006,.8660254),vec2(-.73305196,.6801727),vec2(-.90096885,.43388382),vec2(-.98883086,.14904208),vec2(-.9888308,-.14904249),vec2(-.90096885,-.43388376),vec2(-.73305184,-.6801728),vec2(-.4999999,-.86602545),vec2(-.222521,-.9749279),vec2(.07473029,-.99720377),vec2(.36534148,-.9308736),vec2(.6234897,-.7818316),vec2(.8262388,-.56332),vec2(.9555729,-.29475483));void main(){float s=uParams.y;vec2 u=vec2(1)/vec2(textureSize(uCocTex,0));float w=u.x/u.y;vec4 m=texture(uCocTex,vUv),f=vec4(0),c=vec4(0);for(int B=0;B<BOKEH_SAMPLE;B++){vec2 E=v[B]*s;float n=length(E);vec4 i=texture(uCocTex,vUv+vec2(E.x*w,E.y));float z=u.y*2.;f+=vec4(i.xyz,1)*clamp((max(min(m.w,i.w),0.)-n+z)/z,0.,1.);c+=vec4(i.xyz,1)*(clamp((-i.w-n+z)/z,0.,1.)*step(u.y,-i.w));}f.xyz/=f.w+(f.w==0.?1.:0.);c.xyz/=c.w+(c.w==0.?1.:0.);f.w=smoothstep(u.y,u.y*2.,m.w);c.w*=PI/float(BOKEH_SAMPLE);vec3 z=mix(mix(vec3(0),f.xyz,clamp(f.w,0.,1.)),c.xyz,clamp(c.w,0.,1.));w=(1.-clamp(f.w,0.,1.))*(1.-clamp(c.w,0.,1.));outColor=vec4(z,w);}`,sp=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/dofCoc.fs
#include<common>
uniform sampler2D uBackBuffer0,uGbufferPos;uniform vec4 uParams;uniform mat4 uProjectionMatrixInverse,uViewMatrix;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){float v=uParams.y;vec2 s=vec2(1)/vec2(textureSize(uBackBuffer0,0));vec3 u=s.xyx*vec3(.5,.5,-.5);vec4 t=vec4((uViewMatrix*vec4(texture(uGbufferPos,vUv).xyz,1)).z*-1.),y=clamp((t-uParams.x)*uParams.w/t,-v,v);t=clamp(abs(y)*uParams.z,0.,1.);u=(texture(uBackBuffer0,vUv-u.xy).xyz*t.x+texture(uBackBuffer0,vUv-u.zy).xyz*t.y+texture(uBackBuffer0,vUv+u.zy).xyz*t.z+texture(uBackBuffer0,vUv+u.xy).xyz*t.w)/(dot(t,vec4(1))+1e-4);v=dot(y,vec4(.25));u*=smoothstep(0.,s.y*2.,abs(v));outColor=vec4(u,v);}`,op=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/dofComposite.fs
#include<common>
uniform sampler2D uBackBuffer0,uBokeTex;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){vec4 v=texture(uBackBuffer0,vUv),n=texture(uBokeTex,vUv);
#if defined(UNITY_COLORSPACE_GAMMA)
v.xyz=GammaToLinearSpace(v.xyz);
#endif
vec3 u=v.xyz*n.w+n.xyz;
#if defined(UNITY_COLORSPACE_GAMMA)
u=LinearToGammaSpace(u);
#endif
outColor=vec4(u,v.w);}`,ap=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/motionBlur.fs
in vec2 vUv;uniform sampler2D uBackBuffer0,uVelTex,uVelNeighborTex,uDepthTexture;uniform mat4 uProjectionMatrixInverse;uniform vec2 uPPPixelSize;uniform float uPower;layout(location=0)out vec4 outColor;
#define EPSILON 0.0001
#define SOFT_Z_EXTENT 0.1
#define SAMPLE 16
#include<random>
float h(vec2 u,vec2 x,vec2 v){return clamp(1.-length(u-x)/length(v),0.,1.);}float u(vec2 u,vec2 x,vec2 v){return 1.-smoothstep(.95*length(v),1.05*length(v),length(u-x));}float h(float u,float v){return clamp(1.-(u-v)/SOFT_Z_EXTENT,0.,1.);}float h(vec2 v){vec4 u=uProjectionMatrixInverse*vec4(v*2.-1.,texture(uDepthTexture,vUv).x*2.-1.,1);u.xyz/=u.w;return u.z;}vec2 h(sampler2D u,vec2 v){v=texture(u,v).xy;v=normalize(v)*clamp(length(v),.5*uPPPixelSize.y,float(TILE)*uPPPixelSize.y)*uPower;return v*0.;}void main(){vec2 v=vUv,f=h(uVelNeighborTex,v).xy;vec3 r=vec3(0);float e=0.;vec2 E=uPPPixelSize/2.;if(length(f)<=uPPPixelSize.y){outColor=texture(uBackBuffer0,vUv);return;}e=min(1./length(h(uVelTex,v)),3.);r=texture(uBackBuffer0,v).xyz*e;for(int y=0;y<SAMPLE;y++){if(y==SAMPLE)continue;float x=random(v+float(y)*.1);x=mix(-1.,1.,(float(y)+x+1.)/(float(SAMPLE)+1.));vec2 l=v+f*x+E;x=h(v);float S=h(l),t=h(x,S);S=h(S,x);x=t*h(l,v,h(uVelTex,l).xy)+S*h(v,l,h(uVelTex,v).xy)+u(l,v,h(uVelTex,l).xy)*u(v,l,h(uVelTex,v).xy)*2.;e+=x;r+=x*texture(uBackBuffer0,l).xyz;}r/=e;outColor=vec4(r.xyz,1);}`,lp=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/motionBlurNeighbor.fs
in vec2 vUv;uniform sampler2D uBackBuffer0,uVelTex;uniform vec2 uPPPixelSize;layout(location=0)out vec4 outColor;
#define NUM 3
void main(){vec2 v=vec2(0);for(int u=0;u<NUM;u++)for(int N=0;N<NUM;N++){vec2 M=texture(uVelTex,vUv+vec2((float(N)/float(NUM-1)-.5)*2.*uPPPixelSize.x,(float(u)/float(NUM-1)-.5)*2.*uPPPixelSize.y)).xy;if(length(M)>length(v))v=M;}outColor=vec4(v,0,1);}`,up=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/motionBlurTile.fs
in vec2 vUv;uniform sampler2D uBackBuffer0,uVelTex;uniform vec2 uPPPixelSize;layout(location=0)out vec4 outColor;void main(){vec2 v=vec2(0);for(int u=0;u<TILE;u++)for(int T=0;T<TILE;T++){vec2 E=texture(uVelTex,vUv+vec2((float(T)/float(TILE-1)-.5)*uPPPixelSize.x/float(TILE),(float(u)/float(TILE-1)-.5)*uPPPixelSize.y/float(TILE))).xy;if(length(E)>length(v))v=E;}outColor=vec4(v+1e-4,0,1);}`,cp=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/ssComposite.fs
#include<common>
#include<packing>
#include<light>
uniform sampler2D uBackBuffer0,uGbufferPos,uGbufferNormal,uSSRTexture;uniform vec3 uCameraPosition;uniform float uCameraNear,uCameraFar;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){outColor+=vec4(texture(uBackBuffer0,vUv).xyz,1);float v=fresnel(clamp(dot(normalize(uCameraPosition-texture(uGbufferPos,vUv).xyz),texture(uGbufferNormal,vUv).xyz),0.,1.));outColor.xyz+=v*texture(uSSRTexture,vUv).xyz*.15;}`,dp=`// @shader-file: packages/maxpower/Component/Renderer/PipelinePostProcess/shaders/ssr.fs
#include<common>
#include<packing>
#include<light>
#include<random>
uniform sampler2D uBackBuffer0,uGbufferPos,uGbufferNormal,uSSRBackBuffer,uDepthTexture;uniform float uTimeEF;uniform mat4 uCameraMatrix,uViewMatrix,uProjectionMatrix,uProjectionMatrixInverse;uniform vec3 uCameraPosition;in vec2 vUv;layout(location=0)out vec4 outColor;
#define MARCH 16.0
#define LENGTH 16.0
#define OBJDEPTH 0.5
void main(){vec3 u=texture(uGbufferPos,vUv).xyz;vec4 v=uViewMatrix*vec4(u,1),r=uViewMatrix*vec4(u,1);if(abs(v.z-r.z)>.1||length(u-uCameraPosition)>1e2){outColor=vec4(0);return;}if(u.x+u.y+u.z==0.)return;vec3 x=reflect(normalize((uCameraMatrix*uProjectionMatrixInverse*vec4(vUv*2.-1.,1,1)).xyz),texture(uGbufferNormal,vUv).xyz);float z=LENGTH/MARCH;vec3 n=x*z;float i=random(vUv+uTimeEF)*z+.1;u+=x*i;v=vec4(0);for(int e=0;e<int(MARCH);e++){vec4 r=uProjectionMatrix*uViewMatrix*vec4(u,1);r.xy/=r.w;if(abs(r.x)>1.||abs(r.y)>1.)break;r.xy=r.xy*.5+.5;vec3 x=texture(uGbufferPos,r.xy).xyz;if(length(x)==0.)break;vec4 m=uViewMatrix*vec4(x,1),a=uViewMatrix*vec4(u,1);if(a.z<m.z&&a.z>=m.z-OBJDEPTH){v.xyz=texture(uBackBuffer0,r.xy).xyz;v.w=1.;break;}u+=n;i+=z;}outColor=mix(texture(uSSRBackBuffer,vUv),v,.2);}`;class fp{constructor(t){c(this,"dofCoc");c(this,"dofBokeh");c(this,"dofComposite");c(this,"rtSSR1");c(this,"rtSSR2");c(this,"postprocess");c(this,"_timeUniforms");c(this,"_ssr");c(this,"_ssComposite");c(this,"_dofParams");c(this,"_motionBlur");c(this,"_motionBlurTile");c(this,"_renderCamera");const n={uTimeEF:{value:0,type:"1f"}},i=new Q(t,{name:"collection",frag:ip}),r=new Z(t).setTexture([new W(t).setting({magFilter:t.LINEAR,minFilter:t.LINEAR})]),s=new Z(t).setTexture([new W(t).setting({magFilter:t.LINEAR,minFilter:t.LINEAR})]),o=new Q(t,{name:"ssr",frag:dp,renderTarget:r,uniforms:A.merge(n,{uGbufferPos:{value:null,type:"1i"},uGbufferNormal:{value:null,type:"1i"},uSceneTex:{value:null,type:"1i"},uSSRBackBuffer:{value:s.textures[0],type:"1i"}}),resolutionRatio:.5,passThrough:!0}),a=new Q(t,{name:"ssComposite",frag:cp,uniforms:A.merge({uGbufferPos:{value:null,type:"1i"},uGbufferNormal:{value:null,type:"1i"},uSSRTexture:{value:s.textures[0],type:"1i"}})}),l=new M(10,.05,20,.05),u=new Q(t,{name:"dof/coc",frag:sp,uniforms:A.merge(n,{uGbufferPos:{value:null,type:"1i"},uParams:{value:l,type:"4f"}}),renderTarget:new Z(t).setTexture([new W(t).setting({magFilter:t.LINEAR,minFilter:t.LINEAR,internalFormat:t.RGBA16F,type:t.HALF_FLOAT,format:t.RGBA})]),passThrough:!0,resolutionRatio:.5}),d=new Q(t,{name:"dof/bokeh",frag:rp,uniforms:A.merge(n,{uCocTex:{value:u.renderTarget.textures[0],type:"1i"},uParams:{value:l,type:"4f"}}),renderTarget:new Z(t).setTexture([new W(t).setting({magFilter:t.LINEAR,minFilter:t.LINEAR})]),passThrough:!0,resolutionRatio:.5}),h=new Q(t,{name:"dof/composite",frag:op,uniforms:A.merge({uBokeTex:{value:d.renderTarget.textures[0],type:"1i"}}),renderTarget:new Z(t).setTexture([new W(t).setting({magFilter:t.LINEAR,minFilter:t.LINEAR,internalFormat:t.RGBA16F,type:t.HALF_FLOAT,format:t.RGBA})])}),f=16,v=new Q(t,{name:"motionBlurTile",frag:up,uniforms:A.merge({uVelTex:{value:null,type:"1i"}}),renderTarget:new Z(t).setTexture([new W(t).setting({type:t.FLOAT,internalFormat:t.RGBA32F,format:t.RGBA})]),defines:{TILE:f},resolutionRatio:1/f,passThrough:!0}),x=new Q(t,{name:"motionBlurNeighbor",frag:lp,uniforms:A.merge({uVelTex:{value:v.renderTarget.textures[0],type:"1i"}}),defines:{TILE:f},renderTarget:new Z(t).setTexture([new W(t).setting({type:t.FLOAT,internalFormat:t.RGBA32F,format:t.RGBA})]),resolutionRatio:1/f,passThrough:!0}),_=new Q(t,{name:"motionBlur",frag:ap,uniforms:A.merge({uVelNeighborTex:{value:x.renderTarget.textures[0],type:"1i"},uVelTex:{value:null,type:"1i"},uDepthTexture:{value:null,type:"1i"},uPower:{value:1,type:"1f"}}),defines:{TILE:f}});this.postprocess=new et({passes:[i,o,a,u,d,h,v,x,_]}),this._timeUniforms=n,this._ssr=o,this._ssComposite=a,this.dofCoc=u,this.dofBokeh=d,this.dofComposite=h,this._motionBlur=_,this._motionBlurTile=v,this._dofParams=l,this.rtSSR1=r,this.rtSSR2=s,this._renderCamera=null}update(t){if(!this._renderCamera)return;this._timeUniforms.uTimeEF.value=(this._timeUniforms.uTimeEF.value+t.timeDelta)%1;const n=this._renderCamera.fov,i=this._renderCamera.dofParams.focusDistance,r=this._renderCamera.dofParams.kFilmHeight,s=r/Math.tan(.5*(n/180*Math.PI)),o=1/this.dofBokeh.renderTarget.size.y*5,a=1/o,l=s*s/(.3*(i-s)*r*2);this._dofParams.set(i,o,a,l);const u=this.rtSSR1;this.rtSSR1=this.rtSSR2,this.rtSSR2=u,this._ssr.setRendertarget(this.rtSSR1),this._ssComposite.uniforms.uSSRTexture.value=this.rtSSR1.textures[0],this._ssr.uniforms.uSSRBackBuffer.value=this.rtSSR2.textures[0]}resize(t){this.postprocess.resize(t)}setRenderCamera(t){this._renderCamera=t;const n=t.renderTarget;n&&(this.postprocess.passes[0]&&(this.postprocess.passes[0].backBufferOverride=n.shadingBuffer.textures),this._ssr.uniforms.uGbufferPos.value=n.gBuffer.textures[0],this._ssr.uniforms.uGbufferNormal.value=n.gBuffer.textures[1],this._ssr.uniforms.uSceneTex.value=n.forwardBuffer.textures[0],this._ssComposite.uniforms.uGbufferPos.value=n.gBuffer.textures[0],this._ssComposite.uniforms.uGbufferNormal.value=n.gBuffer.textures[1],this.dofCoc.uniforms.uGbufferPos.value=n.gBuffer.textures[0],this._motionBlurTile.uniforms.uVelTex.value=n.gBuffer.textures[4],this._motionBlur.uniforms.uVelTex.value=n.gBuffer.textures[4],this._motionBlur.uniforms.uDepthTexture.value=n.gBuffer.depthTexture)}}const hp=`// @shader-file: packages/maxpower/Component/Renderer/PMREMRender/shaders/pmrem.fs
#include<common>
uniform sampler2D uBackBuffer0,uPMREMBackBuffer;uniform samplerCube uEnvMap;uniform float uRoughness,uTimeEF;layout(location=0)out vec4 outColor;in vec2 vUv;
#include<random>
#include<pmrem>
vec2 t(float u,float v){uint f=uint(u);f=f<<16u|f>>16u;f=(f&1431655765u)<<1u|(f&2863311530u)>>1u;f=(f&858993459u)<<2u|(f&3435973836u)>>2u;f=(f&252645135u)<<4u|(f&4042322160u)>>4u;f=(f&16711935u)<<8u|(f&4278255360u)>>8u;float y=float(f)*.0000000002328306;return vec2(u/v,y);}vec3 t(vec2 v,float f,vec3 u){f*=f;float y=2.*PI*v.x,r=sqrt((1.-v.y)/(1.+(f*f-1.)*v.y));f=sqrt(1.-r*r);vec3 s;s.x=f*cos(y);s.y=f*sin(y);s.z=r;vec3 t=normalize(cross(abs(u.z)<.999?vec3(0,0,1):vec3(1,0,0),u));return t*s.x+cross(u,t)*s.y+u*s.z;}vec3 t(vec3 f){float u=uRoughness;vec3 v=f,r=f;f=vec3(0);float y=0.;for(int s=0;s<NUM_SAMPLES;s++){vec2 z=t(float(s),float(NUM_SAMPLES));z.x+=random(vec2(vUv+uTimeEF*.1));z.y+=random(vec2(vUv+uTimeEF*.1+1.));z=fract(z);vec3 i=t(z,u,v);i=2.*dot(r,i)*i-r;float m=saturate(dot(v,i));if(m>0.)f+=texture(uEnvMap,i).xyz*m,y+=m;}return f/max(y,1.);}void main(){vec4 f=vec4(0);vec2 v=vec2(textureSize(uPMREMBackBuffer,0));f.xyz+=t(getPmremDir((fract(vUv*vec2(3,2))-.5)*(1.+1./v*2.)+.5,floor(vUv.x*3.)+floor(vUv.y*2.)*3.));outColor=vec4(mix(texture(uPMREMBackBuffer,vUv).xyz,f.xyz,.04),1);}`;class mp extends De{constructor(n,i){super();c(this,"postprocess");c(this,"resolution");c(this,"renderTarget");c(this,"pmremPasses");c(this,"swapBuffers");c(this,"timeUniforms");c(this,"postProcessRenderer");const r=i.resolution,s={uTimeEF:{value:0,type:"1f"}},o=new Z(n).setTexture([new W(n).setting({type:n.FLOAT,internalFormat:n.RGBA16F,format:n.RGBA,magFilter:n.LINEAR,minFilter:n.LINEAR,wrapS:n.CLAMP_TO_EDGE,wrapT:n.CLAMP_TO_EDGE,generateMipmap:!0})]),a=[],l=[],u=[],d=5;let h=0;for(let f=0;f<d;f++){const v=1/Math.pow(2,f),x=r.x*v,_=r.y*v*.5,z=new M(0,h,x,_);h+=_,u.push({rt1:new Z(n).setTexture([new W(n).setting({type:n.FLOAT,internalFormat:n.RGBA16F,format:n.RGBA})]),rt2:new Z(n).setTexture([new W(n).setting({type:n.FLOAT,internalFormat:n.RGBA16F,format:n.RGBA})])});let g=1/(d-1)*f;g=g;const p=new Q(n,{renderTarget:u[f].rt1,frag:hp,uniforms:A.merge(s,{uRoughness:{value:g,type:"1f"},uEnvMap:{value:i.input,type:"1i"},uPMREMBackBuffer:{value:u[f].rt2.textures,type:"1i"},uRenderCount:{value:1,type:"1f"}}),defines:{NUM_SAMPLES:Math.floor(Math.pow(2,f+1))}});p.resize(new M(x,_));const y=new Q(n,{renderTarget:o,viewPort:z,passThrough:!0});y.resize(r),a.push(p,y),l.push(p)}this.postprocess=new et({passes:a}),this.postprocess.passes[0].backBufferOverride=o.textures,this.resolution=r,this.renderTarget=o,this.pmremPasses=l,this.swapBuffers=u,this.timeUniforms=s,this.postProcessRenderer=null}setPostProcessRenderer(n){this.postProcessRenderer=n}renderProcess(){this.postProcessRenderer?this.postProcessRenderer.renderPostProcess(this.postprocess,void 0,this.resolution):console.warn("PostProcessRenderer has not been set in PMREMRender. Call setPostProcessRenderer first.")}swap(){this.timeUniforms.uTimeEF.value=(this.timeUniforms.uTimeEF.value+.016)%1;for(let n=0;n<this.pmremPasses.length;n++){const i=this.pmremPasses[n],r=this.swapBuffers[n],s=r.rt1;r.rt1=r.rt2,r.rt2=s,i.setRendertarget(r.rt1),i.uniforms.uPMREMBackBuffer.value=r.rt2.textures}}resize(n){}}class pp{constructor(t){c(this,"gl");c(this,"pool");this.gl=t,this.pool=new Map}get(t,n){const i=t+n,r=this.pool.get(i);if(r!==void 0&&r.program)return r;const s=new ac(this.gl);return this.compileWithErrorHandling(s,t,n),this.pool.set(i,s),s}compileWithErrorHandling(t,n,i){t.setShader(n,i)}checkShaderCompile(t,n,i){const r=this.gl.createShader(n);if(!r)return{success:!1};if(this.gl.shaderSource(r,t),this.gl.compileShader(r),this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS))return this.gl.deleteShader(r),{success:!0};const o=this.gl.getShaderInfoLog(r),a=n===this.gl.VERTEX_SHADER?"vertex":"fragment";if(this.gl.deleteShader(r),!o)return{success:!1};const l=t.split(`
`),u=o.matchAll(/ERROR: 0:(\d+)/g);return{success:!1,error:Array.from(u).map((h,f)=>{const v=Number(h[1]),x=Math.max(0,v-5),_=Math.min(l.length,v+2);let z="";return l.forEach((g,p)=>{x<=p&&p<=_&&(z+=`${p+1}: ${g}
`)}),{shaderKey:i,type:a,message:o.split(`
`)[f],line:v,sourceContext:z,fullSource:t}})[0]}}}let Fr=0;class uc extends De{constructor(n){super();c(this,"gl");c(this,"resolution");c(this,"_extDisJointTimerQuery");c(this,"programManager");c(this,"_lights");c(this,"_envMapCameras");c(this,"_envMapRenderTarget");c(this,"_pmremRender");c(this,"_deferredRenderer");c(this,"_pipelinePostProcess");c(this,"_quad");c(this,"_glStateCahce");c(this,"_queryList",[]);c(this,"_queryListQueued",[]);c(this,"_queryFrameCount",0);c(this,"_isCorrentCompiles");c(this,"compileDrawParams");c(this,"_tmpNormalMatrix");c(this,"_tmpModelViewMatrix");c(this,"_tmpViewMatrixInverseMatrix");c(this,"_tmpLightDirection");c(this,"_tmpModelMatrixInverse");c(this,"_tmpProjectionMatrixInverse");c(this,"_tmpResolution");c(this,"onAfterUI");this.gl=n,this._isCorrentCompiles=!1,this.compileDrawParams=[],this.programManager=new pp(this.gl),this.resolution=new M,this._extDisJointTimerQuery=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this._extDisJointTimerQuery||console.warn("[Renderer] EXT_disjoint_timer_query_webgl2 extension is not supported. GPU timing features will be disabled."),this._lights={directional:[],spot:[]};const i=new sm(this.gl);this._envMapRenderTarget=new rm(this.gl).setTexture([i]),this._envMapRenderTarget.setSize(256,256);const r=new M(0,0,0),s=new M(0,-1,0),o=[new K().lookAt(r,new M(1,0,0),s),new K().lookAt(r,new M(0,1,0),new M(0,0,1)),new K().lookAt(r,new M(0,0,1),s),new K().lookAt(r,new M(-1,0,0),s),new K().lookAt(r,new M(0,-1,0),new M(0,0,-1)),new K().lookAt(r,new M(0,0,-1),s)];this._envMapCameras=[];for(let a=0;a<6;a++){const l=new oe({name:"envMapCamera/"+a}),u=l.addComponent(wa);u.fov=90,u.near=.1,u.far=1e3,u.aspect=1,l.applyMatrix(o[a].clone()),u.updateViewMatrix(),u.updateProjectionMatrix(),this._envMapCameras.push({entity:l,camera:u})}this._pmremRender=new mp(this.gl,{input:[i],resolution:new M(256*3,256*4)}),this._deferredRenderer=new np({gl:n,envMap:this._pmremRender.renderTarget.textures[0],envMapCube:i}),this._pipelinePostProcess=new fp(n),this._quad=new yn({width:2,height:2}),this._glStateCahce={},this._tmpLightDirection=new M,this._tmpModelMatrixInverse=new K,this._tmpViewMatrixInverseMatrix=new K,this._tmpProjectionMatrixInverse=new K,this._tmpModelViewMatrix=new K,this._tmpNormalMatrix=new K,this._tmpResolution=new M,this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}getRenderStack(n,i){const r={camera:[],light:[],deferred:[],forward:[],ui:[],shadowMap:[],envMap:[],empty:[],lightVisibility:new Map},s=o=>{const a=o.entity,u=i&&i.forceDraw||(o.visibility||o.visibility===void 0)&&a.visible,d=a.getComponent(B);if(d&&u){const v=d.material;v.visibilityFlag.deferred&&r.deferred.push(a),v.visibilityFlag.shadowMap&&r.shadowMap.push(a),v.visibilityFlag.forward&&r.forward.push(a),v.visibilityFlag.ui&&r.ui.push(a),v.visibilityFlag.envMap&&r.envMap.push(a)}else u&&r.empty.push(a);const h=a.getComponent(Wr);h&&h.enabled&&r.camera.push(a);const f=a.getComponent(Tn);f&&f.enabled&&(r.light.push(a),r.lightVisibility.set(a,u));for(let v=0;v<a.children.length;v++)s({entity:a.children[v],visibility:u});return r};return s({entity:n,visibility:!0}),r}render(n,i,r){n.onBeforeRender(r);const s=this.getRenderStack(n,r),o=Object.keys(this._lights);for(let h=0;h<o.length;h++){const f=o[h];this._lights[f]=[]}for(let h=0;h<s.light.length;h++){const f=s.light[h],v=f.getComponent(Tn);if(v){const x=s.lightVisibility.get(f)||!1;this.collectLight(f,v,x)}}this._lights.directional.sort((h,f)=>(h.component.castShadow?0:1)-(f.component.castShadow?0:1)),this._lights.spot.sort((h,f)=>(h.component.castShadow?0:1)-(f.component.castShadow?0:1));const a=h=>{for(let f=0;f<h.length;f++){const v=h[f];if(v.component.castShadow&&v.component.renderTarget){const x=s.light.find(_=>_.getComponent(Tn)===v.component);x&&s.lightVisibility.get(x)&&this.renderCamera("shadowMap",x,s.shadowMap,v.component.renderTarget,this.resolution)}}};a(this._lights.directional),a(this._lights.spot);for(let h=0;h<this._envMapCameras.length;h++){const{entity:f}=this._envMapCameras[h];this._envMapRenderTarget.face(h),this.renderCamera("envMap",f,s.envMap,this._envMapRenderTarget,this.resolution)}this.renderPostProcess(this._pmremRender.postprocess,void 0,this._pmremRender.resolution),this._pmremRender.swap();const l=i.getComponent(Wr);if(!l){n.onAfterRender(r);return}if(this.gl.disable(this.gl.BLEND),!l.renderTarget){n.onAfterRender(r);return}this.renderCamera("deferred",i,s.deferred,l.renderTarget.gBuffer,this.resolution),this._deferredRenderer.setRenderCamera(l),this.renderPostProcess(this._deferredRenderer.postprocess,void 0,this.resolution,{cameraOverride:{viewMatrix:l.viewMatrix,viewMatrixPrev:l.viewMatrixPrev,projectionMatrix:l.projectionMatrix,projectionMatrixPrev:l.projectionMatrixPrev,cameraMatrixWorld:i.matrixWorld}}),this._deferredRenderer.update(r),this.gl.enable(this.gl.BLEND),this.renderCamera("forward",i,s.forward,l.renderTarget.forwardBuffer,this.resolution,{uniformOverride:{uDeferredTexture:{value:l.renderTarget.shadingBuffer.textures[1],type:"1i"},uDeferredResolution:{value:l.renderTarget.shadingBuffer.size,type:"2fv"},uEnvMap:{value:this._pmremRender.renderTarget.textures[0],type:"1i"}},disableClear:!0}),this.gl.disable(this.gl.BLEND),this._pipelinePostProcess.setRenderCamera(l),this.renderPostProcess(this._pipelinePostProcess.postprocess,void 0,this.resolution,{cameraOverride:{viewMatrix:l.viewMatrix,projectionMatrix:l.projectionMatrix,cameraMatrixWorld:i.matrixWorld,cameraNear:l.near,cameraFar:l.far}}),this._pipelinePostProcess.update(r);let u=this._pipelinePostProcess.postprocess.output?this._pipelinePostProcess.postprocess.output:void 0;const d=i.getComponent(lc);if(d)for(let h=0;h<d.postProcesses.length;h++){const f=d.postProcesses[h];f.enabled&&f.hasOutput&&(this.renderPostProcess(f,u,this.resolution,{cameraOverride:{viewMatrix:l.viewMatrix,projectionMatrix:l.projectionMatrix,cameraMatrixWorld:i.matrixWorld,cameraNear:l.near,cameraFar:l.far}}),u=f.output||void 0)}if(u){this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,u.getFrameBuffer()),this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,l.renderTarget.uiBuffer.getFrameBuffer());const h=u.size;this.gl.blitFramebuffer(0,0,h.x,h.y,0,0,h.x,h.y,this.gl.COLOR_BUFFER_BIT,this.gl.NEAREST)}if(this.gl.enable(this.gl.BLEND),this.renderCamera("forward",i,s.ui,l.renderTarget.uiBuffer,this.resolution,{uniformOverride:{uDeferredTexture:{value:l.renderTarget.shadingBuffer.textures[1],type:"1i"}},disableClear:!0}),this.gl.disable(this.gl.BLEND),this.onAfterUI&&this.onAfterUI({stack:s,cameraEntity:i,camera:l,event:r}),l.displayOut){const h=l.renderTarget.uiBuffer;this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,h===null?null:h.getFrameBuffer()),this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,null),this.gl.blitFramebuffer(0,0,this.resolution.x,this.resolution.y,0,0,this.resolution.x,this.resolution.y,this.gl.COLOR_BUFFER_BIT,this.gl.NEAREST)}n.onAfterRender(r)}renderCamera(n,i,r,s,o,a){const l=i.getComponentsByTag("camera")[0]||i.getComponent(Tn);a=a||{};const u={viewMatrix:l.viewMatrix,viewMatrixPrev:l.viewMatrixPrev,projectionMatrix:l.projectionMatrix,projectionMatrixPrev:l.projectionMatrixPrev,cameraMatrixWorld:i.matrixWorld,cameraNear:l.near,cameraFar:l.far,renderTarget:s,uniformOverride:a.uniformOverride,...a.cameraOverride};if(l.viewPort){const h=l.viewPort;this.gl.viewport(h.x,h.y,h.z,h.w)}else s?this.gl.viewport(0,0,s.size.x,s.size.y):this.gl.viewport(0,0,o.x,o.y);const d=this._tmpResolution;s?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,s.getFrameBuffer()),this.gl.drawBuffers(s.textureAttachmentList),d.set(s.size.x,s.size.y)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),d.set(o.x,o.y)),u.uniformOverride||(u.uniformOverride={}),u.uniformOverride.uResolution={value:d,type:"2fv"},a.disableClear||(n=="shadowMap"?(this.gl.clearColor(1,1,1,1),this.gl.clearDepth(1)):(this.gl.clearColor(0,0,0,1),this.gl.clearDepth(1)),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT));for(let h=0;h<r.length;h++){const f=r[h],v=f.getComponentsByTag("materialOverride")[0],x=f.getComponent(B),_=v?v.material:x.material,z=x.geometry;u.modelMatrixWorld=f.matrixWorld,u.modelMatrixWorldPrev=f.matrixWorldPrev,u.label=`cam[${l.uuid}]/${f.name||_.name||"-"}`,this.draw(f.uuid,n,z,_,u)}this.emit("drawPass",[s,"camera/"+n])}collectLight(n,i,r){const s=i.lightType,o=r?i.intensity*Math.PI:0,a={position:new M(0,0,0,1).applyMatrix4(n.matrixWorld),direction:new M(0,1,0,0).applyMatrix4(n.matrixWorld).normalize(),color:new M(i.color.x,i.color.y,i.color.z).multiply(o),component:i};s=="directional"?this._lights.directional.push(a):s=="spot"&&this._lights.spot.push(a),i.castShadow&&i.renderTarget==null&&i.setShadowMap(new Z(this.gl).setTexture([new W(this.gl).setting({magFilter:this.gl.LINEAR,minFilter:this.gl.LINEAR})]))}renderPostProcess(n,i,r,s){let o=i?i.textures:void 0;if(n.passes)for(let a=0;a<n.passes.length;a++){const l=n.passes[a];if(l.enabled===!1)continue;const u=l.renderTarget;if(l.viewPort){const v=l.viewPort;this.gl.viewport(v.x,v.y,v.z,v.w)}else u?this.gl.viewport(0,0,u.size.x,u.size.y):r&&this.gl.viewport(0,0,r.x,r.y);u?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,u.getFrameBuffer()),this.gl.drawBuffers(u.textureAttachmentList)):this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);let d=0;l.clearColor&&(this.gl.clearColor(l.clearColor.x,l.clearColor.y,l.clearColor.z,l.clearColor.w),d|=this.gl.COLOR_BUFFER_BIT),l.clearDepth!==null&&(this.gl.clearDepth(l.clearDepth),d|=this.gl.DEPTH_BUFFER_BIT),d!==0&&this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);const h=l.backBufferOverride||o||null;if(h)for(let v=0;v<h.length;v++)l.uniforms["uBackBuffer"+v]={type:"1i",value:h[v]};const f=s&&s.cameraOverride||{};f.label=l.name,f.renderTarget=u,this.draw(l.uuid,"postprocess",this._quad,l,f),l.onAfterRender(),!l.passThrough&&l.renderTarget&&(o=l.renderTarget.textures),this.emit("drawPass",[l.renderTarget,l.name])}}draw(n,i,r,s,o){if(this._isCorrentCompiles){this.compileDrawParams.push({drawId:n,renderType:i,geometry:r,material:s,param:{...o}});return}Fr=0;let a=this.gl.CULL_FACE;const l=this._glStateCahce[a];(l===void 0||l.state!=s.cullFace)&&(s.cullFace?this.gl.enable(a):this.gl.disable(a)),a=this.gl.DEPTH_TEST;const u=this._glStateCahce[a];(u===void 0||u.state!=s.depthTest)&&(s.depthTest?this.gl.enable(a):this.gl.disable(a)),this.gl.depthMask(s.depthWrite);let d=s.programCache[i];if(!d){const f={...s.defines};i=="deferred"?f.IS_DEFERRED="":i=="forward"||i=="envMap"?f.IS_FORWARD="":i=="shadowMap"&&(f.IS_DEPTH="");const v=Hr(s.vert,f,this._lights),x=Hr(s.frag,f,this._lights);d=this.programManager.get(v,x),s.programCache[i]=d}if(d.resetUniforms(),o&&(o.modelMatrixWorld&&(d.setUniform("uModelMatrix","Matrix4fv",o.modelMatrixWorld.elm),d.setUniform("uModelMatrixInverse","Matrix4fv",this._tmpModelMatrixInverse.copy(o.modelMatrixWorld).inverse().elm),o.modelMatrixWorldPrev&&d.setUniform("uModelMatrixPrev","Matrix4fv",o.modelMatrixWorldPrev.elm),o.viewMatrix&&(this._tmpModelViewMatrix.copy(o.modelMatrixWorld).preMultiply(o.viewMatrix),this._tmpNormalMatrix.copy(this._tmpModelViewMatrix),this._tmpNormalMatrix.inverse(),this._tmpNormalMatrix.transpose(),d.setUniform("uModelViewMatrix","Matrix4fv",this._tmpModelViewMatrix.elm),d.setUniform("uNormalMatrix","Matrix4fv",this._tmpNormalMatrix.elm),d.setUniform("uViewMatrixInverse","Matrix4fv",this._tmpViewMatrixInverseMatrix.copy(o.viewMatrix).inverse().elm))),o.viewMatrix&&(d.setUniform("uViewMatrix","Matrix4fv",o.viewMatrix.elm),o.viewMatrixPrev&&d.setUniform("uViewMatrixPrev","Matrix4fv",o.viewMatrixPrev.elm)),o.projectionMatrix&&(d.setUniform("uProjectionMatrix","Matrix4fv",o.projectionMatrix.elm),d.setUniform("uProjectionMatrixInverse","Matrix4fv",this._tmpProjectionMatrixInverse.copy(o.projectionMatrix).inverse().elm),o.projectionMatrixPrev&&d.setUniform("uProjectionMatrixPrev","Matrix4fv",o.projectionMatrixPrev.elm)),o.cameraMatrixWorld&&(d.setUniform("uCameraMatrix","Matrix4fv",o.cameraMatrixWorld.elm),d.setUniform("uCameraPosition","3f",[o.cameraMatrixWorld.elm[12],o.cameraMatrixWorld.elm[13],o.cameraMatrixWorld.elm[14]])),i!="deferred"&&(o.cameraNear&&d.setUniform("uCameraNear","1f",[o.cameraNear]),o.cameraFar&&d.setUniform("uCameraFar","1f",[o.cameraFar]))),s.useLight&&i!=="deferred"&&i!=="shadowMap"){for(let f=0;f<this._lights.directional.length;f++){const v=this._lights.directional[f];if(d.setUniform("uDirectionalLight["+f+"].direction","3fv",v.direction.getElm("vec3")),d.setUniform("uDirectionalLight["+f+"].color","3fv",v.color.getElm("vec3")),v.component.renderTarget){const x=v.component.renderTarget.textures[0].activate(Fr++),_=`uDirectionalLightCamera[${f}]`;d.setUniform(_+".near","1fv",[v.component.near]),d.setUniform(_+".far","1fv",[v.component.far]),d.setUniform(_+".viewMatrix","Matrix4fv",v.component.viewMatrix.elm),d.setUniform(_+".projectionMatrix","Matrix4fv",v.component.projectionMatrix.elm),d.setUniform(_+".resolution","2fv",x.size.getElm("vec2")),d.setUniform("uDirectionalLightShadowMap["+f+"]","1i",[x.unit])}}for(let f=0;f<this._lights.spot.length;f++){const v=this._lights.spot[f];o&&o.viewMatrix&&this._tmpLightDirection.copy(v.direction).applyMatrix3(o.viewMatrix);const x=`uSpotLight[${f}]`;if(d.setUniform(x+".position","3fv",v.position.getElm("vec3")),d.setUniform(x+".direction","3fv",v.direction.getElm("vec3")),d.setUniform(x+".color","3fv",v.color.getElm("vec3")),d.setUniform(x+".angle","1fv",[Math.cos(v.component.angle/2)]),d.setUniform(x+".blend","1fv",[v.component.blend]),d.setUniform(x+".distance","1fv",[v.component.distance]),d.setUniform(x+".decay","1fv",[v.component.decay]),v.component.renderTarget){const _=v.component.renderTarget.textures[0].activate(Fr++),z=`uSpotLightCamera[${f}]`;d.setUniform(z+".near","1fv",[v.component.near]),d.setUniform(z+".far","1fv",[v.component.far]),d.setUniform(z+".viewMatrix","Matrix4fv",v.component.viewMatrix.elm),d.setUniform(z+".projectionMatrix","Matrix4fv",v.component.projectionMatrix.elm),d.setUniform(z+".resolution","2fv",_.size.getElm("vec2")),d.setUniform("uSpotLightShadowMap["+f+"]","1i",[_.unit])}}}vp(d,{...s.uniforms,...o&&o.uniformOverride});const h=d.getVAO(n.toString());h&&(r.vaoCache.get(h)||(r.createBuffers(this.gl),r.attributes.forEach((f,v)=>{f.buffer!==void 0&&(v=="index"?h.setIndex(f.buffer):h.setAttribute(v,f.buffer,f.size,f.opt))}),r.vaoCache.set(h,!0)),d.use(f=>{f.uploadUniforms(),this.gl.bindVertexArray(h.getVAO());const v=h.indexBuffer;let x=this.gl.UNSIGNED_SHORT;v&&v.array&&v.array.BYTES_PER_ELEMENT==4&&(x=this.gl.UNSIGNED_INT),s.blending=="NORMAL"?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):s.blending=="ADD"?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):s.blending=="DIFF"&&this.gl.blendFunc(this.gl.ONE_MINUS_DST_COLOR,this.gl.ONE_MINUS_DST_COLOR);const _=this.gl[s.drawType];h.instanceCount>0?v?this.gl.drawElementsInstanced(_,h.indexCount,x,0,h.instanceCount):this.gl.drawArraysInstanced(_,0,h.vertCount,h.instanceCount):v?this.gl.drawElements(_,h.indexCount,x,0):this.gl.drawArrays(_,0,h.vertCount),this.gl.bindVertexArray(null)}))}resize(n){this.resolution.copy(n),this._deferredRenderer.resize(this.resolution),this._pipelinePostProcess.resize(this.resolution)}get deferredRenderer(){return this._deferredRenderer}async compileShaders(n,i,r,s){this._isCorrentCompiles=!0,this.compileDrawParams=[],this.render(n,i,r),this._isCorrentCompiles=!1,console.log(this.compileDrawParams);const o=this.compileDrawParams.length;let a=0;for(let l=0;l<this.compileDrawParams.length;l++){const u=this.compileDrawParams[l],d=u.param.renderTarget;if(d?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,d.getFrameBuffer()),this.gl.drawBuffers(d.textureAttachmentList)):this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.draw(u.drawId,u.renderType,u.geometry,u.material,u.param),await new Promise(h=>{setTimeout(()=>{h(null)},10)}),s){a++;const h=u.param&&u.param.label||"-",f=`${u.renderType}/${h}/[${u.drawId}]`;s(f,a,o)}}}}const vp=(e,t)=>{const n=Object.keys(t);for(let i=0;i<n.length;i++){const r=n[i],s=t[r];if(!s)continue;const o=s.type,a=s.value,l=[],u=d=>{d!=null&&(typeof d=="number"||typeof d=="boolean"?l.push(d):"isVector"in d?l.push(...d.getElm("vec"+o.charAt(0))):"isTexture"in d?(d.activate(Fr++),l.push(d.unit)):l.push(...d.elm))};if(Array.isArray(a))for(let d=0;d<a.length;d++)u(a[d]);else u(a);l.length>0&&e.setUniform(r,o,l)}};class ai{static serializeEntity(t){const n=i=>{const r=[];return i.children.forEach(s=>{s.initiator!="script"&&r.push(n(s))}),{name:i.name,uuid:i.uuid,pos:i.position.x==0&&i.position.y==0&&i.position.z==0?void 0:i.position.getElm("vec3"),rot:i.euler.x==0&&i.euler.y==0&&i.euler.z==0?void 0:i.euler.getElm("vec3"),scale:i.scale.x==1&&i.scale.y==1&&i.scale.z==1?void 0:i.scale.getElm("vec3"),childs:r.length>0?r:void 0}};return n(t)}static serializeEntityOverride(t){const n=[];return t.traverse(i=>{const r={uuid:i.uuid},s=[];i.components.forEach(o=>{const a=o.serialize({mode:"export"}),l=Object.keys(a).length>0,u={name:o.constructor.name};o.initiator==="user"&&(l&&(u.props=a),s.push(u))}),s.length>0&&(r.components=s),!(i.initiator!=="user"&&!r.components)&&n.push(r)}),n}static deserializeOverride(t,n){n.traverse(i=>{const r=t.find(s=>s.uuid===i.uuid);r&&(r.components||[]).forEach(s=>{const o=re.resources.getComponent(s.name);if(o){const a=i.addComponent(o.component);a.initiator="user",s.props&&a.deserialize(s.props)}})})}static deserializeEntity(t,n){const i=(r,s)=>{const o=s||new oe;o.initiator="user",o.name=r.name,r.uuid&&(o.uuid=r.uuid);const a=r.pos||[0,0,0];o.position.x=a[0],o.position.y=a[1],o.position.z=a[2];const l=r.rot||[0,0,0];o.euler.x=l[0],o.euler.y=l[1],o.euler.z=l[2];const u=r.scale||[1,1,1];return o.scale.x=u[0],o.scale.y=u[1],o.scale.z=u[2],r.childs&&r.childs.forEach(d=>{o.add(i(d))}),o};t&&i(t,n),n.initiator="god"}}class gp extends De{constructor(){super();c(this,"_componentList");c(this,"_componentGroups");c(this,"_textures");this._componentList=[],this._textures=new Map,this._componentGroups=[]}get componentList(){return this._componentList}get componentGroups(){return this._componentGroups}get textures(){return this._textures}clear(){this._componentList=[],this._componentGroups=[],this._textures.clear()}getComponent(n){return this._componentList.find(i=>i.name==n)}addComponentGroup(n){let i=this._componentGroups.find(s=>s.name==n);if(i)return i;const r=s=>{const o=[];return{child:o,name:s,addComponent:(a,l)=>{const u={name:a,component:l};o.push(u),this._componentList.push(u)},createGroup:a=>{const l=r(a);return o.push(l),l}}};return i=r(n),this._componentGroups.push(i),i}addTexture(n,i){return this._textures.set(n,i),i}getTexture(n){return this._textures.get(n)}}const Ln=class Ln extends oe{constructor(n){super();c(this,"enableRender");c(this,"_audioBuffer");c(this,"_renderer");c(this,"_cameraEntity");c(this,"_gl");c(this,"_canvas");c(this,"_projectCache");c(this,"_root");c(this,"_uniforms");c(this,"_time");c(this,"_frame");c(this,"_frameSetting");c(this,"_disposed");Ln.instances.set(n,this),this._gl=n,this.name="OREngine",this._disposed=!1,this._cameraEntity=null,this._uniforms={uTime:{value:0,type:"1f"},uTimeE:{value:0,type:"1f"},uEnvMapIntensity:{value:1,type:"1f"}},this._canvas=n.canvas,this._renderer=new uc(n),this._projectCache=null,this._time={current:new Date().getTime(),engine:0,delta:0,code:0},this._frameSetting={duration:600,fps:30},this._frame={current:0,playing:!1},this.seek(0),this.enableRender=!0,this._audioBuffer=null,this._root=new oe,this._root.initiator="god",this._root.name="root",this.add(this._root),this.field("name",()=>this.name,r=>this.name=r),this.field("scene",()=>ai.serializeEntity(this._root),r=>{ai.deserializeEntity(r,this._root)}),this.field("overrides",()=>ai.serializeEntityOverride(this._root),r=>{ai.deserializeOverride(r,this._root)});const i=this.fieldDir("timeline");i.field("duration",()=>this._frameSetting.duration,r=>this._frameSetting.duration=r),i.field("fps",()=>this._frameSetting.fps,r=>this._frameSetting.fps=r)}static getInstance(n){const i=this.instances.get(n);if(!i)throw new Error("ERROR: NO ENGINE INSTANCE!!!");return i}get gl(){return this._gl}get canvas(){return this._canvas}get renderer(){return this._renderer}get root(){return this._root}get frame(){return this._frame}get time(){return this._time}get frameSetting(){return this._frameSetting}get uniforms(){return this._uniforms}setCamera(n){this._cameraEntity=n}get disposed(){return this._disposed}get projectCache(){return this._projectCache}get audioBuffer(){return this._audioBuffer}init(){this._root.disposeRecursive(),this._root.position.set(0,0,0),this._root.euler.set(0,0,0),this._root.scale.set(1,1,1),this.add(this._root),this.name="New Project"}async load(n){this.init(),this.deserialize(n),this._projectCache=n||null,this.emit("update/graph"),this.emit("loaded")}applyProjectOverrides(n){this._projectCache&&ai.deserializeOverride(this._projectCache.overrides,n)}registerMusic(n){n.on("update/music",i=>{this._audioBuffer=i,this.emit("update/audioBuffer",[i])}),this.emit("register/music",[n])}registerBLidgeClient(n){n.on("sync/scene",i=>{i.frame&&(this.setField("timeline/fps",i.frame.fps),this.setField("timeline/duration",i.frame.end-i.frame.start))}),n.on("update/blidge/frame",(i,r)=>{i.current!==void 0&&this.seek(i.current);const s=r&&r.scrubbing;i.playing&&!this.frame.playing&&!s?this.play():(!i.playing||s)&&this.frame.playing&&this.stop()}),n.on("update/blidge/selection",i=>{this.emit("update/blidge/selection",[i])}),this.emit("register/blidgeClient",[n])}update(n){const i=new Date().getTime();this._time.delta=(i-this._time.current)/1e3,this._time.current=i,this._time.engine+=this._time.delta,this._time.code+=this._time.delta*(this._frame.playing?1:0),this._frame.current=this._time.code*this._frameSetting.fps;const r=this.createEntityUpdateEvent({forceDraw:n==null?void 0:n.forceDraw});return this._uniforms.uTime.value=this._time.code,this._uniforms.uTimeE.value=this._time.engine,this._root.update(r),this.enableRender&&this._cameraEntity&&this._renderer.render(this._root,this._cameraEntity,r),this._frame.playing&&this.emit("update/frame/play",[this._frame]),this._time.delta}createEntityUpdateEvent(n){const i={playing:this._frame.playing,timeElapsed:this._time.engine,timeDelta:this._time.delta,timeCode:this._time.code,timeCodeFrame:this._frame.current,resolution:this.renderer.resolution,renderer:this.renderer,forceDraw:!1};return n?{...i,...n}:i}setSize(n){this._renderer.resize(n),this._canvas.width=n.x,this._canvas.height=n.y}play(){this._frame.playing=!0,this._time.current=new Date().getTime(),this.emit("update/frame/play",[this._frame])}stop(){this._frame.playing=!1,this.emit("update/frame/play",[this._frame])}seek(n){this._time.code=n/this._frameSetting.fps,this._frame.current=n,this.emit("update/frame/play",[this._frame])}compileShaders(n){const i=this.createEntityUpdateEvent({forceDraw:!0});return this._cameraEntity?this.renderer.compileShaders(this._root,this._cameraEntity,i,n):Promise.resolve()}dispose(){super.dispose(),this._disposed=!0,this._root.disposeRecursive()}};c(Ln,"resources"),c(Ln,"instances"),c(Ln,"shaderErrorManager");let re=Ln;re.resources=new gp;re.instances=new Map;const yp=()=>S.useContext(qu),xp="_compoAdd_5919t_45",_p="_directory_5919t_49",wp="_subDirectory_5919t_70",Sp="_picker_5919t_116",$r={compoAdd:xp,directory:_p,subDirectory:wp,picker:Sp},cc=({group:e,onClickAdd:t})=>{const n=yp(),[i,r]=S.useState(!1);let s=null,o,a="dir";return"child"in e?s=m.jsx(m.Fragment,{children:e.child.map((l,u)=>m.jsx(cc,{group:l,onClickAdd:t},u))}):(o=()=>t(e),a="item"),m.jsxs("div",{className:$r.directory,onPointerEnter:()=>r(!0),onPointerLeave:()=>r(!1),onClick:o,"data-type":a,"data-direction":n==null?void 0:n.direction,children:[e.name,i&&m.jsx("div",{className:$r.subDirectory,children:s})]})},Cp=e=>{const{pushContent:t,closeAll:n}=xa(),i=re.resources,r=S.useCallback(s=>{if(!i||!t||!n)return;const o=[],a=l=>{e.entity.addComponent(l.component).initiator="user",n()};i.componentGroups.forEach((l,u)=>{o.push(m.jsx(cc,{group:l,onClickAdd:a},u))}),t(m.jsx("div",{className:$r.picker,children:o}))},[t,i,e.entity,n]);return m.jsx("div",{className:$r.compAdd,children:m.jsx(fn,{onClick:r,children:"Add Component"})})},Ep="_cross_nfbq8_45",Tp={cross:Ep},zp=()=>m.jsx("div",{className:Tp.cross,children:m.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("rect",{x:"5.12",y:"16.832",width:"2.57272",height:"17.6514",transform:"rotate(-135 5.12 16.832)",fill:"#D9D9D9"}),m.jsx("rect",{x:"3.30078",y:"4.35059",width:"2.57272",height:"17.6514",transform:"rotate(-45 3.30078 4.35059)",fill:"#D9D9D9"})]})}),Pp="_edit_f5ct3_45",kp={edit:Pp},Mp=()=>m.jsx("div",{className:kp.edit,children:m.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("path",{d:"M14.5 2.5L17.5 5.5L6.5 16.5H3.5V13.5L14.5 2.5Z",stroke:"#D9D9D9",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M12 5L15 8",stroke:"#D9D9D9",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),Rp=[{name:"DebaBouChou",path:"Demo4/Common/DebaBouChou",shaders:[{type:"fs",path:"shaders/debaBouChou.fs"}]},{name:"HUD",path:"Demo4/Common/HUD",shaders:[{type:"fs",path:"shaders/hud.fs"},{type:"vs",path:"shaders/hud.vs"}]},{name:"MizuBall",path:"Demo4/Common/MizuBall",shaders:[{type:"fs",path:"shaders/mizuBall.fs"}]},{name:"ShaderMotionGraphics",path:"Demo4/Common/ShaderMotionGraphics",shaders:[{type:"fs",path:"shaders/border.fs"},{type:"fs",path:"shaders/circle.fs"},{type:"fs",path:"shaders/cross.fs"},{type:"fs",path:"shaders/dotGrid.fs"},{type:"fs",path:"shaders/ikuraBGScreen.fs"},{type:"fs",path:"shaders/maguroBGScreen.fs"},{type:"fs",path:"shaders/salmonBGScreen.fs"},{type:"vs",path:"shaders/smg.vs"},{type:"fs",path:"shaders/takoBGScreen.fs"}]},{name:"Shari",path:"Demo4/Common/Shari",shaders:[{type:"fs",path:"shaders/shari.fs"},{type:"vs",path:"shaders/shari.vs"}]},{name:"SkyBox",path:"Demo4/Common/SkyBox",shaders:[{type:"fs",path:"shaders/skybox.fs"}]},{name:"TableStage",path:"Demo4/Common/TableStage",shaders:[{type:"fs",path:"shaders/tableStage.fs"}]},{name:"TruchetSushiLane",path:"Demo4/Common/TruchetSushiLane",shaders:[{type:"fs",path:"shaders/truchetSushiLane.fs"}]},{name:"TsuriZao",path:"Demo4/Common/Tsuri/TsuriZao",shaders:[{type:"fs",path:"shaders/basic.fs"}]},{name:"UKPAshi",path:"Demo4/Common/UKPAshi",shaders:[{type:"fs",path:"shaders/basic.fs"}]},{name:"Ukonpower",path:"Demo4/Common/Ukonpower",shaders:[{type:"fs",path:"shaders/ukonpower.fs"}]},{name:"IkuraFluids",path:"Demo4/Ikura/IkuraFluids",shaders:[{type:"fs",path:"shaders/ikuraFluids.fs"},{type:"vs",path:"shaders/ikuraFluids.vs"},{type:"fs",path:"shaders/ikuraFluidsCompute.fs"}]},{name:"GunkanShari",path:"Demo4/Ikura/IkuraGunKan/GunkanShari",shaders:[{type:"fs",path:"shaders/gunkanShari.fs"}]},{name:"Ikura",path:"Demo4/Ikura/IkuraGunKan/Ikura",shaders:[{type:"fs",path:"shaders/ikura.fs"},{type:"vs",path:"shaders/ikura.vs"}]},{name:"Kyuuri",path:"Demo4/Ikura/Kyuuri",shaders:[{type:"fs",path:"shaders/kyuuri.fs"}]},{name:"Maguro",path:"Demo4/Maguro/Maguro",shaders:[{type:"fs",path:"shaders/maguro.fs"}]},{name:"Sashimi",path:"Demo4/Maguro/Sashimi",shaders:[{type:"fs",path:"shaders/sashimi.fs"}]},{name:"GreetingCard",path:"Demo4/Party/GreetingCard",shaders:[{type:"fs",path:"shaders/greeting.fs"},{type:"vs",path:"shaders/greeting.vs"}]},{name:"Sara",path:"Demo4/Party/Sara",shaders:[{type:"fs",path:"shaders/sara.fs"},{type:"vs",path:"shaders/sara.vs"}]},{name:"SushiGeta",path:"Demo4/Party/SushiGeta",shaders:[{type:"fs",path:"shaders/sushiGeta.fs"}]},{name:"Onigiri",path:"Demo4/Salmon/Onigiri",shaders:[{type:"fs",path:"shaders/onigiri.fs"}]},{name:"Salmon",path:"Demo4/Salmon/Salmon",shaders:[{type:"fs",path:"shaders/salmon.fs"}]},{name:"TakoGate",path:"Demo4/Tako/TakoGate",shaders:[{type:"fs",path:"shaders/takogate.fs"}]},{name:"TakoKosen",path:"Demo4/Tako/TakoKosen",shaders:[{type:"fs",path:"shaders/takokosen.fs"},{type:"vs",path:"shaders/takokosen.vs"}]},{name:"Ocean",path:"Demo4/Tsuri/Ocean",shaders:[{type:"fs",path:"shaders/ocean.fs"}]},{name:"Taiyaki",path:"Demo4/Tsuri/Taiyaki",shaders:[{type:"fs",path:"shaders/taiyaki.fs"}]},{name:"Teibo",path:"Demo4/Tsuri/Teibo",shaders:[{type:"fs",path:"shaders/teibo.fs"}]}],Dp="_compoView_v05nu_45",Fp="_head_v05nu_52",Np="_name_v05nu_58",Ip="_check_v05nu_62",Bp="_shaderEditor_v05nu_66",Ap="_propertyBlock_v05nu_86",Sn={compoView:Dp,head:Fp,name:Np,check:Ip,shaderEditor:Bp,delete:"_delete_v05nu_76",propertyBlock:Ap},bp=({component:e})=>{const t=e.initiator!=="user",n=S.useCallback(o=>{o.stopPropagation();const a=e.entity;a&&a.removeComponentByUUID(e.uuid)},[e]),i=S.useMemo(()=>{const o=e.constructor.name;return Rp.find(l=>l.name===o)},[e]),r=S.useCallback(o=>{if(o.stopPropagation(),i){const a=`/shaderEditor?component=${encodeURIComponent(i.path)}`;window.open(a,"_blank")}},[i]),s=m.jsxs("div",{className:Sn.head,children:[m.jsx("div",{className:Sn.name,children:e.constructor.name}),i&&m.jsx("div",{className:Sn.shaderEditor,children:m.jsx("button",{onClick:r,title:"ShaderEditor",children:m.jsx(Mp,{})})}),m.jsx("div",{className:Sn.delete,children:m.jsx("button",{onClick:n,children:m.jsx(zp,{})})})]});return m.jsx("div",{className:Sn.compoView,"data-disable_component":t,children:m.jsx("div",{className:Sn.content,children:m.jsx(Hn,{label:s,accordion:!0,bg:!0,defaultClose:!1,children:m.jsx(rc,{target:e})})})})},Lp="_container_18572_1",Up={container:Lp},jp=({entity:e})=>{const[t]=ce(e,"components"),n=S.useMemo(()=>{const i=[];return t?(t.forEach(r=>{const s=e.getComponentByUUID(r);s&&i.push(m.jsx(bp,{component:s},s.uuid))}),i):null},[t,e]);return m.jsx("div",{className:Up.container,children:n})},Op="_property_5puun_45",Vp="_content_5puun_50",Gp="_name_5puun_54",Wp="_component_controls_5puun_60",Hp={property:Op,content:Vp,name:Gp,component_controls:Wp},ar=()=>{const{editor:e,engine:t}=Mt(),[n]=ce(e,"selectedEntityId"),i=S.useMemo(()=>{if(n)return t.findEntityByUUID(n)},[t,n]);return i?m.jsxs("div",{className:Hp.container,children:[m.jsx(Hn,{label:"Fields",accordion:!0,children:m.jsx(rc,{target:i})}),m.jsxs(Hn,{label:"Components",accordion:!0,children:[m.jsx(jp,{entity:i}),m.jsx(Cp,{entity:i})]})]}):null},dc=S.createContext(null),fc=()=>{const e=S.useContext(dc);if(e===null)throw new Error("useOREngine must be used within a OREngineProvider");return e};class $p{constructor(t){c(this,"buffer");c(this,"index");c(this,"size");c(this,"filled");this.size=t,this.buffer=new Array(t),this.index=0,this.filled=!1}push(t){this.buffer[this.index]=t,this.index=(this.index+1)%this.size,!this.filled&&this.index===0&&(this.filled=!0)}getAverage(){const t=this.filled?this.size:this.index;if(t===0)return 0;let n=0;for(let i=0;i<t;i++)n+=this.buffer[i];return n/t}getMax(){const t=this.filled?this.size:this.index;if(t===0)return 0;let n=this.buffer[0];for(let i=1;i<t;i++)this.buffer[i]>n&&(n=this.buffer[i]);return n}getMin(){const t=this.filled?this.size:this.index;if(t===0)return 0;let n=this.buffer[0];for(let i=1;i<t;i++)this.buffer[i]<n&&(n=this.buffer[i]);return n}getCount(){return this.filled?this.size:this.index}}class Xp{constructor(t=30){c(this,"buffers");c(this,"windowSize");c(this,"currentData");this.windowSize=t,this.buffers=new Map,this.currentData=new Map}update(t){const n=performance.now();for(let i=0;i<t.length;i++){const r=t[i],s=r.name.split("/"),o=s[0]||"unknown";let a;const l=s[s.length-1],u=l&&l.match(/\[([^\]]+)\]/);u&&(a=u[1]);const d={name:r.name,duration:r.duration,timestamp:n,renderType:o};let h=this.buffers.get(r.name);h||(h=new $p(this.windowSize),this.buffers.set(r.name,h)),h.push(r.duration),this.currentData.set(r.name,{...d,entityId:a})}}getStatistics(){const t=[];let n=0;const i=performance.now(),r=1e3,s=[];return this.currentData.forEach((o,a)=>{i-o.timestamp>r&&s.push(a)}),s.forEach(o=>{this.currentData.delete(o)}),this.currentData.forEach(o=>{n+=o.duration}),this.currentData.forEach(o=>{const a=this.buffers.get(o.name);a&&t.push({name:o.name,renderType:o.renderType,entityId:o.entityId,current:o.duration,avg:a.getAverage(),max:a.getMax(),min:a.getMin(),samples:a.getCount(),percentage:n>0?o.duration/n*100:0})}),t}getTotalTime(){let t=0;return this.currentData.forEach(n=>{t+=n.duration}),t}}const Kp="_container_1u95i_45",Yp="_header_1u95i_56",Qp="_totalTime_1u95i_66",Zp="_toggleButton_1u95i_71",qp="_controls_1u95i_90",Jp="_control_1u95i_90",ev="_controlLabel_1u95i_103",tv="_select_1u95i_107",nv="_input_1u95i_124",iv="_warning_1u95i_138",rv="_group_1u95i_146",sv="_groupHeader_1u95i_150",ov="_item_1u95i_157",av="_clickable_1u95i_161",lv="_itemName_1u95i_169",uv="_itemTime_1u95i_177",cv="_itemStats_1u95i_184",dv="_progressBar_1u95i_192",fv="_progressFill_1u95i_200",ie={container:Kp,header:Yp,totalTime:Qp,toggleButton:Zp,controls:qp,control:Jp,controlLabel:ev,select:tv,input:nv,warning:iv,group:rv,groupHeader:sv,item:ov,clickable:av,itemName:lv,itemTime:uv,itemStats:cv,progressBar:dv,progressFill:fv},hv=e=>{if(e<2){const t=e/2;return`rgb(${Math.floor(100+t*100)}, 200, 100)`}else if(e<5){const t=(e-2)/3;return`rgb(200, ${Math.floor(200-t*50)}, 100)`}else if(e<10){const t=(e-5)/5,n=Math.floor(150-t*80),i=Math.floor(100-t*50);return`rgb(200, ${n}, ${i})`}else return"rgb(200, 70, 50)"},Gs=e=>e>=10?e.toFixed(1):e>=1?e.toFixed(2):e.toFixed(3),_l=()=>{const{editor:e}=Mt(),{engine:t}=fc(),[n,i]=S.useState([]),[r,s]=S.useState(0),[o,a]=S.useState("all"),[l,u]=S.useState(0),[d,h]=S.useState("time"),[f,v]=S.useState(!1),x=S.useRef(new Xp(30)),_=S.useRef(0),z=S.useRef(!1),g=S.useRef(0),p=C=>{if(!C)return;const T=t.root.findEntityByUUID(C);T&&e.selectEntity(T)};S.useEffect(()=>{const C=t.renderer,T=x.current,F=300,D=V=>{f&&(T.update(V),z.current=!0)},L=V=>{z.current&&V-g.current>=F&&(i(T.getStatistics()),s(T.getTotalTime()),z.current=!1,g.current=V),_.current=requestAnimationFrame(L)};return C.on("timer",D),_.current=requestAnimationFrame(L),()=>{C.off("timer",D),cancelAnimationFrame(_.current)}},[t,f]);const y=n.filter(C=>!(o!=="all"&&C.renderType!==o||C.avg<l)),w=Array.from(new Set(n.map(C=>C.renderType))),E=[...y].sort((C,T)=>d==="time"?T.avg-C.avg:C.name.localeCompare(T.name)),k=r>0?Math.floor(1e3/r):0;return m.jsxs("div",{className:ie.container,children:[m.jsxs("div",{className:ie.header,children:[m.jsxs("div",{className:ie.totalTime,children:["Total: ",Gs(r)," ms (",k," fps)"]}),m.jsx("button",{className:ie.toggleButton,onClick:()=>v(!f),title:f?"Stop timer":"Start timer",children:f?"":""}),m.jsxs("div",{className:ie.controls,children:[m.jsxs("div",{className:ie.control,children:[m.jsx("span",{className:ie.controlLabel,children:"Type:"}),m.jsxs("select",{className:ie.select,value:o,onChange:C=>a(C.target.value),children:[m.jsx("option",{value:"all",children:"All"}),w.map(C=>m.jsx("option",{value:C,children:C},C))]})]}),m.jsxs("div",{className:ie.control,children:[m.jsx("span",{className:ie.controlLabel,children:"Min:"}),m.jsx("input",{className:ie.input,type:"number",min:"0",step:"0.1",value:l,onChange:C=>u(parseFloat(C.target.value)||0)}),m.jsx("span",{className:ie.controlLabel,children:"ms"})]}),m.jsxs("div",{className:ie.control,children:[m.jsx("span",{className:ie.controlLabel,children:"Sort:"}),m.jsxs("select",{className:ie.select,value:d,onChange:C=>h(C.target.value),children:[m.jsx("option",{value:"time",children:"Time"}),m.jsx("option",{value:"name",children:"Name"})]})]})]})]}),m.jsx("div",{className:ie.group,children:E.map((C,T)=>{const F=hv(C.avg),D=r>0?C.avg/r*100:0,L=!!C.entityId;return m.jsxs("div",{className:`${ie.item} ${L?ie.clickable:""}`,onClick:()=>p(C.entityId),children:[m.jsxs("div",{children:[m.jsx("span",{className:ie.itemName,title:C.name,children:C.name}),m.jsxs("span",{className:ie.itemTime,style:{color:F},children:[Gs(C.avg),"ms"]}),m.jsxs("span",{className:ie.itemStats,children:["max:",Gs(C.max)]})]}),m.jsx("div",{className:ie.progressBar,children:m.jsx("div",{className:ie.progressFill,style:{width:`${D}%`,backgroundColor:F}})})]},C.name+T)})})]})},mv="_search_icon_1knbw_45",pv={search_icon:mv},vv=()=>m.jsx("div",{className:pv.search_icon,children:m.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("circle",{cx:"10",cy:"10",r:"7",stroke:"currentColor",strokeWidth:"2"}),m.jsx("path",{d:"M15 15L21 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),gv="_group_vm37a_45",yv="_submit_vm37a_51",wl={group:gv,submit:yv},xv=e=>{const t=e.initialValues,n=[],[i,r]=S.useState(t);S.useEffect(()=>{r(t)},[t]);const s=Object.keys(i);for(let a=0;a<s.length;a++){const l=s[a],u=i[l];n.push(m.jsx(at,{label:l,value:u,onChange:d=>{r({...i,[l]:d})}},a))}const o=S.useRef(null);return S.useEffect(()=>{setTimeout(()=>{var a;o.current&&((a=o.current.querySelector("input"))==null||a.focus())},0)},[]),m.jsx("div",{className:wl.group,ref:o,children:m.jsxs("form",{onSubmit:a=>{a.preventDefault()},children:[m.jsx(Hn,{label:e.title,noMargin:!0,children:n}),m.jsx("div",{className:wl.submit,children:m.jsx(fn,{type:"submit",onClick:()=>{e.onSubmit&&e.onSubmit(i)},children:"OK"})})]})})},_v="_picker_lpoad_45",wv="_picker_label_lpoad_58",Sv="_picker_list_lpoad_63",Cv="_picker_list_inner_lpoad_68",Ev="_item_lpoad_76",li={picker:_v,picker_label:wv,picker_list:Sv,picker_list_inner:Cv,item:Ev},Tv=e=>m.jsxs("div",{className:li.picker,"data-no_bg":e.noBg,children:[e.label&&m.jsx("div",{className:li.picker_label,children:e.label}),m.jsx("div",{className:li.picker_list,children:m.jsx("div",{className:li.picker_list_inner,children:e.list.map((t,n)=>m.jsx("div",{className:li.item,onClick:t.onClick,children:t.label},n))})})]}),zv="_node_dzvso_45",Pv="_self_dzvso_54",kv="_self_name_dzvso_65",Mv="_fold_dzvso_76",Rv="_fold_button_dzvso_79",Dv="_child_dzvso_92",Fv="_child_line_dzvso_95",rn={node:zv,self:Pv,self_name:kv,fold:Mv,fold_button:Rv,child:Dv,child_line:Fv},hc=e=>{const{editor:t,engine:n}=Mt(),[i]=ce(t,"selectedEntityId"),r=i!==void 0&&n.findEntityByUUID(i),[s]=ce(e.entity,"children"),o=(s||[]).map(T=>n.findEntityByUUID(T)).filter(T=>T!==void 0),a=e.depth||0,l=o&&o.concat().sort((T,F)=>T.name.localeCompare(F.name))||[],u=l.length>0,d=a*20,h=e.entity.initiator=="script",f=e.searchQuery||"",v=f.toLowerCase(),x=(T,F)=>F===""||T.name.toLowerCase().includes(F)?!0:T.children.some(D=>x(D,F)),_=x(e.entity,v),z=S.useRef(null);S.useEffect(()=>{r&&r.uuid==e.entity.uuid&&z.current&&z.current.scrollIntoView({behavior:"smooth",block:"center"})},[r,e.entity.uuid]);const[g,p]=S.useState(!0),y=S.useCallback(T=>{p(!g),T.stopPropagation()},[g]),w=S.useCallback(()=>{t&&t.selectEntity(e.entity)},[t,e.entity]),{pushContent:E,closeAll:k}=xa(),C=S.useCallback(T=>{T.preventDefault(),!(!t||!E||!k||h)&&(t.selectEntity(e.entity),E(m.jsx(Tv,{label:e.entity.name,list:[{label:"Add Entity",onClick:()=>{E(m.jsx(xv,{initialValues:{name:""},onSubmit:F=>{const D=t.createEntity(e.entity,F.name);t.selectEntity(D),k()}}))}},{label:"Delete Entity",onClick:()=>{t.deleteEntity(e.entity),k()}}]})))},[t,e.entity,E,k,h]);return _?m.jsxs("div",{className:rn.node,"data-no_export":h,children:[m.jsxs("div",{ref:z,className:rn.self,style:{paddingLeft:d},onClick:w,onContextMenu:C,"data-selected":r&&r.uuid==e.entity.uuid,children:[m.jsx("div",{className:rn.fold,"data-hnode_open":g,children:u&&m.jsx("button",{className:rn.fold_button,onClick:y,children:m.jsx(ya,{open:g})})}),m.jsx("div",{className:rn.self_name,children:m.jsxs("p",{children:[e.entity.name||"-"," ",m.jsxs("span",{children:["[",e.entity.uuid,"]"]})]})})]}),u&&m.jsxs("div",{className:rn.child,"data-open":g,children:[l.map(T=>m.jsx(hc,{entity:T,depth:a+1,searchQuery:f},T.uuid)),m.jsx("div",{className:rn.child_line,style:{marginLeft:d+4}})]})]}):null},Nv="_hierarchy_1x2ql_45",Iv="_search_1x2ql_52",Bv="_search_wrapper_1x2ql_59",Av="_search_input_1x2ql_72",bv="_hierarchy_content_1x2ql_88",ui={hierarchy:Nv,search:Iv,search_wrapper:Bv,search_input:Av,hierarchy_content:bv},Sl=()=>{const{editor:e}=Mt(),t=e.engine.root,[n,i]=S.useState("");return m.jsxs("div",{className:ui.hierarchy,children:[m.jsx("div",{className:ui.search,children:m.jsxs("div",{className:ui.search_wrapper,children:[m.jsx(vv,{}),m.jsx("input",{type:"text",placeholder:"Search entities...",value:n,onChange:r=>i(r.target.value),className:ui.search_input})]})}),m.jsx("div",{className:ui.hierarchy_content,children:t&&m.jsx(hc,{entity:t,searchQuery:n})})]})},Lv="_project_7nnqy_1",Uv="_project_inner_7nnqy_5",jv="_projectSelector_7nnqy_9",Ov="_row_7nnqy_13",Vv="_rowItem_7nnqy_20",Ws={project:Lv,project_inner:Uv,projectSelector:jv,row:Ov,rowItem:Vv,export:"_export_7nnqy_30"},Cl=()=>{const{editor:e}=Mt(),[t,n]=ce(e.engine,"name");return e?m.jsx("div",{className:Ws.project,children:m.jsx("div",{className:Ws.project_inner,children:m.jsxs(Hn,{label:"Project",accordion:!0,children:[m.jsx(Ke,{title:"Project Name",children:m.jsx(go,{value:t||"",onChange:i=>{n(i)}})}),m.jsx(fn,{onClick:()=>{e&&e.save()},children:"Save"}),m.jsx("div",{className:Ws.export,children:m.jsxs(fn,{onClick:()=>{e&&(e.save(),window.open("/player","_blank"))},children:["Play ",m.jsx(ya,{})]})})]})})}):null},Gv="_container_8wzg2_1",Wv={container:Gv},Hv=()=>{const{engine:e,editor:t}=Mt(),n=S.useRef(null);return S.useEffect(()=>{const i=n.current;if(!e||!i)return;const r=e.canvas;if(!r){console.error("Canvas element not found in engine");return}return i.appendChild(r),()=>{i.contains(r)&&i.removeChild(r)}},[e,t]),m.jsx("div",{className:Wv.container,ref:n,role:"presentation","aria-label":"3D Canvas"})};class $v extends De{constructor(){super();c(this,"wrapperElm");c(this,"canvas");c(this,"canvasCtx");c(this,"viewRangeFrame");c(this,"viewPort");c(this,"viewPortRange");c(this,"musicBuffer");c(this,"resizeObserver");c(this,"frameSetting");c(this,"framePlay");this.wrapperElm=null,this.canvas=document.createElement("canvas"),this.canvasCtx=this.canvas.getContext("2d"),this.viewPort=[0,0,0,0],this.viewPortRange=[0,0];const n=window.localStorage.getItem("audioViweRange");this.viewRangeFrame=n?Number(n):2,this.frameSetting={duration:0,fps:60},this.framePlay={current:0,playing:!1},this.musicBuffer=null,this.resizeObserver=new ResizeObserver(this.onResize.bind(this))}onResize(){if(this.wrapperElm){const n=new M(this.wrapperElm.clientWidth,this.wrapperElm.clientHeight);this.canvas.width=n.x,this.canvas.height=n.y}this.render()}render(){if(this.canvasCtx.fillStyle="#000",this.canvasCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.musicBuffer){this.canvasCtx.strokeStyle="#888",this.canvasCtx.fillStyle="#888";const n=this.musicBuffer.getChannelData(0),i=1,r=this.viewPortRange[0]/this.frameSetting.fps,s=this.musicBuffer.sampleRate*r,o=s/this.canvas.width,a=this.frameToPx(0);this.canvasCtx.beginPath();for(let l=0;l<s;l+=o){const u=Math.floor(l-a*o),d=n[Math.round(u)]*i,h=l/s*this.canvas.width,f=(d+1)*(this.canvas.height/2);let v=f,x=f;for(let z=0;z<16;z++){const p=(n[Math.round(u+o*(z/16))]*i+1)*(this.canvas.height/2);v>p&&(v=p),x<p&&(x=p)}const _=x-v;_>3&&this.canvasCtx.fillRect(h,v,1,_),l==0?this.canvasCtx.moveTo(h,f):this.canvasCtx.lineTo(h,f)}this.canvasCtx.stroke()}this.canvasCtx.fillStyle="#555",this.canvasCtx.fillRect(this.canvas.width/2,0,1,this.canvas.height)}setWrapperElm(n){this.wrapperElm&&this.resizeObserver.observe(this.wrapperElm),this.wrapperElm=n,this.resizeObserver.observe(n),this.wrapperElm.appendChild(this.canvas),this.onResize()}setFramePlaying(n){this.framePlay=n,this.viewPort=[this.framePlay.current-this.viewRangeFrame,0,this.framePlay.current+this.viewRangeFrame,0],this.viewPortRange=[this.viewPort[2]-this.viewPort[0],this.viewPort[3]-this.viewPort[1]],this.render()}setViewRangeFrame(n){this.viewRangeFrame=n,this.setFramePlaying(this.framePlay),localStorage.setItem("audioViweRange",String(this.viewRangeFrame))}setFrameSetting(n){this.frameSetting=n,this.render()}setMusicBuffer(n){this.musicBuffer=n,this.render()}frameToPx(n){return(n-this.viewPort[0])/this.viewPortRange[0]*this.canvas.width}dispose(){this.wrapperElm&&this.wrapperElm.removeChild(this.canvas),this.resizeObserver.disconnect()}}const Xv="_audioView_1iv4u_45",Kv={audioView:Xv},Yv=()=>{const{editor:e}=Mt(),t=S.useRef(null),[n,i]=S.useState();S.useEffect(()=>{const f=new $v;if(i(f),t.current)return f.setWrapperElm(t.current),()=>{f.dispose()}},[]);const r=e&&e.audioBuffer,[s,o]=S.useState(),[a,l]=S.useState({duration:0,fps:0}),[u,d]=S.useState({current:0,playing:!1});S.useEffect(()=>{if(!e)return;const f=e.engine,v=g=>{l({duration:g["timeline/duration"],fps:g["timeline/fps"]})};let x=0;const _=()=>{o(x++)},z=g=>{d({...g})};return v(f.serialize()),z(f.frame),f.on("fields/update",v),f.on("update/frame/play",z),f.on("update/audioBuffer",_),()=>{f.off("update/frame/setting",v),f.off("update/frame/play",z),f.off("update/audioBuffer",_)}},[e]),S.useEffect(()=>{n&&r&&n.setMusicBuffer(r)},[n,r,s]),S.useEffect(()=>{n&&u&&n.setFramePlaying(u)},[n,u]),S.useEffect(()=>{n&&a&&n.setFrameSetting(a)},[n,a]);const h=S.useCallback(f=>{if(n){const v=f.deltaY>0?1.1:.9;n.setViewRangeFrame(n.viewRangeFrame*v)}f.preventDefault()},[n]);return S.useEffect(()=>{const f=t.current;return f&&f.addEventListener("wheel",h,{passive:!1}),()=>{f&&f.removeEventListener("wheel",h)}},[h]),m.jsx("div",{className:Kv.audioView,ref:t})},Qv="_screen_18s1v_45",Zv="_header_18s1v_53",qv="_header_right_18s1v_68",Jv="_header_item_18s1v_74",e0="_content_18s1v_82",t0="_canvas_18s1v_90",n0="_audioView_18s1v_94",i0="_externalBtn_18s1v_103",nt={screen:Qv,header:Zv,header_right:qv,header_item:Jv,content:e0,canvas:t0,audioView:n0,externalBtn:i0},El=()=>{const{editor:e}=Mt(),[t,n]=ce(e,"enableRender"),[i,r]=ce(e,"viewType"),[s,o]=ce(e,"resolutionScale"),[a,l]=ce(e,"showWireframe");return m.jsxs("div",{className:nt.screen,children:[m.jsx("div",{className:nt.header,children:m.jsxs("div",{className:nt.header_right,children:[m.jsx("div",{className:nt.header_item,children:m.jsx(Ke,{title:"Render",children:m.jsx(at,{value:t,onChange:u=>{n&&n(u)}})})}),m.jsx("div",{className:nt.header_item,children:m.jsx(Ke,{title:"View",children:m.jsx(at,{value:i,format:{type:"select",list:["render","debug"]},onChange:u=>{r&&r(u)}})})}),m.jsx("div",{className:nt.header_item,children:m.jsx(Ke,{title:"Resolution",children:m.jsx(at,{value:s,format:{type:"select",list:new Array(6).fill(0).map((u,d)=>{const h=Math.pow(2,d),f=1/h,v=f==1?"1":"1/"+h;return{value:f,label:v}})},onChange:u=>{o&&o(u)}})})}),m.jsx("div",{className:nt.header_item,children:m.jsx(Ke,{title:"Wireframe",children:m.jsx(at,{value:a,onChange:u=>{l&&l(u)}})})}),m.jsx("div",{className:nt.externalBtn,children:m.jsx(fn,{onClick:()=>{e.openInExternalWindow()},children:m.jsxs("svg",{width:"32",height:"12",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsxs("g",{clipPath:"url(#clip0_224_2)",children:[m.jsx("path",{d:"M96 0V416H512V0H96ZM472 376H136V40H472V376Z",fill:"#aaa"}),m.jsx("path",{d:"M40 472V296V136V96H0V512H416V472H376H40Z",fill:"#aaa"}),m.jsx("path",{d:"M232.812 312.829L350.671 194.969V279.766H390.671V126.688H237.594V166.688H322.39L204.531 284.547L232.812 312.829Z",fill:"#aaa"})]}),m.jsx("defs",{children:m.jsx("clipPath",{id:"clip0_224_2",children:m.jsx("rect",{width:"512",height:"512",fill:"white"})})})]})})})]})}),m.jsxs("div",{className:nt.content,children:[m.jsx("div",{className:nt.canvas,children:m.jsx(Hv,{})}),m.jsx("div",{className:nt.audioView,children:m.jsx(Yv,{})})]})]})},mc=S.createContext(null),r0=()=>{const{editor:e}=Mt(),[t,n]=S.useState({current:0,playing:!1}),[i]=ce(e==null?void 0:e.engine,"timeline/duration"),[r,s]=S.useState([0,0,100,0]),o=S.useRef([0,0,0,0]);o.current=r;const a=r[2]-r[0];let l=10*Math.pow(2,0+Math.floor(Math.log2(a/100)));l=Math.max(1,Math.floor(l));const u=e==null?void 0:e.audioBuffer,[d,h]=S.useState();S.useEffect(()=>{i!==void 0&&s([0,0,i,0])},[i]),S.useEffect(()=>{if(e){const g=e.engine,p=E=>{n({...E})};p(g.frame);let y=0;const w=()=>{h(y++)};return g.on("update/frame/play",p),g.on("update/audioBuffer",w),()=>{g.off("update/frame/play",p),g.off("update/audioBuffer",w)}}},[e]);const f=S.useCallback(g=>{e&&e.engine.seek(g)},[e]),v=S.useCallback(g=>{const p=r[2]-r[0];return Math.floor(r[0]+p*g)},[r]),x=S.useCallback(g=>{const p=o.current,y=(p[2]+p[0])/2,w=(p[0]-y)*g+y,E=(p[2]-y)*g+y;s([w,p[1],E,p[3]])},[]),_=S.useCallback(g=>{const p=o.current,y=g*(p[2]-p[0]);s([p[0]+y,p[1],p[2]+y,p[3]])},[]),z=S.useCallback(g=>{const p=o.current,y=p[2]-p[0];s([g-y/2,p[1],g+y/2,p[3]])},[]);return{glEditor:e,framePlay:t,viewPort:r,viewPortScale:l,musicBuffer:u,musicBufferVersion:d,setCurrentFrame:f,getFrameViewPort:v,zoom:x,scroll:_,setViewPortCenter:z}},s0="_timeline_4ojix_45",o0="_inner_4ojix_50",a0="_content_4ojix_62",l0="_setting_4ojix_70",lr={timeline:s0,inner:o0,content:a0,setting:l0},ni=()=>{const e=S.useContext(mc);if(e===null)throw new Error("useTimeline must be used within a TimelineProvider");return e},u0="_timelineCanvas_12pgc_45",c0={timelineCanvas:u0},d0=`// @shader-file: packages/orengine/components/panels/Timeline/TimelineCanvas/TimelineCanvasRenderer/shaders/timeline.fs
#include<common>
uniform sampler2D uCanvasTex,uMusicTex;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){outColor=vec4(texture(uCanvasTex,vUv).xyz+step(vUv.y,texture(uMusicTex,vUv).x)*.2,1);}`;class f0 extends De{constructor(){super();c(this,"wrapperElm");c(this,"glCanvas");c(this,"gl");c(this,"canvasTexture");c(this,"canvas");c(this,"canvasCtx");c(this,"glRenderer");c(this,"postProcess");c(this,"viewPort");c(this,"viewPortRange");c(this,"viewPortScale");c(this,"frameSetting");c(this,"loopSetting");c(this,"musicBuffer");c(this,"musicTexture");c(this,"resizeObserver");c(this,"canvasSize");this.wrapperElm=null,this.canvas=document.createElement("canvas"),this.canvasCtx=this.canvas.getContext("2d"),this.glCanvas=document.createElement("canvas");const n=new oc(this.glCanvas.getContext("webgl2"));this.gl=n.gl,this.canvasSize=new M(this.glCanvas.width,this.glCanvas.height),this.viewPort=[0,0,0,0],this.viewPortRange=[0,0],this.viewPortScale=50,this.frameSetting=null,this.loopSetting={enabled:!1,start:0,end:0},this.resizeObserver=new ResizeObserver(this.onResize.bind(this)),this.glRenderer=new uc(this.gl),this.canvasTexture=new W(this.gl),this.musicBuffer=null,this.musicTexture=new W(this.gl),this.musicTexture.setting({type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.LUMINANCE,format:this.gl.LUMINANCE,magFilter:this.gl.LINEAR,minFilter:this.gl.LINEAR,wrapS:this.gl.MIRRORED_REPEAT}),this.postProcess=new et({passes:[new Q(this.gl,{frag:d0,uniforms:{uCanvasTex:{type:"1i",value:null},uMusicTex:{type:"1i",value:this.musicTexture}},renderTarget:null})]})}onResize(){if(this.wrapperElm){const n=new M(this.wrapperElm.clientWidth,this.wrapperElm.clientHeight);this.glCanvas.width=this.canvas.width=n.x,this.glCanvas.height=this.canvas.height=n.y,this.canvasSize.set(this.glCanvas.width,this.glCanvas.height),this.postProcess.resize(n)}this.render()}render(){if(this.canvasCtx.fillStyle="#000",this.canvasCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.frameSetting){this.canvasCtx.fillStyle="#181818";const i=this.frameToPx(0),r=this.frameToPx(this.frameSetting.duration);this.canvasCtx.fillRect(i,0,r-i,this.canvas.height)}const n=(i,r,s)=>{let o=Math.ceil(this.viewPort[0]/i)*i;this.canvasCtx.beginPath();let a=0;for(;o<this.viewPort[2]&&a<100;){const l=this.frameToPx(o+r);this.canvasCtx.moveTo(l,0),this.canvasCtx.lineTo(l,this.canvas.height),o+=i,a++}this.canvasCtx.strokeStyle=s,this.canvasCtx.lineWidth=1,this.canvasCtx.stroke()};if(n(this.viewPortScale,0,"#555"),n(this.viewPortScale,this.viewPortScale/2,"#333"),this.musicBuffer&&this.frameSetting){this.canvasCtx.strokeStyle="#888",this.canvasCtx.fillStyle="#888";const i=this.musicBuffer.getChannelData(0),r=this.viewPortRange[0]/this.frameSetting.fps,s=this.musicBuffer.sampleRate*r,o=s/this.canvas.width,a=this.frameToPx(0);this.canvasCtx.beginPath();for(let l=0;l<s;l+=o){const u=Math.floor(l-a*o),d=i[Math.round(u)],h=l/s*this.canvas.width,f=(d+1)*(this.canvas.height/2);let v=f,x=f;for(let z=0;z<16;z++){const p=(i[Math.round(u+o*(z/16))]+1)*(this.canvas.height/2);v>p&&(v=p),x<p&&(x=p)}const _=x-v;_>3&&this.canvasCtx.fillRect(h,v,1,_),l==0?this.canvasCtx.moveTo(h,f):this.canvasCtx.lineTo(h,f)}this.canvasCtx.stroke()}if(this.loopSetting.enabled){this.canvasCtx.fillStyle="#0009";const i=this.frameToPx(this.loopSetting.start),r=this.frameToPx(this.loopSetting.end);this.canvasCtx.fillRect(0,0,i,this.canvas.height),this.canvasCtx.fillRect(r,0,this.canvas.width-r,this.canvas.height)}this.canvasTexture.attach(this.canvas),this.postProcess.passes&&(this.postProcess.passes[0].uniforms.uCanvasTex.value=this.canvasTexture),this.glRenderer.renderPostProcess(this.postProcess,void 0,this.canvasSize)}setWrapperElm(n){this.wrapperElm&&this.resizeObserver.observe(this.wrapperElm),this.wrapperElm=n,this.resizeObserver.observe(n),this.wrapperElm.appendChild(this.glCanvas),this.onResize()}setViewPort(n,i){this.viewPort=n,this.viewPortRange=[n[2]-n[0],n[3]-n[1]],this.viewPortScale=i,this.render()}setFrameSetting(n){this.frameSetting={duration:Math.round(n.duration),fps:Math.round(n.fps)},this.render()}setMusicBuffer(n){this.musicBuffer=n,setTimeout(()=>{this.render()},100)}setLoopSetting(n,i,r){this.loopSetting={enabled:n,start:i,end:r},this.render()}frameToPx(n){return(n-this.viewPort[0])/this.viewPortRange[0]*this.canvas.width}dispose(){this.wrapperElm&&this.wrapperElm.removeChild(this.glCanvas),this.resizeObserver.disconnect()}}const h0=()=>{const{viewPort:e,viewPortScale:t,musicBuffer:n,musicBufferVersion:i,glEditor:r}=ni(),[s,o]=S.useState(),a=S.useRef(null);S.useEffect(()=>{const v=new f0;return o(v),a.current&&v.setWrapperElm(a.current),()=>{v.dispose()}},[]),S.useEffect(()=>{s&&e&&t&&s.setViewPort(e,t)},[s,e,t]);const[l]=ce(r==null?void 0:r.engine,"timeline/duration"),[u]=ce(r==null?void 0:r.engine,"timeline/fps");S.useEffect(()=>{s&&l&&u&&s.setFrameSetting({duration:l||0,fps:u||0})},[s,l,u]);const[d]=ce(r,"frameLoop/enabled"),[h]=ce(r,"frameLoop/start"),[f]=ce(r,"frameLoop/end");return S.useEffect(()=>{s&&s.setLoopSetting(d||!1,h||0,f||0)},[s,d,h,f]),S.useEffect(()=>{s&&n&&s.setMusicBuffer(n)},[s,n,i]),m.jsx("div",{className:c0.timelineCanvas,ref:a})},m0="_controls_n8ed2_45",p0={controls:m0},v0=e=>{const{viewPort:t,setCurrentFrame:n,getFrameViewPort:i,zoom:r,scroll:s,setViewPortCenter:o}=ni(),a=S.useRef([0,0,0,0]),l=S.useRef([0,0]);t&&(a.current=t,l.current=[t[2]-t[0],t[3]-t[1]]);const u=S.useRef(null),d=S.useRef(null),h=S.useRef(null),f=S.useRef(null),v=S.useRef(null),x=S.useRef(!1),_=S.useCallback(C=>{const T=u.current&&u.current.clientWidth||1;if(h.current==0&&!x.current){if(n&&i&&d.current){const F=(C.clientX-d.current.left)/T;n(i(F))}}else if(h.current==1){const F=[C.clientX,C.clientY];if(f.current&&v.current){const D=-(F[0]-f.current[0])/T*l.current[0];o&&o(v.current+D)}}},[n,i,o]),z=S.useCallback(C=>{h.current=C.button,v.current=(a.current[2]+a.current[0])/2,f.current=[C.clientX,C.clientY],d.current=C.currentTarget.getBoundingClientRect();const T=(C.clientX-d.current.left)/C.currentTarget.clientWidth;h.current==0&&n&&i&&!x.current&&n(i(T)),window.addEventListener("pointermove",_);const F=()=>{f.current=null,h.current=null,v.current=null,window.removeEventListener("pointermove",_)};return window.addEventListener("pointerup",F),()=>{window.removeEventListener("pointerup",F),window.removeEventListener("pointermove",_)}},[i,n,_]),g=S.useCallback(C=>{if(h.current!==null||!r||!s)return;C.preventDefault();const T=C.target&&C.target.clientWidth||1,F=Math.abs(C.deltaY);Math.abs(C.deltaX)<F?F>50?r(C.deltaY<0?.9:1.1):r(1+C.deltaY*.005):s(C.deltaX/T*.5)},[r,s]),p=S.useRef(null),y=S.useRef(null),w=S.useCallback(C=>{if(C.touches.length===2){x.current=!0;const T=C.touches[0],F=C.touches[1],D=F.clientX-T.clientX,L=F.clientY-T.clientY;p.current=Math.sqrt(D*D+L*L),y.current=(T.clientX+F.clientX)/2}},[]),E=S.useCallback(C=>{var T;if(C.touches.length===2&&p.current!==null&&y.current!==null){C.preventDefault();const F=C.touches[0],D=C.touches[1],L=D.clientX-F.clientX,V=D.clientY-F.clientY,me=Math.sqrt(L*L+V*V),H=(F.clientX+D.clientX)/2,Ce=Math.abs(me-p.current),tt=Math.abs(H-y.current);if(Ce>tt){if(r){const Le=me/p.current;r(2-Le)}}else if(s){const Le=((T=u.current)==null?void 0:T.clientWidth)||1,N=-(H-y.current)/Le*.5;s(N)}p.current=me,y.current=H}},[r,s]),k=S.useCallback(()=>{x.current=!1,p.current=null,y.current=null},[]);return S.useEffect(()=>{const C=u.current;return C&&(C.addEventListener("wheel",g,{passive:!1}),C.addEventListener("touchstart",w,{passive:!1}),C.addEventListener("touchmove",E,{passive:!1}),C.addEventListener("touchend",k)),()=>{C&&(C.removeEventListener("wheel",g),C.removeEventListener("touchstart",w),C.removeEventListener("touchmove",E),C.removeEventListener("touchend",k))}},[g,w,E,k]),t?m.jsx("div",{className:p0.controls,onPointerDown:z,ref:u,children:e.children}):null},g0="_cursor_2b6c4_45",y0="_frame_2b6c4_57",Tl={cursor:g0,frame:y0},x0=()=>{const{viewPort:e,framePlay:t}=ni();if(!e||!t)return null;const n=e[2]-e[0],i=(t.current-e[0])/n;return m.jsx("div",{className:Tl.cursor,style:{left:i*100+"%"},children:m.jsx("div",{className:Tl.frame})})},_0="_timelineLoop_ly75p_45",w0="_start_ly75p_54",S0="_end_ly75p_55",ur={timelineLoop:_0,start:w0,end:S0},C0="_cursor_1r72h_45",E0={cursor:C0},zl=({onMove:e})=>{const t=S.useRef(!1);return m.jsx("div",{className:E0.cursor,onPointerDown:n=>{n.buttons==1&&(t.current=!0,n.stopPropagation())},onPointerMove:n=>{const i=n.target;t.current===!1||n.buttons!=1||(i.setPointerCapture(n.pointerId),n.buttons==1&&e&&e(n.clientX),n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation())},onPointerUp:()=>{t.current=!1}})},T0=()=>{const{viewPort:e,framePlay:t,glEditor:n}=ni(),i=S.useRef(null);_a(n,["frameLoop/enabled","frameLoop/start","frameLoop/end"]);const[r]=ce(n,"frameLoop/enabled"),[s,o]=ce(n,"frameLoop/start"),[a,l]=ce(n,"frameLoop/end");if(r!==!0||!e||!t||s===void 0||a===void 0)return null;const u=e[2]-e[0],d=(s-e[0])/u,h=(a-e[0])/u,f=(v,x)=>{const _=v.getBoundingClientRect();return(x-_.x)/_.width*(e[2]-e[0])+e[0]};return m.jsx("div",{className:ur.timelineLoop,ref:i,children:m.jsxs("div",{className:ur.timelineLoop_inner,children:[m.jsx("div",{className:ur.start,style:{left:d*100+"%"},children:m.jsx(zl,{onMove:v=>{i.current&&o&&o(f(i.current,v))}})}),m.jsx("div",{className:ur.end,style:{left:h*100+"%"},children:m.jsx(zl,{onMove:v=>{i.current&&l&&l(f(i.current,v))}})})]})})},z0="_scale_dsq5l_45",P0="_scale_inner_dsq5l_53",k0="_scale_item_dsq5l_58",M0="_scale_item_frame_dsq5l_66",R0="_scale_item_time_dsq5l_71",ci={scale:z0,scale_inner:P0,scale_item:k0,scale_item_frame:M0,scale_item_time:R0},D0=e=>{const t=("00"+Math.floor(e%3600/60)).slice(-2),n=("00"+Math.floor(e%60)).slice(-2);return`${t}:${n}`},F0=()=>{const{glEditor:e,viewPort:t,viewPortScale:n}=ni(),[i,r]=ce(e==null?void 0:e.engine,"timeline/fps");if(!t||!n||i===void 0)return null;const s=[];let o=Math.ceil(t[0]/n)*n,a=0;for(;o<t[2]&&a<100;){const l=(o-t[0])/(t[2]-t[0]),u=o/(i||0);s.push(m.jsxs("div",{className:ci.scale_item,style:{left:l*100+"%"},children:[m.jsx("div",{className:ci.scale_item_frame,children:o}),m.jsx("div",{className:ci.scale_item_time,children:D0(u)})]},o)),o+=n,a++}return m.jsx("div",{className:ci.scale,children:m.jsx("div",{className:ci.scale_inner,children:s})})},N0=()=>m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("rect",{x:"5",y:"3",width:"3",height:"14",fill:"#D9D9D9"}),m.jsx("rect",{x:"12",y:"3",width:"3",height:"14",fill:"#D9D9D9"})]}),I0=()=>m.jsx("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:m.jsx("path",{d:"M5 3L5 17L16 10L5 3Z",fill:"#D9D9D9"})}),B0="_timelineSetting_1yk20_45",A0="_playControls_1yk20_58",Pl={timelineSetting:B0,playControls:A0},b0=()=>{const{framePlay:e,glEditor:t}=ni(),n=S.useCallback((d,h)=>{h&&h(d)},[]),[i,r]=ce(t,"frameLoop/enabled"),[s,o]=ce(t==null?void 0:t.engine,"timeline/duration"),[a,l]=ce(t==null?void 0:t.engine,"timeline/fps"),u=S.useCallback(()=>{t!=null&&t.engine&&(e.playing?t.engine.stop():t.engine.play())},[t,e.playing]);return m.jsx("div",{className:Pl.timelineSetting,children:m.jsxs(Ue,{children:[m.jsx("div",{className:Pl.playControls,children:m.jsx(fn,{onClick:u,children:e.playing?m.jsx(N0,{}):m.jsx(I0,{})})}),m.jsx(Ke,{title:"current",children:m.jsx(at,{value:Math.floor((e==null?void 0:e.current)||0),readOnly:!0})}),m.jsx(Ke,{title:"duration",children:m.jsx(at,{value:s,onChange:d=>n(d,o)})}),m.jsx(Ke,{title:"fps",children:m.jsx(at,{value:a,onChange:d=>n(d,l)})}),m.jsx(Ke,{title:"loop",children:m.jsx(at,{value:i||!1,onChange:d=>n(d,r)})})]})})},kl=()=>{const e=r0();return m.jsx(mc.Provider,{value:e,children:m.jsx("div",{className:lr.timeline,children:m.jsxs("div",{className:lr.inner,children:[m.jsx("div",{className:lr.setting,children:m.jsx(b0,{})}),m.jsxs("div",{className:lr.content,children:[m.jsx(h0,{}),m.jsx(x0,{}),m.jsx(v0,{children:m.jsx(T0,{})}),m.jsx(F0,{})]})]})})})},cr=768,L0=()=>{const[e,t]=S.useState(()=>typeof window<"u"?window.innerWidth<=cr:!1);return S.useEffect(()=>{let n=null;const i=()=>{const r=window.innerWidth;(n===null||(r-cr)*(n-cr)<=0)&&t(r<=cr),n=r};return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[]),{isPC:!e,isSP:e}},U0=`// @shader-file: packages/orengine/features/OREngine/core/FrameDebugger/shaders/frameDebugger.fs
#include<common>
uniform sampler2D uBackBuffer0,uCanvas;layout(location=0)out vec4 outColor;in vec2 vUv;void main(){vec4 u=texture(uBackBuffer0,vUv),r=texture(uCanvas,vUv);outColor.xyz=mix(u.xyz,1.-u.xyz,r.xyz*r.w);outColor.w=1.;}`;class j0 extends De{constructor(n){super();c(this,"_engine");c(this,"_gl");c(this,"_srcFrameBuffer");c(this,"_outFrameBuffer");c(this,"_frameList");c(this,"_enable");c(this,"_resolution");c(this,"_count");c(this,"_total");c(this,"_tile");c(this,"_tilePixelSize");c(this,"_tileInv");c(this,"_focus");c(this,"_uniforms");c(this,"_outPostProcess");c(this,"_elm");c(this,"_labelCanvas");c(this,"_cctx");c(this,"_canvasTexture");this._engine=n,this._gl=n.gl,this._elm=n.canvas,this._srcFrameBuffer=new Z(this._gl,{disableDepthBuffer:!0}),this._outFrameBuffer=new Z(this._gl,{disableDepthBuffer:!0}).setTexture([new W(this._gl).setting()]),this._enable=!1,this._count=0,this._total=1,this._tile=new M(1,1),this._tilePixelSize=new M(1,1),this._tileInv=new M(1,1),this._focus=null,this._resolution=new M,this._labelCanvas=document.createElement("canvas"),this._cctx=this._labelCanvas.getContext("2d"),this._canvasTexture=new W(this._gl).attach(this._labelCanvas),this._uniforms={uCanvas:{value:this._canvasTexture,type:"1i"}},this._outPostProcess=new et({passes:[new Q(this._gl,{uniforms:this._uniforms,renderTarget:null,frag:U0,backBufferOverride:this._outFrameBuffer.textures})]}),this._frameList=[];const i=new M(0,0),r=this._onClick.bind(this),s=l=>{i.set(l.clientX,l.clientY)},o=l=>{const u=new M(l.clientX,l.clientY);i.clone().sub(u).length()<10&&r(l)};this._elm.addEventListener("pointerdown",s),this._elm.addEventListener("pointerup",o);const a=l=>{l.key==="Escape"&&(this._focus=null,this._clear()),l.key=="ArrowRight"&&this._focus!==null&&this._focus++,l.key=="ArrowLeft"&&this._focus!==null&&this._focus--};window.addEventListener("keydown",a),this.once("dispose",()=>{this._elm.removeEventListener("pointerdown",s),this._elm.removeEventListener("pointerup",o),window.removeEventListener("keydown",a)})}_calcTilePos(n){const i=n%this._tile.x*this._tileInv.x*this._resolution.x,r=Math.floor(n/this._tile.x)*this._tileInv.y*this._resolution.y;return{x:i,y:r}}push(n,i){for(let r=0;r<n.textures.length;r++){if(this._focus==null||this._focus==this._count){const s=n.textures[r],o="currentFace"in n?n.currentFace:this._gl.TEXTURE_2D;this._srcFrameBuffer.setSize(s.size),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._srcFrameBuffer.getFrameBuffer()),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,o,s.getTexture(),0),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.bindFramebuffer(this._gl.READ_FRAMEBUFFER,this._srcFrameBuffer.getFrameBuffer()),this._gl.bindFramebuffer(this._gl.DRAW_FRAMEBUFFER,this._outFrameBuffer.getFrameBuffer());let{x:a,y:l}=this._calcTilePos(this._count);const u=this._tilePixelSize.x,d=this._tilePixelSize.y;this._focus!==null&&(a=0,l=0),this._gl.blitFramebuffer(0,0,n.size.x,n.size.y,a,this._resolution.y-l-d,a+u,this._resolution.y-l,this._gl.COLOR_BUFFER_BIT,this._gl.NEAREST),this._srcFrameBuffer.setTexture([]),this._frameList.push({frameBuffer:n,texture:s,label:i?i+(n.textures.length>1?"_"+r:""):""})}this._count++}this._gl.bindFramebuffer(this._gl.READ_FRAMEBUFFER,null),this._gl.bindFramebuffer(this._gl.DRAW_FRAMEBUFFER,null)}draw(){this._cctx.clearRect(0,0,this._resolution.x,this._resolution.y);const n=this._resolution.y/1080;this._cctx.font=`500 ${28*n}px 'Courier New'`,this._cctx.fillStyle="#fff";for(let i=0;i<this._frameList.length;i++){const{x:r,y:s}=this._calcTilePos(i),o=this._frameList[i];this._cctx.fillText(o.label,r+5*n,s+this._tilePixelSize.y-5*n)}this._canvasTexture.attach(this._labelCanvas),this._engine.renderer.renderPostProcess(this._outPostProcess,void 0,this._resolution),this._clear()}_clear(){this._total=this._count;const n=Math.sqrt(this._focus!==null?1:this._total);this._tile.set(Math.round(n),Math.ceil(n)),this._tileInv.set(1,1).divide(this._tile),this._tilePixelSize.copy(this._tileInv).multiply(this._resolution),this._frameList=[],this._count=0}reflesh(){this.resize(this._resolution)}resize(n){this._resolution.copy(n),this._outFrameBuffer.setSize(n),this._outPostProcess.resize(n),this._labelCanvas.width=n.x,this._labelCanvas.height=n.y,this._canvasTexture.attach(this._labelCanvas)}_onClick(n){if(this._enable&&(this.reflesh(),this._focus===null)){const i=this._elm.getBoundingClientRect(),r=this._elm.width/this._elm.height,s=i.width/i.height;let o=i.width,a=i.height,l=0,u=0;r>s?(a=i.width/r,u=(i.height-a)/2):(o=i.height*r,l=(i.width-o)/2);const d=n.offsetX-l,h=n.offsetY-u;if(d<0||d>o||h<0||h>a)return;const f=new M(o/this._tile.x,a/this._tile.y),v=Math.floor(d/f.x),x=Math.floor(h/f.y);this._focus=v+x*this._tile.x}}set enable(n){this._enable=n,n&&this.reflesh()}get enable(){return this._enable}dispose(){this.emit("dispose")}}class O0 extends De{constructor(){super();c(this,"_pressedKeys");this._pressedKeys={};const n=this._onKeyDown.bind(this),i=this._onKeyUp.bind(this);window.addEventListener("keydown",n),window.addEventListener("keyup",i);const r=()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",i)};this.once("dispose",r)}get pressedKeys(){return this._pressedKeys}_onKeyDown(n){this._pressedKeys[n.key]=!0,this.emit("keydown",[n,this._pressedKeys])}_onKeyUp(n){if(this._pressedKeys[n.key]=!1,n.key=="Meta"||n.key=="Control"){const i=Object.keys(this._pressedKeys);for(let r=0;r<i.length;r++)this._pressedKeys[i[r]]=!1}this.emit("keyup",[n,this._pressedKeys])}dispose(){this.emit("dispose")}}const V0=new M(1920,840),G0=document.createElement("canvas"),O=G0.getContext("webgl2",{antialias:!1}),W0=new oc(O),R={time:{uTime:{value:0,type:"1f"},uTimeF:{value:0,type:"1f"},uTimeE:{value:0,type:"1f"},uTimeEF:{value:0,type:"1f"}},resolution:{uAspectRatio:{value:1,type:"1f"},uResolution:{value:new M,type:"2f"}},camera:{projectionMatrix:{value:new K,type:"Matrix4fv"},viewMatrix:{value:new K,type:"Matrix4fv"}},gBuffer:{uGBufferPos:{value:null,type:"1i"},uGBufferNormal:{value:null,type:"1i"}},tex:{},music:{uMusicFreqTex:{value:null,type:"1i"},uMusicDomainTex:{value:null,type:"1i"}}};class Ml extends ei{constructor(n){super();c(this,"_engine");c(this,"_keyBoard");c(this,"_selectedEntityId");c(this,"_frameLoop");c(this,"_resolutionScale");c(this,"_viewType");c(this,"_frameDebugger");c(this,"_externalWindow");c(this,"_externalCanvasBitmapContext");c(this,"_scenePointer");c(this,"_disposed");this._engine=n,this._viewType="render",this._selectedEntityId=null,this._resolutionScale=1,this._externalWindow=null,this._externalCanvasBitmapContext=null,this._disposed=!1,this._keyBoard=new O0,this._keyBoard.on("keydown",(r,s)=>{(s.Meta||s.Control)&&s.s&&(r.preventDefault(),this.save()),r.key==" "&&(this._engine.frame.playing?this._engine.stop():this._engine.play())}),this._frameDebugger=new j0(n),this.engine.renderer.on("drawPass",(r,s)=>{this._frameDebugger&&this._frameDebugger.enable&&r&&this._frameDebugger.push(r,s)}),n.on("update/blidge/selection",r=>{this.selectEntity(r)}),this._frameLoop={enabled:!1,start:0,end:0},this.field("enableRender",()=>this._engine.enableRender,r=>this._engine.enableRender=r),this.field("resolutionScale",()=>this._resolutionScale,r=>{this._resolutionScale=Number(r),this._resize()}),this.field("viewType",()=>this._viewType,r=>{this._viewType=r,this._viewType==="debug"?this._frameDebugger.enable=!0:this._frameDebugger.enable=!1});const i=this.fieldDir("frameLoop");i.field("enabled",()=>this._frameLoop.enabled,r=>this._frameLoop.enabled=r),i.field("start",()=>this._frameLoop.start,r=>this._frameLoop.start=r),i.field("end",()=>this._frameLoop.end,r=>this._frameLoop.end=r),this.field("timelineCurrent",()=>this.engine.frame.current,r=>{this.engine.seek(r)}),this.field("selectedEntityId",()=>this._selectedEntityId,r=>{this._selectedEntityId=r}),this._animate()}get engine(){return this._engine}get audioBuffer(){return this._engine.audioBuffer}get disposed(){return this._disposed}_animate(){if(!this._disposed){if(this._engine.update(),this._externalCanvasBitmapContext){const n=this._externalCanvasBitmapContext;createImageBitmap(this.engine.canvas).then(i=>{n.transferFromImageBitmap(i)})}this._engine.frame.playing&&((this._engine.frame.current<0||this._engine.frame.current>this._engine.frameSetting.duration)&&this._engine.seek(0),this._frameLoop.enabled&&(this._engine.frame.current<this._frameLoop.start||this._engine.frame.current>this._frameLoop.end)&&this._engine.seek(this._frameLoop.start)),this._frameDebugger&&this._frameDebugger.enable&&this._frameDebugger.draw(),window.requestAnimationFrame(this._animate.bind(this))}}selectEntity(n){this.setField("selectedEntityId",n?n.uuid:null)}createEntity(n,i){const r=new oe;return r.name=i,r.initiator="user",n.add(r),r}deleteEntity(n){n.disposeRecursive();const i=n.parent;i&&i.remove(n)}save(){this.emit("save",[this.exportEngine(),this.exportEditor()])}exportEditor(){return this.serialize({mode:"export"})}exportEngine(){return this._engine.serialize({mode:"export"})}openInExternalWindow(){if(this._externalWindow=window.open("","_blank"),!this._externalWindow)return;const n=this._externalWindow.document.createElement("canvas");n.style.width="100%",n.style.height="100%",n.style.objectFit="contain",n.style.cursor="none",this._externalWindow.document.body.style.margin="0",this._externalWindow.document.body.style.background="#000",this._externalWindow.document.body.appendChild(n),this._externalCanvasBitmapContext=n.getContext("bitmaprenderer"),this._externalWindow.addEventListener("unload",()=>{this.closeExternalWindow()}),this._resize()}closeExternalWindow(){this._externalWindow&&(this._externalWindow.close(),this._externalWindow=null,this._externalCanvasBitmapContext=null)}_resize(){const n=V0.clone().multiply(this._resolutionScale);this.engine.setSize(n),this._frameDebugger.resize(n),this._externalCanvasBitmapContext&&(this._externalCanvasBitmapContext.canvas.width=n.x,this._externalCanvasBitmapContext.canvas.height=n.y)}dispose(){this._disposed=!0,this._keyBoard.dispose(),this._frameDebugger.dispose()}}const H0=()=>{const{engine:e}=fc(),[t,n]=S.useState(()=>new Ml(e)),i=Gr.useRef(t);return i.current=t,S.useEffect(()=>{if(!i.current.disposed&&i.current.engine.uuid==e.uuid)return;const r=new Ml(e);n(r)},[e]),S.useEffect(()=>()=>{t.dispose()},[t]),{engine:e,editor:t}},$0="_editor_16tun_45",X0="_vert_16tun_51",K0="_horiz_16tun_58",Y0="_flex_16tun_62",Q0={editor:$0,vert:X0,horiz:K0,flex:Y0},Z0=e=>{const t=H0(),[n,i]=S.useState(!1);S.useEffect(()=>{if(!(!t.editor||!e.onSave))return t.editor.on("save",e.onSave),()=>{t.editor.off("save",e.onSave)}},[t.editor,e.onSave]),S.useEffect(()=>{!t.editor||!e.editorData||t.editor.deserialize(e.editorData)},[e.editorData,t.editor]),S.useEffect(()=>{},[]);const r=L0(),s=xh();let o=null;return r.isPC?o=m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{direction:"vertical",sizes:[1,"150px"],minSizes:[300,80],storageKey:"orengine-pc-main",children:[m.jsxs(Dt,{direction:"horizontal",sizes:["300px",1,"300px"],minSizes:[200,400,200],storageKey:"orengine-pc-horizontal",children:[m.jsxs(Dt,{direction:"vertical",sizes:[1,"200px"],minSizes:[200,100],storageKey:"orengine-pc-left",children:[m.jsxs(ft,{children:[m.jsx(Ue,{title:"Scene",children:m.jsx(Sl,{})}),m.jsx(Ue,{title:"Project",children:m.jsx(Cl,{})})]}),m.jsx(ft,{children:m.jsx(Ue,{title:"Timer",noPadding:!0,children:m.jsx(_l,{})})})]}),m.jsx(El,{}),n?m.jsxs(Dt,{direction:"vertical",sizes:[1,1],minSizes:[150,150],storageKey:"orengine-pc-right",children:[m.jsx(ft,{children:m.jsx(Ue,{title:"Property",children:m.jsx(ar,{})})}),!1]}):m.jsx(ft,{children:m.jsx(Ue,{title:"Property",children:m.jsx(ar,{})})})]}),m.jsx(ft,{children:m.jsx(Ue,{title:"Timeline",noPadding:!0,children:m.jsx(kl,{})})})]}),m.jsx(pl,{})]}):o=m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{direction:"vertical",sizes:[250,450,300],minSizes:[150,200,100],storageKey:"orengine-tablet-main",children:[m.jsx(El,{}),m.jsxs(Dt,{direction:"horizontal",sizes:[450,1],minSizes:[200,300],storageKey:"orengine-tablet-middle",children:[m.jsxs(Dt,{direction:"vertical",sizes:[1,120],minSizes:[200,80],storageKey:"orengine-tablet-left",children:[m.jsxs(ft,{children:[m.jsx(Ue,{title:"Scene",children:m.jsx(Sl,{})}),m.jsx(Ue,{title:"Project",children:m.jsx(Cl,{})})]}),m.jsx(ft,{children:m.jsx(Ue,{title:"Timer",noPadding:!0,children:m.jsx(_l,{})})})]}),n?m.jsxs(Dt,{direction:"vertical",sizes:[1,1],minSizes:[150,150],storageKey:"orengine-tablet-right",children:[m.jsx(ft,{children:m.jsx(Ue,{title:"Property",children:m.jsx(ar,{})})}),!1]}):m.jsx(ft,{children:m.jsx(Ue,{title:"Property",children:m.jsx(ar,{})})})]}),m.jsx(ft,{children:m.jsx(Ue,{title:"Timeline",noPadding:!0,children:m.jsx(dh,{fallback:m.jsx("div",{children:""}),children:m.jsx(kl,{})})})})]}),m.jsx(pl,{})]}),m.jsx(sc.Provider,{value:t,children:m.jsx(Ju.Provider,{value:s,children:m.jsx("div",{className:Q0.editor,children:o})})})},q0=e=>{const[t,n]=Gr.useState(()=>new re(e)),i=Gr.useRef(t);i.current=t,S.useEffect(()=>{if(!i.current.disposed)return;const s=new re(e);n(s)},[e]),S.useEffect(()=>()=>{t.dispose()},[t]);const r=S.useCallback(s=>{s&&t.load(s)},[t]);return{engine:t,load:r}},J0=e=>{const t=q0(e.gl),{engine:n}=t;return S.useEffect(()=>{n.setSize(new M(1920,1080))},[n]),S.useEffect(()=>{e.project?n.load(e.project):n.init()},[n,e.project]),m.jsx(dc.Provider,{value:t,children:e.children})};var _o={},pc={exports:{}},We={},vc={exports:{}},gc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,U){var j=N.length;N.push(U);e:for(;0<j;){var te=j-1>>>1,fe=N[te];if(0<r(fe,U))N[te]=U,N[j]=fe,j=te;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var U=N[0],j=N.pop();if(j!==U){N[0]=j;e:for(var te=0,fe=N.length,en=fe>>>1;te<en;){var tn=2*(te+1)-1,bs=N[tn],nn=tn+1,ir=N[nn];if(0>r(bs,j))nn<fe&&0>r(ir,bs)?(N[te]=ir,N[nn]=j,te=nn):(N[te]=bs,N[tn]=j,te=tn);else if(nn<fe&&0>r(ir,j))N[te]=ir,N[nn]=j,te=nn;else break e}}return U}function r(N,U){var j=N.sortIndex-U.sortIndex;return j!==0?j:N.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,f=3,v=!1,x=!1,_=!1,z=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(N){for(var U=n(u);U!==null;){if(U.callback===null)i(u);else if(U.startTime<=N)i(u),U.sortIndex=U.expirationTime,t(l,U);else break;U=n(u)}}function w(N){if(_=!1,y(N),!x)if(n(l)!==null)x=!0,tt(E);else{var U=n(u);U!==null&&Le(w,U.startTime-N)}}function E(N,U){x=!1,_&&(_=!1,g(T),T=-1),v=!0;var j=f;try{for(y(U),h=n(l);h!==null&&(!(h.expirationTime>U)||N&&!L());){var te=h.callback;if(typeof te=="function"){h.callback=null,f=h.priorityLevel;var fe=te(h.expirationTime<=U);U=e.unstable_now(),typeof fe=="function"?h.callback=fe:h===n(l)&&i(l),y(U)}else i(l);h=n(l)}if(h!==null)var en=!0;else{var tn=n(u);tn!==null&&Le(w,tn.startTime-U),en=!1}return en}finally{h=null,f=j,v=!1}}var k=!1,C=null,T=-1,F=5,D=-1;function L(){return!(e.unstable_now()-D<F)}function V(){if(C!==null){var N=e.unstable_now();D=N;var U=!0;try{U=C(!0,N)}finally{U?me():(k=!1,C=null)}}else k=!1}var me;if(typeof p=="function")me=function(){p(V)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Ce=H.port2;H.port1.onmessage=V,me=function(){Ce.postMessage(null)}}else me=function(){z(V,0)};function tt(N){C=N,k||(k=!0,me())}function Le(N,U){T=z(function(){N(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,tt(E))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(N){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var j=f;f=U;try{return N()}finally{f=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=f;f=N;try{return U()}finally{f=j}},e.unstable_scheduleCallback=function(N,U,j){var te=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?te+j:te):j=te,N){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=j+fe,N={id:d++,callback:U,priorityLevel:N,startTime:j,expirationTime:fe,sortIndex:-1},j>te?(N.sortIndex=j,t(u,N),n(l)===null&&N===n(u)&&(_?(g(T),T=-1):_=!0,Le(w,j-te))):(N.sortIndex=fe,t(l,N),x||v||(x=!0,tt(E))),N},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(N){var U=f;return function(){var j=f;f=U;try{return N.apply(this,arguments)}finally{f=j}}}})(gc);vc.exports=gc;var e1=vc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1=S,Ge=e1;function P(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yc=new Set,Ni={};function xn(e,t){$n(e,t),$n(e+"Capture",t)}function $n(e,t){for(Ni[e]=t,e=0;e<t.length;e++)yc.add(t[e])}var Tt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wo=Object.prototype.hasOwnProperty,n1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rl={},Dl={};function i1(e){return wo.call(Dl,e)?!0:wo.call(Rl,e)?!1:n1.test(e)?Dl[e]=!0:(Rl[e]=!0,!1)}function r1(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function s1(e,t,n,i){if(t===null||typeof t>"u"||r1(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fe(e,t,n,i,r,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var we={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){we[e]=new Fe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];we[t]=new Fe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){we[e]=new Fe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){we[e]=new Fe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){we[e]=new Fe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){we[e]=new Fe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){we[e]=new Fe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){we[e]=new Fe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){we[e]=new Fe(e,5,!1,e.toLowerCase(),null,!1,!1)});var Sa=/[\-:]([a-z])/g;function Ca(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Sa,Ca);we[t]=new Fe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Sa,Ca);we[t]=new Fe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Sa,Ca);we[t]=new Fe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){we[e]=new Fe(e,1,!1,e.toLowerCase(),null,!1,!1)});we.xlinkHref=new Fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){we[e]=new Fe(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ea(e,t,n,i){var r=we.hasOwnProperty(t)?we[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(s1(t,n,r,i)&&(n=null),i||r===null?i1(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,i=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Rt=t1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dr=Symbol.for("react.element"),zn=Symbol.for("react.portal"),Pn=Symbol.for("react.fragment"),Ta=Symbol.for("react.strict_mode"),So=Symbol.for("react.profiler"),xc=Symbol.for("react.provider"),_c=Symbol.for("react.context"),za=Symbol.for("react.forward_ref"),Co=Symbol.for("react.suspense"),Eo=Symbol.for("react.suspense_list"),Pa=Symbol.for("react.memo"),Bt=Symbol.for("react.lazy"),wc=Symbol.for("react.offscreen"),Fl=Symbol.iterator;function di(e){return e===null||typeof e!="object"?null:(e=Fl&&e[Fl]||e["@@iterator"],typeof e=="function"?e:null)}var le=Object.assign,Hs;function _i(e){if(Hs===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Hs=t&&t[1]||""}return`
`+Hs+e}var $s=!1;function Xs(e,t){if(!e||$s)return"";$s=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{$s=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_i(e):""}function o1(e){switch(e.tag){case 5:return _i(e.type);case 16:return _i("Lazy");case 13:return _i("Suspense");case 19:return _i("SuspenseList");case 0:case 2:case 15:return e=Xs(e.type,!1),e;case 11:return e=Xs(e.type.render,!1),e;case 1:return e=Xs(e.type,!0),e;default:return""}}function To(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pn:return"Fragment";case zn:return"Portal";case So:return"Profiler";case Ta:return"StrictMode";case Co:return"Suspense";case Eo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _c:return(e.displayName||"Context")+".Consumer";case xc:return(e._context.displayName||"Context")+".Provider";case za:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Pa:return t=e.displayName||null,t!==null?t:To(e.type)||"Memo";case Bt:t=e._payload,e=e._init;try{return To(e(t))}catch{}}return null}function a1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return To(t);case 8:return t===Ta?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Sc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function l1(e){var t=Sc(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fr(e){e._valueTracker||(e._valueTracker=l1(e))}function Cc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Sc(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Xr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zo(e,t){var n=t.checked;return le({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Nl(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=Yt(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ec(e,t){t=t.checked,t!=null&&Ea(e,"checked",t,!1)}function Po(e,t){Ec(e,t);var n=Yt(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ko(e,t.type,n):t.hasOwnProperty("defaultValue")&&ko(e,t.type,Yt(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Il(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ko(e,t,n){(t!=="number"||Xr(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var wi=Array.isArray;function Un(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Yt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Mo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(P(91));return le({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bl(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(P(92));if(wi(n)){if(1<n.length)throw Error(P(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Yt(n)}}function Tc(e,t){var n=Yt(t.value),i=Yt(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function Al(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ro(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var hr,Pc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(hr=hr||document.createElement("div"),hr.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=hr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ii(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ei={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},u1=["Webkit","ms","Moz","O"];Object.keys(Ei).forEach(function(e){u1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ei[t]=Ei[e]})});function kc(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ei.hasOwnProperty(e)&&Ei[e]?(""+t).trim():t+"px"}function Mc(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=kc(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}var c1=le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Do(e,t){if(t){if(c1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(P(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(P(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(P(61))}if(t.style!=null&&typeof t.style!="object")throw Error(P(62))}}function Fo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var No=null;function ka(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Io=null,jn=null,On=null;function bl(e){if(e=tr(e)){if(typeof Io!="function")throw Error(P(280));var t=e.stateNode;t&&(t=Ts(t),Io(e.stateNode,e.type,t))}}function Rc(e){jn?On?On.push(e):On=[e]:jn=e}function Dc(){if(jn){var e=jn,t=On;if(On=jn=null,bl(e),t)for(e=0;e<t.length;e++)bl(t[e])}}function Fc(e,t){return e(t)}function Nc(){}var Ks=!1;function Ic(e,t,n){if(Ks)return e(t,n);Ks=!0;try{return Fc(e,t,n)}finally{Ks=!1,(jn!==null||On!==null)&&(Nc(),Dc())}}function Bi(e,t){var n=e.stateNode;if(n===null)return null;var i=Ts(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(P(231,t,typeof n));return n}var Bo=!1;if(Tt)try{var fi={};Object.defineProperty(fi,"passive",{get:function(){Bo=!0}}),window.addEventListener("test",fi,fi),window.removeEventListener("test",fi,fi)}catch{Bo=!1}function d1(e,t,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Ti=!1,Kr=null,Yr=!1,Ao=null,f1={onError:function(e){Ti=!0,Kr=e}};function h1(e,t,n,i,r,s,o,a,l){Ti=!1,Kr=null,d1.apply(f1,arguments)}function m1(e,t,n,i,r,s,o,a,l){if(h1.apply(this,arguments),Ti){if(Ti){var u=Kr;Ti=!1,Kr=null}else throw Error(P(198));Yr||(Yr=!0,Ao=u)}}function _n(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Bc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ll(e){if(_n(e)!==e)throw Error(P(188))}function p1(e){var t=e.alternate;if(!t){if(t=_n(e),t===null)throw Error(P(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ll(r),e;if(s===i)return Ll(r),t;s=s.sibling}throw Error(P(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(P(189))}}if(n.alternate!==i)throw Error(P(190))}if(n.tag!==3)throw Error(P(188));return n.stateNode.current===n?e:t}function Ac(e){return e=p1(e),e!==null?bc(e):null}function bc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bc(e);if(t!==null)return t;e=e.sibling}return null}var Lc=Ge.unstable_scheduleCallback,Ul=Ge.unstable_cancelCallback,v1=Ge.unstable_shouldYield,g1=Ge.unstable_requestPaint,de=Ge.unstable_now,y1=Ge.unstable_getCurrentPriorityLevel,Ma=Ge.unstable_ImmediatePriority,Uc=Ge.unstable_UserBlockingPriority,Qr=Ge.unstable_NormalPriority,x1=Ge.unstable_LowPriority,jc=Ge.unstable_IdlePriority,ws=null,gt=null;function _1(e){if(gt&&typeof gt.onCommitFiberRoot=="function")try{gt.onCommitFiberRoot(ws,e,void 0,(e.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:C1,w1=Math.log,S1=Math.LN2;function C1(e){return e>>>=0,e===0?32:31-(w1(e)/S1|0)|0}var mr=64,pr=4194304;function Si(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zr(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=Si(a):(s&=o,s!==0&&(i=Si(s)))}else o=n&~r,o!==0?i=Si(o):s!==0&&(i=Si(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-lt(t),r=1<<n,i|=e[n],t&=~r;return i}function E1(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T1(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-lt(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=E1(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function bo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Oc(){var e=mr;return mr<<=1,!(mr&4194240)&&(mr=64),e}function Ys(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ji(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-lt(t),e[t]=n}function z1(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-lt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}function Ra(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-lt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Y=0;function Vc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Gc,Da,Wc,Hc,$c,Lo=!1,vr=[],Ot=null,Vt=null,Gt=null,Ai=new Map,bi=new Map,bt=[],P1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jl(e,t){switch(e){case"focusin":case"focusout":Ot=null;break;case"dragenter":case"dragleave":Vt=null;break;case"mouseover":case"mouseout":Gt=null;break;case"pointerover":case"pointerout":Ai.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bi.delete(t.pointerId)}}function hi(e,t,n,i,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=tr(t),t!==null&&Da(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function k1(e,t,n,i,r){switch(t){case"focusin":return Ot=hi(Ot,e,t,n,i,r),!0;case"dragenter":return Vt=hi(Vt,e,t,n,i,r),!0;case"mouseover":return Gt=hi(Gt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Ai.set(s,hi(Ai.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,bi.set(s,hi(bi.get(s)||null,e,t,n,i,r)),!0}return!1}function Xc(e){var t=an(e.target);if(t!==null){var n=_n(t);if(n!==null){if(t=n.tag,t===13){if(t=Bc(n),t!==null){e.blockedOn=t,$c(e.priority,function(){Wc(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nr(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Uo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);No=i,n.target.dispatchEvent(i),No=null}else return t=tr(n),t!==null&&Da(t),e.blockedOn=n,!1;t.shift()}return!0}function Ol(e,t,n){Nr(e)&&n.delete(t)}function M1(){Lo=!1,Ot!==null&&Nr(Ot)&&(Ot=null),Vt!==null&&Nr(Vt)&&(Vt=null),Gt!==null&&Nr(Gt)&&(Gt=null),Ai.forEach(Ol),bi.forEach(Ol)}function mi(e,t){e.blockedOn===t&&(e.blockedOn=null,Lo||(Lo=!0,Ge.unstable_scheduleCallback(Ge.unstable_NormalPriority,M1)))}function Li(e){function t(r){return mi(r,e)}if(0<vr.length){mi(vr[0],e);for(var n=1;n<vr.length;n++){var i=vr[n];i.blockedOn===e&&(i.blockedOn=null)}}for(Ot!==null&&mi(Ot,e),Vt!==null&&mi(Vt,e),Gt!==null&&mi(Gt,e),Ai.forEach(t),bi.forEach(t),n=0;n<bt.length;n++)i=bt[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<bt.length&&(n=bt[0],n.blockedOn===null);)Xc(n),n.blockedOn===null&&bt.shift()}var Vn=Rt.ReactCurrentBatchConfig,qr=!0;function R1(e,t,n,i){var r=Y,s=Vn.transition;Vn.transition=null;try{Y=1,Fa(e,t,n,i)}finally{Y=r,Vn.transition=s}}function D1(e,t,n,i){var r=Y,s=Vn.transition;Vn.transition=null;try{Y=4,Fa(e,t,n,i)}finally{Y=r,Vn.transition=s}}function Fa(e,t,n,i){if(qr){var r=Uo(e,t,n,i);if(r===null)so(e,t,i,Jr,n),jl(e,i);else if(k1(r,e,t,n,i))i.stopPropagation();else if(jl(e,i),t&4&&-1<P1.indexOf(e)){for(;r!==null;){var s=tr(r);if(s!==null&&Gc(s),s=Uo(e,t,n,i),s===null&&so(e,t,i,Jr,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else so(e,t,i,null,n)}}var Jr=null;function Uo(e,t,n,i){if(Jr=null,e=ka(i),e=an(e),e!==null)if(t=_n(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Bc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jr=e,null}function Kc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(y1()){case Ma:return 1;case Uc:return 4;case Qr:case x1:return 16;case jc:return 536870912;default:return 16}default:return 16}}var Ut=null,Na=null,Ir=null;function Yc(){if(Ir)return Ir;var e,t=Na,n=t.length,i,r="value"in Ut?Ut.value:Ut.textContent,s=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===r[s-i];i++);return Ir=r.slice(e,1<i?1-i:void 0)}function Br(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gr(){return!0}function Vl(){return!1}function He(e){function t(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gr:Vl,this.isPropagationStopped=Vl,this}return le(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gr)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gr)},persist:function(){},isPersistent:gr}),t}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ia=He(ii),er=le({},ii,{view:0,detail:0}),F1=He(er),Qs,Zs,pi,Ss=le({},er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ba,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pi&&(pi&&e.type==="mousemove"?(Qs=e.screenX-pi.screenX,Zs=e.screenY-pi.screenY):Zs=Qs=0,pi=e),Qs)},movementY:function(e){return"movementY"in e?e.movementY:Zs}}),Gl=He(Ss),N1=le({},Ss,{dataTransfer:0}),I1=He(N1),B1=le({},er,{relatedTarget:0}),qs=He(B1),A1=le({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),b1=He(A1),L1=le({},ii,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),U1=He(L1),j1=le({},ii,{data:0}),Wl=He(j1),O1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=G1[e])?!!t[e]:!1}function Ba(){return W1}var H1=le({},er,{key:function(e){if(e.key){var t=O1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Br(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?V1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ba,charCode:function(e){return e.type==="keypress"?Br(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Br(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$1=He(H1),X1=le({},Ss,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hl=He(X1),K1=le({},er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ba}),Y1=He(K1),Q1=le({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),Z1=He(Q1),q1=le({},Ss,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),J1=He(q1),eg=[9,13,27,32],Aa=Tt&&"CompositionEvent"in window,zi=null;Tt&&"documentMode"in document&&(zi=document.documentMode);var tg=Tt&&"TextEvent"in window&&!zi,Qc=Tt&&(!Aa||zi&&8<zi&&11>=zi),$l=" ",Xl=!1;function Zc(e,t){switch(e){case"keyup":return eg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var kn=!1;function ng(e,t){switch(e){case"compositionend":return qc(t);case"keypress":return t.which!==32?null:(Xl=!0,$l);case"textInput":return e=t.data,e===$l&&Xl?null:e;default:return null}}function ig(e,t){if(kn)return e==="compositionend"||!Aa&&Zc(e,t)?(e=Yc(),Ir=Na=Ut=null,kn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qc&&t.locale!=="ko"?null:t.data;default:return null}}var rg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rg[e.type]:t==="textarea"}function Jc(e,t,n,i){Rc(i),t=es(t,"onChange"),0<t.length&&(n=new Ia("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Pi=null,Ui=null;function sg(e){cd(e,0)}function Cs(e){var t=Dn(e);if(Cc(t))return e}function og(e,t){if(e==="change")return t}var ed=!1;if(Tt){var Js;if(Tt){var eo="oninput"in document;if(!eo){var Yl=document.createElement("div");Yl.setAttribute("oninput","return;"),eo=typeof Yl.oninput=="function"}Js=eo}else Js=!1;ed=Js&&(!document.documentMode||9<document.documentMode)}function Ql(){Pi&&(Pi.detachEvent("onpropertychange",td),Ui=Pi=null)}function td(e){if(e.propertyName==="value"&&Cs(Ui)){var t=[];Jc(t,Ui,e,ka(e)),Ic(sg,t)}}function ag(e,t,n){e==="focusin"?(Ql(),Pi=t,Ui=n,Pi.attachEvent("onpropertychange",td)):e==="focusout"&&Ql()}function lg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Cs(Ui)}function ug(e,t){if(e==="click")return Cs(t)}function cg(e,t){if(e==="input"||e==="change")return Cs(t)}function dg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dt=typeof Object.is=="function"?Object.is:dg;function ji(e,t){if(dt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!wo.call(t,r)||!dt(e[r],t[r]))return!1}return!0}function Zl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ql(e,t){var n=Zl(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zl(n)}}function nd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?nd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function id(){for(var e=window,t=Xr();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Xr(e.document)}return t}function ba(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fg(e){var t=id(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&nd(n.ownerDocument.documentElement,n)){if(i!==null&&ba(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ql(n,s);var o=ql(n,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hg=Tt&&"documentMode"in document&&11>=document.documentMode,Mn=null,jo=null,ki=null,Oo=!1;function Jl(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Oo||Mn==null||Mn!==Xr(i)||(i=Mn,"selectionStart"in i&&ba(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ki&&ji(ki,i)||(ki=i,i=es(jo,"onSelect"),0<i.length&&(t=new Ia("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Mn)))}function yr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Rn={animationend:yr("Animation","AnimationEnd"),animationiteration:yr("Animation","AnimationIteration"),animationstart:yr("Animation","AnimationStart"),transitionend:yr("Transition","TransitionEnd")},to={},rd={};Tt&&(rd=document.createElement("div").style,"AnimationEvent"in window||(delete Rn.animationend.animation,delete Rn.animationiteration.animation,delete Rn.animationstart.animation),"TransitionEvent"in window||delete Rn.transitionend.transition);function Es(e){if(to[e])return to[e];if(!Rn[e])return e;var t=Rn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in rd)return to[e]=t[n];return e}var sd=Es("animationend"),od=Es("animationiteration"),ad=Es("animationstart"),ld=Es("transitionend"),ud=new Map,eu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zt(e,t){ud.set(e,t),xn(t,[e])}for(var no=0;no<eu.length;no++){var io=eu[no],mg=io.toLowerCase(),pg=io[0].toUpperCase()+io.slice(1);Zt(mg,"on"+pg)}Zt(sd,"onAnimationEnd");Zt(od,"onAnimationIteration");Zt(ad,"onAnimationStart");Zt("dblclick","onDoubleClick");Zt("focusin","onFocus");Zt("focusout","onBlur");Zt(ld,"onTransitionEnd");$n("onMouseEnter",["mouseout","mouseover"]);$n("onMouseLeave",["mouseout","mouseover"]);$n("onPointerEnter",["pointerout","pointerover"]);$n("onPointerLeave",["pointerout","pointerover"]);xn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xn("onBeforeInput",["compositionend","keypress","textInput","paste"]);xn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ci="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ci));function tu(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,m1(i,t,void 0,e),e.currentTarget=null}function cd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;tu(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;tu(r,a,u),s=l}}}if(Yr)throw e=Ao,Yr=!1,Ao=null,e}function J(e,t){var n=t[$o];n===void 0&&(n=t[$o]=new Set);var i=e+"__bubble";n.has(i)||(dd(t,e,2,!1),n.add(i))}function ro(e,t,n){var i=0;t&&(i|=4),dd(n,e,i,t)}var xr="_reactListening"+Math.random().toString(36).slice(2);function Oi(e){if(!e[xr]){e[xr]=!0,yc.forEach(function(n){n!=="selectionchange"&&(vg.has(n)||ro(n,!1,e),ro(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xr]||(t[xr]=!0,ro("selectionchange",!1,t))}}function dd(e,t,n,i){switch(Kc(t)){case 1:var r=R1;break;case 4:r=D1;break;default:r=Fa}n=r.bind(null,t,n,e),r=void 0,!Bo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function so(e,t,n,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=an(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}Ic(function(){var u=s,d=ka(n),h=[];e:{var f=ud.get(e);if(f!==void 0){var v=Ia,x=e;switch(e){case"keypress":if(Br(n)===0)break e;case"keydown":case"keyup":v=$1;break;case"focusin":x="focus",v=qs;break;case"focusout":x="blur",v=qs;break;case"beforeblur":case"afterblur":v=qs;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=I1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Y1;break;case sd:case od:case ad:v=b1;break;case ld:v=Z1;break;case"scroll":v=F1;break;case"wheel":v=J1;break;case"copy":case"cut":case"paste":v=U1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Hl}var _=(t&4)!==0,z=!_&&e==="scroll",g=_?f!==null?f+"Capture":null:f;_=[];for(var p=u,y;p!==null;){y=p;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,g!==null&&(w=Bi(p,g),w!=null&&_.push(Vi(p,w,y)))),z)break;p=p.return}0<_.length&&(f=new v(f,x,null,n,d),h.push({event:f,listeners:_}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",f&&n!==No&&(x=n.relatedTarget||n.fromElement)&&(an(x)||x[zt]))break e;if((v||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=u,x=x?an(x):null,x!==null&&(z=_n(x),x!==z||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=u),v!==x)){if(_=Gl,w="onMouseLeave",g="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(_=Hl,w="onPointerLeave",g="onPointerEnter",p="pointer"),z=v==null?f:Dn(v),y=x==null?f:Dn(x),f=new _(w,p+"leave",v,n,d),f.target=z,f.relatedTarget=y,w=null,an(d)===u&&(_=new _(g,p+"enter",x,n,d),_.target=y,_.relatedTarget=z,w=_),z=w,v&&x)t:{for(_=v,g=x,p=0,y=_;y;y=Cn(y))p++;for(y=0,w=g;w;w=Cn(w))y++;for(;0<p-y;)_=Cn(_),p--;for(;0<y-p;)g=Cn(g),y--;for(;p--;){if(_===g||g!==null&&_===g.alternate)break t;_=Cn(_),g=Cn(g)}_=null}else _=null;v!==null&&nu(h,f,v,_,!1),x!==null&&z!==null&&nu(h,z,x,_,!0)}}e:{if(f=u?Dn(u):window,v=f.nodeName&&f.nodeName.toLowerCase(),v==="select"||v==="input"&&f.type==="file")var E=og;else if(Kl(f))if(ed)E=cg;else{E=lg;var k=ag}else(v=f.nodeName)&&v.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=ug);if(E&&(E=E(e,u))){Jc(h,E,n,d);break e}k&&k(e,f,u),e==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&ko(f,"number",f.value)}switch(k=u?Dn(u):window,e){case"focusin":(Kl(k)||k.contentEditable==="true")&&(Mn=k,jo=u,ki=null);break;case"focusout":ki=jo=Mn=null;break;case"mousedown":Oo=!0;break;case"contextmenu":case"mouseup":case"dragend":Oo=!1,Jl(h,n,d);break;case"selectionchange":if(hg)break;case"keydown":case"keyup":Jl(h,n,d)}var C;if(Aa)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else kn?Zc(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(Qc&&n.locale!=="ko"&&(kn||T!=="onCompositionStart"?T==="onCompositionEnd"&&kn&&(C=Yc()):(Ut=d,Na="value"in Ut?Ut.value:Ut.textContent,kn=!0)),k=es(u,T),0<k.length&&(T=new Wl(T,e,null,n,d),h.push({event:T,listeners:k}),C?T.data=C:(C=qc(n),C!==null&&(T.data=C)))),(C=tg?ng(e,n):ig(e,n))&&(u=es(u,"onBeforeInput"),0<u.length&&(d=new Wl("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=C))}cd(h,t)})}function Vi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function es(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Bi(e,n),s!=null&&i.unshift(Vi(e,s,r)),s=Bi(e,t),s!=null&&i.push(Vi(e,s,r))),e=e.return}return i}function Cn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function nu(e,t,n,i,r){for(var s=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Bi(n,s),l!=null&&o.unshift(Vi(n,l,a))):r||(l=Bi(n,s),l!=null&&o.push(Vi(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var gg=/\r\n?/g,yg=/\u0000|\uFFFD/g;function iu(e){return(typeof e=="string"?e:""+e).replace(gg,`
`).replace(yg,"")}function _r(e,t,n){if(t=iu(t),iu(e)!==t&&n)throw Error(P(425))}function ts(){}var Vo=null,Go=null;function Wo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ho=typeof setTimeout=="function"?setTimeout:void 0,xg=typeof clearTimeout=="function"?clearTimeout:void 0,ru=typeof Promise=="function"?Promise:void 0,_g=typeof queueMicrotask=="function"?queueMicrotask:typeof ru<"u"?function(e){return ru.resolve(null).then(e).catch(wg)}:Ho;function wg(e){setTimeout(function(){throw e})}function oo(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),Li(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Li(t)}function Wt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function su(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ri=Math.random().toString(36).slice(2),pt="__reactFiber$"+ri,Gi="__reactProps$"+ri,zt="__reactContainer$"+ri,$o="__reactEvents$"+ri,Sg="__reactListeners$"+ri,Cg="__reactHandles$"+ri;function an(e){var t=e[pt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[zt]||n[pt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=su(e);e!==null;){if(n=e[pt])return n;e=su(e)}return t}e=n,n=e.parentNode}return null}function tr(e){return e=e[pt]||e[zt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Dn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(P(33))}function Ts(e){return e[Gi]||null}var Xo=[],Fn=-1;function qt(e){return{current:e}}function ee(e){0>Fn||(e.current=Xo[Fn],Xo[Fn]=null,Fn--)}function q(e,t){Fn++,Xo[Fn]=e.current,e.current=t}var Qt={},Pe=qt(Qt),Be=qt(!1),hn=Qt;function Xn(e,t){var n=e.type.contextTypes;if(!n)return Qt;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ae(e){return e=e.childContextTypes,e!=null}function ns(){ee(Be),ee(Pe)}function ou(e,t,n){if(Pe.current!==Qt)throw Error(P(168));q(Pe,t),q(Be,n)}function fd(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(P(108,a1(e)||"Unknown",r));return le({},n,i)}function is(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qt,hn=Pe.current,q(Pe,e),q(Be,Be.current),!0}function au(e,t,n){var i=e.stateNode;if(!i)throw Error(P(169));n?(e=fd(e,t,hn),i.__reactInternalMemoizedMergedChildContext=e,ee(Be),ee(Pe),q(Pe,e)):ee(Be),q(Be,n)}var wt=null,zs=!1,ao=!1;function hd(e){wt===null?wt=[e]:wt.push(e)}function Eg(e){zs=!0,hd(e)}function Jt(){if(!ao&&wt!==null){ao=!0;var e=0,t=Y;try{var n=wt;for(Y=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}wt=null,zs=!1}catch(r){throw wt!==null&&(wt=wt.slice(e+1)),Lc(Ma,Jt),r}finally{Y=t,ao=!1}}return null}var Nn=[],In=0,rs=null,ss=0,$e=[],Xe=0,mn=null,St=1,Ct="";function sn(e,t){Nn[In++]=ss,Nn[In++]=rs,rs=e,ss=t}function md(e,t,n){$e[Xe++]=St,$e[Xe++]=Ct,$e[Xe++]=mn,mn=e;var i=St;e=Ct;var r=32-lt(i)-1;i&=~(1<<r),n+=1;var s=32-lt(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,St=1<<32-lt(t)+r|n<<r|i,Ct=s+e}else St=1<<s|n<<r|i,Ct=e}function La(e){e.return!==null&&(sn(e,1),md(e,1,0))}function Ua(e){for(;e===rs;)rs=Nn[--In],Nn[In]=null,ss=Nn[--In],Nn[In]=null;for(;e===mn;)mn=$e[--Xe],$e[Xe]=null,Ct=$e[--Xe],$e[Xe]=null,St=$e[--Xe],$e[Xe]=null}var Ve=null,Oe=null,ne=!1,ot=null;function pd(e,t){var n=Ye(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function lu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ve=e,Oe=Wt(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ve=e,Oe=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=mn!==null?{id:St,overflow:Ct}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ye(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ve=e,Oe=null,!0):!1;default:return!1}}function Ko(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yo(e){if(ne){var t=Oe;if(t){var n=t;if(!lu(e,t)){if(Ko(e))throw Error(P(418));t=Wt(n.nextSibling);var i=Ve;t&&lu(e,t)?pd(i,n):(e.flags=e.flags&-4097|2,ne=!1,Ve=e)}}else{if(Ko(e))throw Error(P(418));e.flags=e.flags&-4097|2,ne=!1,Ve=e}}}function uu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ve=e}function wr(e){if(e!==Ve)return!1;if(!ne)return uu(e),ne=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wo(e.type,e.memoizedProps)),t&&(t=Oe)){if(Ko(e))throw vd(),Error(P(418));for(;t;)pd(e,t),t=Wt(t.nextSibling)}if(uu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(P(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Oe=Wt(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Oe=null}}else Oe=Ve?Wt(e.stateNode.nextSibling):null;return!0}function vd(){for(var e=Oe;e;)e=Wt(e.nextSibling)}function Kn(){Oe=Ve=null,ne=!1}function ja(e){ot===null?ot=[e]:ot.push(e)}var Tg=Rt.ReactCurrentBatchConfig;function vi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(P(309));var i=n.stateNode}if(!i)throw Error(P(147,e));var r=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(P(284));if(!n._owner)throw Error(P(290,e))}return e}function Sr(e,t){throw e=Object.prototype.toString.call(t),Error(P(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function cu(e){var t=e._init;return t(e._payload)}function gd(e){function t(g,p){if(e){var y=g.deletions;y===null?(g.deletions=[p],g.flags|=16):y.push(p)}}function n(g,p){if(!e)return null;for(;p!==null;)t(g,p),p=p.sibling;return null}function i(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function r(g,p){return g=Kt(g,p),g.index=0,g.sibling=null,g}function s(g,p,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<p?(g.flags|=2,p):y):(g.flags|=2,p)):(g.flags|=1048576,p)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function a(g,p,y,w){return p===null||p.tag!==6?(p=po(y,g.mode,w),p.return=g,p):(p=r(p,y),p.return=g,p)}function l(g,p,y,w){var E=y.type;return E===Pn?d(g,p,y.props.children,w,y.key):p!==null&&(p.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Bt&&cu(E)===p.type)?(w=r(p,y.props),w.ref=vi(g,p,y),w.return=g,w):(w=Vr(y.type,y.key,y.props,null,g.mode,w),w.ref=vi(g,p,y),w.return=g,w)}function u(g,p,y,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=vo(y,g.mode,w),p.return=g,p):(p=r(p,y.children||[]),p.return=g,p)}function d(g,p,y,w,E){return p===null||p.tag!==7?(p=dn(y,g.mode,w,E),p.return=g,p):(p=r(p,y),p.return=g,p)}function h(g,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=po(""+p,g.mode,y),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case dr:return y=Vr(p.type,p.key,p.props,null,g.mode,y),y.ref=vi(g,null,p),y.return=g,y;case zn:return p=vo(p,g.mode,y),p.return=g,p;case Bt:var w=p._init;return h(g,w(p._payload),y)}if(wi(p)||di(p))return p=dn(p,g.mode,y,null),p.return=g,p;Sr(g,p)}return null}function f(g,p,y,w){var E=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:a(g,p,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case dr:return y.key===E?l(g,p,y,w):null;case zn:return y.key===E?u(g,p,y,w):null;case Bt:return E=y._init,f(g,p,E(y._payload),w)}if(wi(y)||di(y))return E!==null?null:d(g,p,y,w,null);Sr(g,y)}return null}function v(g,p,y,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(y)||null,a(p,g,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dr:return g=g.get(w.key===null?y:w.key)||null,l(p,g,w,E);case zn:return g=g.get(w.key===null?y:w.key)||null,u(p,g,w,E);case Bt:var k=w._init;return v(g,p,y,k(w._payload),E)}if(wi(w)||di(w))return g=g.get(y)||null,d(p,g,w,E,null);Sr(p,w)}return null}function x(g,p,y,w){for(var E=null,k=null,C=p,T=p=0,F=null;C!==null&&T<y.length;T++){C.index>T?(F=C,C=null):F=C.sibling;var D=f(g,C,y[T],w);if(D===null){C===null&&(C=F);break}e&&C&&D.alternate===null&&t(g,C),p=s(D,p,T),k===null?E=D:k.sibling=D,k=D,C=F}if(T===y.length)return n(g,C),ne&&sn(g,T),E;if(C===null){for(;T<y.length;T++)C=h(g,y[T],w),C!==null&&(p=s(C,p,T),k===null?E=C:k.sibling=C,k=C);return ne&&sn(g,T),E}for(C=i(g,C);T<y.length;T++)F=v(C,g,T,y[T],w),F!==null&&(e&&F.alternate!==null&&C.delete(F.key===null?T:F.key),p=s(F,p,T),k===null?E=F:k.sibling=F,k=F);return e&&C.forEach(function(L){return t(g,L)}),ne&&sn(g,T),E}function _(g,p,y,w){var E=di(y);if(typeof E!="function")throw Error(P(150));if(y=E.call(y),y==null)throw Error(P(151));for(var k=E=null,C=p,T=p=0,F=null,D=y.next();C!==null&&!D.done;T++,D=y.next()){C.index>T?(F=C,C=null):F=C.sibling;var L=f(g,C,D.value,w);if(L===null){C===null&&(C=F);break}e&&C&&L.alternate===null&&t(g,C),p=s(L,p,T),k===null?E=L:k.sibling=L,k=L,C=F}if(D.done)return n(g,C),ne&&sn(g,T),E;if(C===null){for(;!D.done;T++,D=y.next())D=h(g,D.value,w),D!==null&&(p=s(D,p,T),k===null?E=D:k.sibling=D,k=D);return ne&&sn(g,T),E}for(C=i(g,C);!D.done;T++,D=y.next())D=v(C,g,T,D.value,w),D!==null&&(e&&D.alternate!==null&&C.delete(D.key===null?T:D.key),p=s(D,p,T),k===null?E=D:k.sibling=D,k=D);return e&&C.forEach(function(V){return t(g,V)}),ne&&sn(g,T),E}function z(g,p,y,w){if(typeof y=="object"&&y!==null&&y.type===Pn&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case dr:e:{for(var E=y.key,k=p;k!==null;){if(k.key===E){if(E=y.type,E===Pn){if(k.tag===7){n(g,k.sibling),p=r(k,y.props.children),p.return=g,g=p;break e}}else if(k.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Bt&&cu(E)===k.type){n(g,k.sibling),p=r(k,y.props),p.ref=vi(g,k,y),p.return=g,g=p;break e}n(g,k);break}else t(g,k);k=k.sibling}y.type===Pn?(p=dn(y.props.children,g.mode,w,y.key),p.return=g,g=p):(w=Vr(y.type,y.key,y.props,null,g.mode,w),w.ref=vi(g,p,y),w.return=g,g=w)}return o(g);case zn:e:{for(k=y.key;p!==null;){if(p.key===k)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(g,p.sibling),p=r(p,y.children||[]),p.return=g,g=p;break e}else{n(g,p);break}else t(g,p);p=p.sibling}p=vo(y,g.mode,w),p.return=g,g=p}return o(g);case Bt:return k=y._init,z(g,p,k(y._payload),w)}if(wi(y))return x(g,p,y,w);if(di(y))return _(g,p,y,w);Sr(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(g,p.sibling),p=r(p,y),p.return=g,g=p):(n(g,p),p=po(y,g.mode,w),p.return=g,g=p),o(g)):n(g,p)}return z}var Yn=gd(!0),yd=gd(!1),os=qt(null),as=null,Bn=null,Oa=null;function Va(){Oa=Bn=as=null}function Ga(e){var t=os.current;ee(os),e._currentValue=t}function Qo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Gn(e,t){as=e,Oa=Bn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ie=!0),e.firstContext=null)}function Ze(e){var t=e._currentValue;if(Oa!==e)if(e={context:e,memoizedValue:t,next:null},Bn===null){if(as===null)throw Error(P(308));Bn=e,as.dependencies={lanes:0,firstContext:e}}else Bn=Bn.next=e;return t}var ln=null;function Wa(e){ln===null?ln=[e]:ln.push(e)}function xd(e,t,n,i){var r=t.interleaved;return r===null?(n.next=n,Wa(t)):(n.next=r.next,r.next=n),t.interleaved=n,Pt(e,i)}function Pt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var At=!1;function Ha(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _d(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Et(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ht(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,$&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Pt(e,n)}return r=i.interleaved,r===null?(t.next=t,Wa(i)):(t.next=r.next,r.next=t),i.interleaved=t,Pt(e,n)}function Ar(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Ra(e,n)}}function du(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=t:s=s.next=t}else r=s=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ls(e,t,n,i){var r=e.updateQueue;At=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;o=0,d=u=l=null,a=s;do{var f=a.lane,v=a.eventTime;if((i&f)===f){d!==null&&(d=d.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=e,_=a;switch(f=t,v=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){h=x.call(v,h,f);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,f=typeof x=="function"?x.call(v,h,f):x,f==null)break e;h=le({},h,f);break e;case 2:At=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else v={eventTime:v,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=v,l=h):d=d.next=v,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);vn|=o,e.lanes=o,e.memoizedState=h}}function fu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(P(191,r));r.call(i)}}}var nr={},yt=qt(nr),Wi=qt(nr),Hi=qt(nr);function un(e){if(e===nr)throw Error(P(174));return e}function $a(e,t){switch(q(Hi,t),q(Wi,e),q(yt,nr),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ro(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ro(t,e)}ee(yt),q(yt,t)}function Qn(){ee(yt),ee(Wi),ee(Hi)}function wd(e){un(Hi.current);var t=un(yt.current),n=Ro(t,e.type);t!==n&&(q(Wi,e),q(yt,n))}function Xa(e){Wi.current===e&&(ee(yt),ee(Wi))}var se=qt(0);function us(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lo=[];function Ka(){for(var e=0;e<lo.length;e++)lo[e]._workInProgressVersionPrimary=null;lo.length=0}var br=Rt.ReactCurrentDispatcher,uo=Rt.ReactCurrentBatchConfig,pn=0,ae=null,pe=null,ge=null,cs=!1,Mi=!1,$i=0,zg=0;function Ee(){throw Error(P(321))}function Ya(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!dt(e[n],t[n]))return!1;return!0}function Qa(e,t,n,i,r,s){if(pn=s,ae=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,br.current=e===null||e.memoizedState===null?Rg:Dg,e=n(i,r),Mi){s=0;do{if(Mi=!1,$i=0,25<=s)throw Error(P(301));s+=1,ge=pe=null,t.updateQueue=null,br.current=Fg,e=n(i,r)}while(Mi)}if(br.current=ds,t=pe!==null&&pe.next!==null,pn=0,ge=pe=ae=null,cs=!1,t)throw Error(P(300));return e}function Za(){var e=$i!==0;return $i=0,e}function mt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ge===null?ae.memoizedState=ge=e:ge=ge.next=e,ge}function qe(){if(pe===null){var e=ae.alternate;e=e!==null?e.memoizedState:null}else e=pe.next;var t=ge===null?ae.memoizedState:ge.next;if(t!==null)ge=t,pe=e;else{if(e===null)throw Error(P(310));pe=e,e={memoizedState:pe.memoizedState,baseState:pe.baseState,baseQueue:pe.baseQueue,queue:pe.queue,next:null},ge===null?ae.memoizedState=ge=e:ge=ge.next=e}return ge}function Xi(e,t){return typeof t=="function"?t(e):t}function co(e){var t=qe(),n=t.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=e;var i=pe,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((pn&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=i):l=l.next=h,ae.lanes|=d,vn|=d}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,dt(i,t.memoizedState)||(Ie=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=l,n.lastRenderedState=i}if(e=n.interleaved,e!==null){r=e;do s=r.lane,ae.lanes|=s,vn|=s,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function fo(e){var t=qe(),n=t.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);dt(s,t.memoizedState)||(Ie=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Sd(){}function Cd(e,t){var n=ae,i=qe(),r=t(),s=!dt(i.memoizedState,r);if(s&&(i.memoizedState=r,Ie=!0),i=i.queue,qa(zd.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||ge!==null&&ge.memoizedState.tag&1){if(n.flags|=2048,Ki(9,Td.bind(null,n,i,r,t),void 0,null),ye===null)throw Error(P(349));pn&30||Ed(n,t,r)}return r}function Ed(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ae.updateQueue,t===null?(t={lastEffect:null,stores:null},ae.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Td(e,t,n,i){t.value=n,t.getSnapshot=i,Pd(t)&&kd(e)}function zd(e,t,n){return n(function(){Pd(t)&&kd(e)})}function Pd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!dt(e,n)}catch{return!0}}function kd(e){var t=Pt(e,1);t!==null&&ut(t,e,1,-1)}function hu(e){var t=mt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:e},t.queue=e,e=e.dispatch=Mg.bind(null,ae,e),[t.memoizedState,e]}function Ki(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=ae.updateQueue,t===null?(t={lastEffect:null,stores:null},ae.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Md(){return qe().memoizedState}function Lr(e,t,n,i){var r=mt();ae.flags|=e,r.memoizedState=Ki(1|t,n,void 0,i===void 0?null:i)}function Ps(e,t,n,i){var r=qe();i=i===void 0?null:i;var s=void 0;if(pe!==null){var o=pe.memoizedState;if(s=o.destroy,i!==null&&Ya(i,o.deps)){r.memoizedState=Ki(t,n,s,i);return}}ae.flags|=e,r.memoizedState=Ki(1|t,n,s,i)}function mu(e,t){return Lr(8390656,8,e,t)}function qa(e,t){return Ps(2048,8,e,t)}function Rd(e,t){return Ps(4,2,e,t)}function Dd(e,t){return Ps(4,4,e,t)}function Fd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Nd(e,t,n){return n=n!=null?n.concat([e]):null,Ps(4,4,Fd.bind(null,t,e),n)}function Ja(){}function Id(e,t){var n=qe();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&Ya(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Bd(e,t){var n=qe();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&Ya(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ad(e,t,n){return pn&21?(dt(n,t)||(n=Oc(),ae.lanes|=n,vn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ie=!0),e.memoizedState=n)}function Pg(e,t){var n=Y;Y=n!==0&&4>n?n:4,e(!0);var i=uo.transition;uo.transition={};try{e(!1),t()}finally{Y=n,uo.transition=i}}function bd(){return qe().memoizedState}function kg(e,t,n){var i=Xt(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ld(e))Ud(t,n);else if(n=xd(e,t,n,i),n!==null){var r=Me();ut(n,e,i,r),jd(n,t,i)}}function Mg(e,t,n){var i=Xt(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ld(e))Ud(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,dt(a,o)){var l=t.interleaved;l===null?(r.next=r,Wa(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}n=xd(e,t,r,i),n!==null&&(r=Me(),ut(n,e,i,r),jd(n,t,i))}}function Ld(e){var t=e.alternate;return e===ae||t!==null&&t===ae}function Ud(e,t){Mi=cs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function jd(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Ra(e,n)}}var ds={readContext:Ze,useCallback:Ee,useContext:Ee,useEffect:Ee,useImperativeHandle:Ee,useInsertionEffect:Ee,useLayoutEffect:Ee,useMemo:Ee,useReducer:Ee,useRef:Ee,useState:Ee,useDebugValue:Ee,useDeferredValue:Ee,useTransition:Ee,useMutableSource:Ee,useSyncExternalStore:Ee,useId:Ee,unstable_isNewReconciler:!1},Rg={readContext:Ze,useCallback:function(e,t){return mt().memoizedState=[e,t===void 0?null:t],e},useContext:Ze,useEffect:mu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Lr(4194308,4,Fd.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lr(4,2,e,t)},useMemo:function(e,t){var n=mt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=mt();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=kg.bind(null,ae,e),[i.memoizedState,e]},useRef:function(e){var t=mt();return e={current:e},t.memoizedState=e},useState:hu,useDebugValue:Ja,useDeferredValue:function(e){return mt().memoizedState=e},useTransition:function(){var e=hu(!1),t=e[0];return e=Pg.bind(null,e[1]),mt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=ae,r=mt();if(ne){if(n===void 0)throw Error(P(407));n=n()}else{if(n=t(),ye===null)throw Error(P(349));pn&30||Ed(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,mu(zd.bind(null,i,s,e),[e]),i.flags|=2048,Ki(9,Td.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=mt(),t=ye.identifierPrefix;if(ne){var n=Ct,i=St;n=(i&~(1<<32-lt(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=$i++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=zg++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Dg={readContext:Ze,useCallback:Id,useContext:Ze,useEffect:qa,useImperativeHandle:Nd,useInsertionEffect:Rd,useLayoutEffect:Dd,useMemo:Bd,useReducer:co,useRef:Md,useState:function(){return co(Xi)},useDebugValue:Ja,useDeferredValue:function(e){var t=qe();return Ad(t,pe.memoizedState,e)},useTransition:function(){var e=co(Xi)[0],t=qe().memoizedState;return[e,t]},useMutableSource:Sd,useSyncExternalStore:Cd,useId:bd,unstable_isNewReconciler:!1},Fg={readContext:Ze,useCallback:Id,useContext:Ze,useEffect:qa,useImperativeHandle:Nd,useInsertionEffect:Rd,useLayoutEffect:Dd,useMemo:Bd,useReducer:fo,useRef:Md,useState:function(){return fo(Xi)},useDebugValue:Ja,useDeferredValue:function(e){var t=qe();return pe===null?t.memoizedState=e:Ad(t,pe.memoizedState,e)},useTransition:function(){var e=fo(Xi)[0],t=qe().memoizedState;return[e,t]},useMutableSource:Sd,useSyncExternalStore:Cd,useId:bd,unstable_isNewReconciler:!1};function rt(e,t){if(e&&e.defaultProps){t=le({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Zo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:le({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ks={isMounted:function(e){return(e=e._reactInternals)?_n(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Me(),r=Xt(e),s=Et(i,r);s.payload=t,n!=null&&(s.callback=n),t=Ht(e,s,r),t!==null&&(ut(t,e,r,i),Ar(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Me(),r=Xt(e),s=Et(i,r);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Ht(e,s,r),t!==null&&(ut(t,e,r,i),Ar(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Me(),i=Xt(e),r=Et(n,i);r.tag=2,t!=null&&(r.callback=t),t=Ht(e,r,i),t!==null&&(ut(t,e,i,n),Ar(t,e,i))}};function pu(e,t,n,i,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,o):t.prototype&&t.prototype.isPureReactComponent?!ji(n,i)||!ji(r,s):!0}function Od(e,t,n){var i=!1,r=Qt,s=t.contextType;return typeof s=="object"&&s!==null?s=Ze(s):(r=Ae(t)?hn:Pe.current,i=t.contextTypes,s=(i=i!=null)?Xn(e,r):Qt),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ks,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function vu(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ks.enqueueReplaceState(t,t.state,null)}function qo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ha(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=Ze(s):(s=Ae(t)?hn:Pe.current,r.context=Xn(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Zo(e,t,s,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&ks.enqueueReplaceState(r,r.state,null),ls(e,n,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Zn(e,t){try{var n="",i=t;do n+=o1(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Jo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Ng=typeof WeakMap=="function"?WeakMap:Map;function Vd(e,t,n){n=Et(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){hs||(hs=!0,ua=i),Jo(e,t)},n}function Gd(e,t,n){n=Et(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){Jo(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Jo(e,t),typeof i!="function"&&($t===null?$t=new Set([this]):$t.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function gu(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new Ng;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Xg.bind(null,e,t,n),t.then(e,e))}function yu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function xu(e,t,n,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Et(-1,1),t.tag=2,Ht(n,t,1))),n.lanes|=1),e)}var Ig=Rt.ReactCurrentOwner,Ie=!1;function ke(e,t,n,i){t.child=e===null?yd(t,null,n,i):Yn(t,e.child,n,i)}function _u(e,t,n,i,r){n=n.render;var s=t.ref;return Gn(t,r),i=Qa(e,t,n,i,s,r),n=Za(),e!==null&&!Ie?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,kt(e,t,r)):(ne&&n&&La(t),t.flags|=1,ke(e,t,i,r),t.child)}function wu(e,t,n,i,r){if(e===null){var s=n.type;return typeof s=="function"&&!al(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Wd(e,t,s,i,r)):(e=Vr(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ji,n(o,i)&&e.ref===t.ref)return kt(e,t,r)}return t.flags|=1,e=Kt(s,i),e.ref=t.ref,e.return=t,t.child=e}function Wd(e,t,n,i,r){if(e!==null){var s=e.memoizedProps;if(ji(s,i)&&e.ref===t.ref)if(Ie=!1,t.pendingProps=i=s,(e.lanes&r)!==0)e.flags&131072&&(Ie=!0);else return t.lanes=e.lanes,kt(e,t,r)}return ea(e,t,n,i,r)}function Hd(e,t,n){var i=t.pendingProps,r=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},q(bn,je),je|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,q(bn,je),je|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,q(bn,je),je|=i}else s!==null?(i=s.baseLanes|n,t.memoizedState=null):i=n,q(bn,je),je|=i;return ke(e,t,r,n),t.child}function $d(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ea(e,t,n,i,r){var s=Ae(n)?hn:Pe.current;return s=Xn(t,s),Gn(t,r),n=Qa(e,t,n,i,s,r),i=Za(),e!==null&&!Ie?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,kt(e,t,r)):(ne&&i&&La(t),t.flags|=1,ke(e,t,n,r),t.child)}function Su(e,t,n,i,r){if(Ae(n)){var s=!0;is(t)}else s=!1;if(Gn(t,r),t.stateNode===null)Ur(e,t),Od(t,n,i),qo(t,n,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ze(u):(u=Ae(n)?hn:Pe.current,u=Xn(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&vu(t,o,i,u),At=!1;var f=t.memoizedState;o.state=f,ls(t,i,o,r),l=t.memoizedState,a!==i||f!==l||Be.current||At?(typeof d=="function"&&(Zo(t,n,d,i),l=t.memoizedState),(a=At||pu(t,n,a,i,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,_d(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:rt(t.type,a),o.props=u,h=t.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ze(l):(l=Ae(n)?hn:Pe.current,l=Xn(t,l));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&vu(t,o,i,l),At=!1,f=t.memoizedState,o.state=f,ls(t,i,o,r);var x=t.memoizedState;a!==h||f!==x||Be.current||At?(typeof v=="function"&&(Zo(t,n,v,i),x=t.memoizedState),(u=At||pu(t,n,u,i,f,x,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,x,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=x),o.props=i,o.state=x,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return ta(e,t,n,i,s,r)}function ta(e,t,n,i,r,s){$d(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&au(t,n,!1),kt(e,t,s);i=t.stateNode,Ig.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=Yn(t,e.child,null,s),t.child=Yn(t,null,a,s)):ke(e,t,a,s),t.memoizedState=i.state,r&&au(t,n,!0),t.child}function Xd(e){var t=e.stateNode;t.pendingContext?ou(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ou(e,t.context,!1),$a(e,t.containerInfo)}function Cu(e,t,n,i,r){return Kn(),ja(r),t.flags|=256,ke(e,t,n,i),t.child}var na={dehydrated:null,treeContext:null,retryLane:0};function ia(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kd(e,t,n){var i=t.pendingProps,r=se.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),q(se,r&1),e===null)return Yo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,s?(i=t.mode,s=t.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Ds(o,i,0,null),e=dn(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ia(n),t.memoizedState=na,e):el(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Bg(e,t,o,i,a,r,n);if(s){s=i.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=Kt(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Kt(a,s):(s=dn(s,o,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,o=e.child.memoizedState,o=o===null?ia(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=na,i}return s=e.child,e=s.sibling,i=Kt(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function el(e,t){return t=Ds({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cr(e,t,n,i){return i!==null&&ja(i),Yn(t,e.child,null,n),e=el(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Bg(e,t,n,i,r,s,o){if(n)return t.flags&256?(t.flags&=-257,i=ho(Error(P(422))),Cr(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=Ds({mode:"visible",children:i.children},r,0,null),s=dn(s,r,o,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&Yn(t,e.child,null,o),t.child.memoizedState=ia(o),t.memoizedState=na,s);if(!(t.mode&1))return Cr(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(P(419)),i=ho(s,i,void 0),Cr(e,t,o,i)}if(a=(o&e.childLanes)!==0,Ie||a){if(i=ye,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Pt(e,r),ut(i,e,r,-1))}return ol(),i=ho(Error(P(421))),Cr(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=Kg.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,Oe=Wt(r.nextSibling),Ve=t,ne=!0,ot=null,e!==null&&($e[Xe++]=St,$e[Xe++]=Ct,$e[Xe++]=mn,St=e.id,Ct=e.overflow,mn=t),t=el(t,i.children),t.flags|=4096,t)}function Eu(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Qo(e.return,t,n)}function mo(e,t,n,i,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Yd(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(ke(e,t,i.children,n),i=se.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Eu(e,n,t);else if(e.tag===19)Eu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(q(se,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&us(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),mo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&us(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}mo(t,!0,n,null,s);break;case"together":mo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ur(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),vn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(P(153));if(t.child!==null){for(e=t.child,n=Kt(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kt(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Ag(e,t,n){switch(t.tag){case 3:Xd(t),Kn();break;case 5:wd(t);break;case 1:Ae(t.type)&&is(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;q(os,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(q(se,se.current&1),t.flags|=128,null):n&t.child.childLanes?Kd(e,t,n):(q(se,se.current&1),e=kt(e,t,n),e!==null?e.sibling:null);q(se,se.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return Yd(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),q(se,se.current),i)break;return null;case 22:case 23:return t.lanes=0,Hd(e,t,n)}return kt(e,t,n)}var Qd,ra,Zd,qd;Qd=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ra=function(){};Zd=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,un(yt.current);var s=null;switch(n){case"input":r=zo(e,r),i=zo(e,i),s=[];break;case"select":r=le({},r,{value:void 0}),i=le({},i,{value:void 0}),s=[];break;case"textarea":r=Mo(e,r),i=Mo(e,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=ts)}Do(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ni.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ni.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&J("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};qd=function(e,t,n,i){n!==i&&(t.flags|=4)};function gi(e,t){if(!ne)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Te(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function bg(e,t,n){var i=t.pendingProps;switch(Ua(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Te(t),null;case 1:return Ae(t.type)&&ns(),Te(t),null;case 3:return i=t.stateNode,Qn(),ee(Be),ee(Pe),Ka(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(wr(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ot!==null&&(fa(ot),ot=null))),ra(e,t),Te(t),null;case 5:Xa(t);var r=un(Hi.current);if(n=t.type,e!==null&&t.stateNode!=null)Zd(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(P(166));return Te(t),null}if(e=un(yt.current),wr(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[pt]=t,i[Gi]=s,e=(t.mode&1)!==0,n){case"dialog":J("cancel",i),J("close",i);break;case"iframe":case"object":case"embed":J("load",i);break;case"video":case"audio":for(r=0;r<Ci.length;r++)J(Ci[r],i);break;case"source":J("error",i);break;case"img":case"image":case"link":J("error",i),J("load",i);break;case"details":J("toggle",i);break;case"input":Nl(i,s),J("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},J("invalid",i);break;case"textarea":Bl(i,s),J("invalid",i)}Do(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&_r(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&_r(i.textContent,a,e),r=["children",""+a]):Ni.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&J("scroll",i)}switch(n){case"input":fr(i),Il(i,s,!0);break;case"textarea":fr(i),Al(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=ts)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(n,{is:i.is}):(e=o.createElement(n),n==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,n),e[pt]=t,e[Gi]=i,Qd(e,t,!1,!1),t.stateNode=e;e:{switch(o=Fo(n,i),n){case"dialog":J("cancel",e),J("close",e),r=i;break;case"iframe":case"object":case"embed":J("load",e),r=i;break;case"video":case"audio":for(r=0;r<Ci.length;r++)J(Ci[r],e);r=i;break;case"source":J("error",e),r=i;break;case"img":case"image":case"link":J("error",e),J("load",e),r=i;break;case"details":J("toggle",e),r=i;break;case"input":Nl(e,i),r=zo(e,i),J("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=le({},i,{value:void 0}),J("invalid",e);break;case"textarea":Bl(e,i),r=Mo(e,i),J("invalid",e);break;default:r=i}Do(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Mc(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Pc(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ii(e,l):typeof l=="number"&&Ii(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ni.hasOwnProperty(s)?l!=null&&s==="onScroll"&&J("scroll",e):l!=null&&Ea(e,s,l,o))}switch(n){case"input":fr(e),Il(e,i,!1);break;case"textarea":fr(e),Al(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Yt(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?Un(e,!!i.multiple,s,!1):i.defaultValue!=null&&Un(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=ts)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Te(t),null;case 6:if(e&&t.stateNode!=null)qd(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(P(166));if(n=un(Hi.current),un(yt.current),wr(t)){if(i=t.stateNode,n=t.memoizedProps,i[pt]=t,(s=i.nodeValue!==n)&&(e=Ve,e!==null))switch(e.tag){case 3:_r(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&_r(i.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[pt]=t,t.stateNode=i}return Te(t),null;case 13:if(ee(se),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ne&&Oe!==null&&t.mode&1&&!(t.flags&128))vd(),Kn(),t.flags|=98560,s=!1;else if(s=wr(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(P(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(P(317));s[pt]=t}else Kn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Te(t),s=!1}else ot!==null&&(fa(ot),ot=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||se.current&1?ve===0&&(ve=3):ol())),t.updateQueue!==null&&(t.flags|=4),Te(t),null);case 4:return Qn(),ra(e,t),e===null&&Oi(t.stateNode.containerInfo),Te(t),null;case 10:return Ga(t.type._context),Te(t),null;case 17:return Ae(t.type)&&ns(),Te(t),null;case 19:if(ee(se),s=t.memoizedState,s===null)return Te(t),null;if(i=(t.flags&128)!==0,o=s.rendering,o===null)if(i)gi(s,!1);else{if(ve!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=us(e),o!==null){for(t.flags|=128,gi(s,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)s=n,e=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return q(se,se.current&1|2),t.child}e=e.sibling}s.tail!==null&&de()>qn&&(t.flags|=128,i=!0,gi(s,!1),t.lanes=4194304)}else{if(!i)if(e=us(o),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),gi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ne)return Te(t),null}else 2*de()-s.renderingStartTime>qn&&n!==1073741824&&(t.flags|=128,i=!0,gi(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=de(),t.sibling=null,n=se.current,q(se,i?n&1|2:n&1),t):(Te(t),null);case 22:case 23:return sl(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?je&1073741824&&(Te(t),t.subtreeFlags&6&&(t.flags|=8192)):Te(t),null;case 24:return null;case 25:return null}throw Error(P(156,t.tag))}function Lg(e,t){switch(Ua(t),t.tag){case 1:return Ae(t.type)&&ns(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qn(),ee(Be),ee(Pe),Ka(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Xa(t),null;case 13:if(ee(se),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(P(340));Kn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ee(se),null;case 4:return Qn(),null;case 10:return Ga(t.type._context),null;case 22:case 23:return sl(),null;case 24:return null;default:return null}}var Er=!1,ze=!1,Ug=typeof WeakSet=="function"?WeakSet:Set,I=null;function An(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ue(e,t,i)}else n.current=null}function sa(e,t,n){try{n()}catch(i){ue(e,t,i)}}var Tu=!1;function jg(e,t){if(Vo=qr,e=id(),ba(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var v;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==s||i!==0&&h.nodeType!==3||(l=o+i),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)f=h,h=v;for(;;){if(h===e)break t;if(f===n&&++u===r&&(a=o),f===s&&++d===i&&(l=o),(v=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Go={focusedElem:e,selectionRange:n},qr=!1,I=t;I!==null;)if(t=I,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,I=e;else for(;I!==null;){t=I;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,z=x.memoizedState,g=t.stateNode,p=g.getSnapshotBeforeUpdate(t.elementType===t.type?_:rt(t.type,_),z);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(w){ue(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,I=e;break}I=t.return}return x=Tu,Tu=!1,x}function Ri(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&sa(t,n,s)}r=r.next}while(r!==i)}}function Ms(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function oa(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Jd(e){var t=e.alternate;t!==null&&(e.alternate=null,Jd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[pt],delete t[Gi],delete t[$o],delete t[Sg],delete t[Cg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ef(e){return e.tag===5||e.tag===3||e.tag===4}function zu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ef(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function aa(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ts));else if(i!==4&&(e=e.child,e!==null))for(aa(e,t,n),e=e.sibling;e!==null;)aa(e,t,n),e=e.sibling}function la(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(la(e,t,n),e=e.sibling;e!==null;)la(e,t,n),e=e.sibling}var xe=null,st=!1;function Ft(e,t,n){for(n=n.child;n!==null;)tf(e,t,n),n=n.sibling}function tf(e,t,n){if(gt&&typeof gt.onCommitFiberUnmount=="function")try{gt.onCommitFiberUnmount(ws,n)}catch{}switch(n.tag){case 5:ze||An(n,t);case 6:var i=xe,r=st;xe=null,Ft(e,t,n),xe=i,st=r,xe!==null&&(st?(e=xe,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xe.removeChild(n.stateNode));break;case 18:xe!==null&&(st?(e=xe,n=n.stateNode,e.nodeType===8?oo(e.parentNode,n):e.nodeType===1&&oo(e,n),Li(e)):oo(xe,n.stateNode));break;case 4:i=xe,r=st,xe=n.stateNode.containerInfo,st=!0,Ft(e,t,n),xe=i,st=r;break;case 0:case 11:case 14:case 15:if(!ze&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&sa(n,t,o),r=r.next}while(r!==i)}Ft(e,t,n);break;case 1:if(!ze&&(An(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){ue(n,t,a)}Ft(e,t,n);break;case 21:Ft(e,t,n);break;case 22:n.mode&1?(ze=(i=ze)||n.memoizedState!==null,Ft(e,t,n),ze=i):Ft(e,t,n);break;default:Ft(e,t,n)}}function Pu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ug),t.forEach(function(i){var r=Yg.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}}function it(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:xe=a.stateNode,st=!1;break e;case 3:xe=a.stateNode.containerInfo,st=!0;break e;case 4:xe=a.stateNode.containerInfo,st=!0;break e}a=a.return}if(xe===null)throw Error(P(160));tf(s,o,r),xe=null,st=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){ue(r,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)nf(t,e),t=t.sibling}function nf(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(it(t,e),ht(e),i&4){try{Ri(3,e,e.return),Ms(3,e)}catch(_){ue(e,e.return,_)}try{Ri(5,e,e.return)}catch(_){ue(e,e.return,_)}}break;case 1:it(t,e),ht(e),i&512&&n!==null&&An(n,n.return);break;case 5:if(it(t,e),ht(e),i&512&&n!==null&&An(n,n.return),e.flags&32){var r=e.stateNode;try{Ii(r,"")}catch(_){ue(e,e.return,_)}}if(i&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Ec(r,s),Fo(a,o);var u=Fo(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?Mc(r,h):d==="dangerouslySetInnerHTML"?Pc(r,h):d==="children"?Ii(r,h):Ea(r,d,h,u)}switch(a){case"input":Po(r,s);break;case"textarea":Tc(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Un(r,!!s.multiple,v,!1):f!==!!s.multiple&&(s.defaultValue!=null?Un(r,!!s.multiple,s.defaultValue,!0):Un(r,!!s.multiple,s.multiple?[]:"",!1))}r[Gi]=s}catch(_){ue(e,e.return,_)}}break;case 6:if(it(t,e),ht(e),i&4){if(e.stateNode===null)throw Error(P(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(_){ue(e,e.return,_)}}break;case 3:if(it(t,e),ht(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Li(t.containerInfo)}catch(_){ue(e,e.return,_)}break;case 4:it(t,e),ht(e);break;case 13:it(t,e),ht(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(il=de())),i&4&&Pu(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(ze=(u=ze)||d,it(t,e),ze=u):it(t,e),ht(e),i&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(I=e,d=e.child;d!==null;){for(h=I=d;I!==null;){switch(f=I,v=f.child,f.tag){case 0:case 11:case 14:case 15:Ri(4,f,f.return);break;case 1:An(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){i=f,n=f.return;try{t=i,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(_){ue(i,n,_)}}break;case 5:An(f,f.return);break;case 22:if(f.memoizedState!==null){Mu(h);continue}}v!==null?(v.return=f,I=v):Mu(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=kc("display",o))}catch(_){ue(e,e.return,_)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){ue(e,e.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:it(t,e),ht(e),i&4&&Pu(e);break;case 21:break;default:it(t,e),ht(e)}}function ht(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(ef(n)){var i=n;break e}n=n.return}throw Error(P(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Ii(r,""),i.flags&=-33);var s=zu(e);la(e,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=zu(e);aa(e,a,o);break;default:throw Error(P(161))}}catch(l){ue(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Og(e,t,n){I=e,rf(e)}function rf(e,t,n){for(var i=(e.mode&1)!==0;I!==null;){var r=I,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Er;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||ze;a=Er;var u=ze;if(Er=o,(ze=l)&&!u)for(I=r;I!==null;)o=I,l=o.child,o.tag===22&&o.memoizedState!==null?Ru(r):l!==null?(l.return=o,I=l):Ru(r);for(;s!==null;)I=s,rf(s),s=s.sibling;I=r,Er=a,ze=u}ku(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,I=s):ku(e)}}function ku(e){for(;I!==null;){var t=I;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ze||Ms(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!ze)if(n===null)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:rt(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&fu(t,s,i);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}fu(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Li(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}ze||t.flags&512&&oa(t)}catch(f){ue(t,t.return,f)}}if(t===e){I=null;break}if(n=t.sibling,n!==null){n.return=t.return,I=n;break}I=t.return}}function Mu(e){for(;I!==null;){var t=I;if(t===e){I=null;break}var n=t.sibling;if(n!==null){n.return=t.return,I=n;break}I=t.return}}function Ru(e){for(;I!==null;){var t=I;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ms(4,t)}catch(l){ue(t,n,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(l){ue(t,r,l)}}var s=t.return;try{oa(t)}catch(l){ue(t,s,l)}break;case 5:var o=t.return;try{oa(t)}catch(l){ue(t,o,l)}}}catch(l){ue(t,t.return,l)}if(t===e){I=null;break}var a=t.sibling;if(a!==null){a.return=t.return,I=a;break}I=t.return}}var Vg=Math.ceil,fs=Rt.ReactCurrentDispatcher,tl=Rt.ReactCurrentOwner,Qe=Rt.ReactCurrentBatchConfig,$=0,ye=null,he=null,_e=0,je=0,bn=qt(0),ve=0,Yi=null,vn=0,Rs=0,nl=0,Di=null,Ne=null,il=0,qn=1/0,_t=null,hs=!1,ua=null,$t=null,Tr=!1,jt=null,ms=0,Fi=0,ca=null,jr=-1,Or=0;function Me(){return $&6?de():jr!==-1?jr:jr=de()}function Xt(e){return e.mode&1?$&2&&_e!==0?_e&-_e:Tg.transition!==null?(Or===0&&(Or=Oc()),Or):(e=Y,e!==0||(e=window.event,e=e===void 0?16:Kc(e.type)),e):1}function ut(e,t,n,i){if(50<Fi)throw Fi=0,ca=null,Error(P(185));Ji(e,n,i),(!($&2)||e!==ye)&&(e===ye&&(!($&2)&&(Rs|=n),ve===4&&Lt(e,_e)),be(e,i),n===1&&$===0&&!(t.mode&1)&&(qn=de()+500,zs&&Jt()))}function be(e,t){var n=e.callbackNode;T1(e,t);var i=Zr(e,e===ye?_e:0);if(i===0)n!==null&&Ul(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&Ul(n),t===1)e.tag===0?Eg(Du.bind(null,e)):hd(Du.bind(null,e)),_g(function(){!($&6)&&Jt()}),n=null;else{switch(Vc(i)){case 1:n=Ma;break;case 4:n=Uc;break;case 16:n=Qr;break;case 536870912:n=jc;break;default:n=Qr}n=ff(n,sf.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sf(e,t){if(jr=-1,Or=0,$&6)throw Error(P(327));var n=e.callbackNode;if(Wn()&&e.callbackNode!==n)return null;var i=Zr(e,e===ye?_e:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=ps(e,i);else{t=i;var r=$;$|=2;var s=af();(ye!==e||_e!==t)&&(_t=null,qn=de()+500,cn(e,t));do try{Hg();break}catch(a){of(e,a)}while(!0);Va(),fs.current=s,$=r,he!==null?t=0:(ye=null,_e=0,t=ve)}if(t!==0){if(t===2&&(r=bo(e),r!==0&&(i=r,t=da(e,r))),t===1)throw n=Yi,cn(e,0),Lt(e,i),be(e,de()),n;if(t===6)Lt(e,i);else{if(r=e.current.alternate,!(i&30)&&!Gg(r)&&(t=ps(e,i),t===2&&(s=bo(e),s!==0&&(i=s,t=da(e,s))),t===1))throw n=Yi,cn(e,0),Lt(e,i),be(e,de()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(P(345));case 2:on(e,Ne,_t);break;case 3:if(Lt(e,i),(i&130023424)===i&&(t=il+500-de(),10<t)){if(Zr(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){Me(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Ho(on.bind(null,e,Ne,_t),t);break}on(e,Ne,_t);break;case 4:if(Lt(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-lt(i);s=1<<o,o=t[o],o>r&&(r=o),i&=~s}if(i=r,i=de()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Vg(i/1960))-i,10<i){e.timeoutHandle=Ho(on.bind(null,e,Ne,_t),i);break}on(e,Ne,_t);break;case 5:on(e,Ne,_t);break;default:throw Error(P(329))}}}return be(e,de()),e.callbackNode===n?sf.bind(null,e):null}function da(e,t){var n=Di;return e.current.memoizedState.isDehydrated&&(cn(e,t).flags|=256),e=ps(e,t),e!==2&&(t=Ne,Ne=n,t!==null&&fa(t)),e}function fa(e){Ne===null?Ne=e:Ne.push.apply(Ne,e)}function Gg(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!dt(s(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Lt(e,t){for(t&=~nl,t&=~Rs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-lt(t),i=1<<n;e[n]=-1,t&=~i}}function Du(e){if($&6)throw Error(P(327));Wn();var t=Zr(e,0);if(!(t&1))return be(e,de()),null;var n=ps(e,t);if(e.tag!==0&&n===2){var i=bo(e);i!==0&&(t=i,n=da(e,i))}if(n===1)throw n=Yi,cn(e,0),Lt(e,t),be(e,de()),n;if(n===6)throw Error(P(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,on(e,Ne,_t),be(e,de()),null}function rl(e,t){var n=$;$|=1;try{return e(t)}finally{$=n,$===0&&(qn=de()+500,zs&&Jt())}}function gn(e){jt!==null&&jt.tag===0&&!($&6)&&Wn();var t=$;$|=1;var n=Qe.transition,i=Y;try{if(Qe.transition=null,Y=1,e)return e()}finally{Y=i,Qe.transition=n,$=t,!($&6)&&Jt()}}function sl(){je=bn.current,ee(bn)}function cn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,xg(n)),he!==null)for(n=he.return;n!==null;){var i=n;switch(Ua(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&ns();break;case 3:Qn(),ee(Be),ee(Pe),Ka();break;case 5:Xa(i);break;case 4:Qn();break;case 13:ee(se);break;case 19:ee(se);break;case 10:Ga(i.type._context);break;case 22:case 23:sl()}n=n.return}if(ye=e,he=e=Kt(e.current,null),_e=je=t,ve=0,Yi=null,nl=Rs=vn=0,Ne=Di=null,ln!==null){for(t=0;t<ln.length;t++)if(n=ln[t],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}ln=null}return e}function of(e,t){do{var n=he;try{if(Va(),br.current=ds,cs){for(var i=ae.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}cs=!1}if(pn=0,ge=pe=ae=null,Mi=!1,$i=0,tl.current=null,n===null||n.return===null){ve=1,Yi=t,he=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=_e,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=yu(o);if(v!==null){v.flags&=-257,xu(v,o,a,s,t),v.mode&1&&gu(s,u,t),t=v,l=u;var x=t.updateQueue;if(x===null){var _=new Set;_.add(l),t.updateQueue=_}else x.add(l);break e}else{if(!(t&1)){gu(s,u,t),ol();break e}l=Error(P(426))}}else if(ne&&a.mode&1){var z=yu(o);if(z!==null){!(z.flags&65536)&&(z.flags|=256),xu(z,o,a,s,t),ja(Zn(l,a));break e}}s=l=Zn(l,a),ve!==4&&(ve=2),Di===null?Di=[s]:Di.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=Vd(s,l,t);du(s,g);break e;case 1:a=l;var p=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&($t===null||!$t.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=Gd(s,a,t);du(s,w);break e}}s=s.return}while(s!==null)}uf(n)}catch(E){t=E,he===n&&n!==null&&(he=n=n.return);continue}break}while(!0)}function af(){var e=fs.current;return fs.current=ds,e===null?ds:e}function ol(){(ve===0||ve===3||ve===2)&&(ve=4),ye===null||!(vn&268435455)&&!(Rs&268435455)||Lt(ye,_e)}function ps(e,t){var n=$;$|=2;var i=af();(ye!==e||_e!==t)&&(_t=null,cn(e,t));do try{Wg();break}catch(r){of(e,r)}while(!0);if(Va(),$=n,fs.current=i,he!==null)throw Error(P(261));return ye=null,_e=0,ve}function Wg(){for(;he!==null;)lf(he)}function Hg(){for(;he!==null&&!v1();)lf(he)}function lf(e){var t=df(e.alternate,e,je);e.memoizedProps=e.pendingProps,t===null?uf(e):he=t,tl.current=null}function uf(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lg(n,t),n!==null){n.flags&=32767,he=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ve=6,he=null;return}}else if(n=bg(n,t,je),n!==null){he=n;return}if(t=t.sibling,t!==null){he=t;return}he=t=e}while(t!==null);ve===0&&(ve=5)}function on(e,t,n){var i=Y,r=Qe.transition;try{Qe.transition=null,Y=1,$g(e,t,n,i)}finally{Qe.transition=r,Y=i}return null}function $g(e,t,n,i){do Wn();while(jt!==null);if($&6)throw Error(P(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(P(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(z1(e,s),e===ye&&(he=ye=null,_e=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Tr||(Tr=!0,ff(Qr,function(){return Wn(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Qe.transition,Qe.transition=null;var o=Y;Y=1;var a=$;$|=4,tl.current=null,jg(e,n),nf(n,e),fg(Go),qr=!!Vo,Go=Vo=null,e.current=n,Og(n),g1(),$=a,Y=o,Qe.transition=s}else e.current=n;if(Tr&&(Tr=!1,jt=e,ms=r),s=e.pendingLanes,s===0&&($t=null),_1(n.stateNode),be(e,de()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(hs)throw hs=!1,e=ua,ua=null,e;return ms&1&&e.tag!==0&&Wn(),s=e.pendingLanes,s&1?e===ca?Fi++:(Fi=0,ca=e):Fi=0,Jt(),null}function Wn(){if(jt!==null){var e=Vc(ms),t=Qe.transition,n=Y;try{if(Qe.transition=null,Y=16>e?16:e,jt===null)var i=!1;else{if(e=jt,jt=null,ms=0,$&6)throw Error(P(331));var r=$;for($|=4,I=e.current;I!==null;){var s=I,o=s.child;if(I.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(I=u;I!==null;){var d=I;switch(d.tag){case 0:case 11:case 15:Ri(8,d,s)}var h=d.child;if(h!==null)h.return=d,I=h;else for(;I!==null;){d=I;var f=d.sibling,v=d.return;if(Jd(d),d===u){I=null;break}if(f!==null){f.return=v,I=f;break}I=v}}}var x=s.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var z=_.sibling;_.sibling=null,_=z}while(_!==null)}}I=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,I=o;else e:for(;I!==null;){if(s=I,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ri(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,I=g;break e}I=s.return}}var p=e.current;for(I=p;I!==null;){o=I;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,I=y;else e:for(o=p;I!==null;){if(a=I,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ms(9,a)}}catch(E){ue(a,a.return,E)}if(a===o){I=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,I=w;break e}I=a.return}}if($=r,Jt(),gt&&typeof gt.onPostCommitFiberRoot=="function")try{gt.onPostCommitFiberRoot(ws,e)}catch{}i=!0}return i}finally{Y=n,Qe.transition=t}}return!1}function Fu(e,t,n){t=Zn(n,t),t=Vd(e,t,1),e=Ht(e,t,1),t=Me(),e!==null&&(Ji(e,1,t),be(e,t))}function ue(e,t,n){if(e.tag===3)Fu(e,e,n);else for(;t!==null;){if(t.tag===3){Fu(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&($t===null||!$t.has(i))){e=Zn(n,e),e=Gd(t,e,1),t=Ht(t,e,1),e=Me(),t!==null&&(Ji(t,1,e),be(t,e));break}}t=t.return}}function Xg(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Me(),e.pingedLanes|=e.suspendedLanes&n,ye===e&&(_e&n)===n&&(ve===4||ve===3&&(_e&130023424)===_e&&500>de()-il?cn(e,0):nl|=n),be(e,t)}function cf(e,t){t===0&&(e.mode&1?(t=pr,pr<<=1,!(pr&130023424)&&(pr=4194304)):t=1);var n=Me();e=Pt(e,t),e!==null&&(Ji(e,t,n),be(e,n))}function Kg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),cf(e,n)}function Yg(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(P(314))}i!==null&&i.delete(t),cf(e,n)}var df;df=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Be.current)Ie=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ie=!1,Ag(e,t,n);Ie=!!(e.flags&131072)}else Ie=!1,ne&&t.flags&1048576&&md(t,ss,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ur(e,t),e=t.pendingProps;var r=Xn(t,Pe.current);Gn(t,n),r=Qa(null,t,i,e,r,n);var s=Za();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ae(i)?(s=!0,is(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Ha(t),r.updater=ks,t.stateNode=r,r._reactInternals=t,qo(t,i,e,n),t=ta(null,t,i,!0,s,n)):(t.tag=0,ne&&s&&La(t),ke(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ur(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=Zg(i),e=rt(i,e),r){case 0:t=ea(null,t,i,e,n);break e;case 1:t=Su(null,t,i,e,n);break e;case 11:t=_u(null,t,i,e,n);break e;case 14:t=wu(null,t,i,rt(i.type,e),n);break e}throw Error(P(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rt(i,r),ea(e,t,i,r,n);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rt(i,r),Su(e,t,i,r,n);case 3:e:{if(Xd(t),e===null)throw Error(P(387));i=t.pendingProps,s=t.memoizedState,r=s.element,_d(e,t),ls(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=Zn(Error(P(423)),t),t=Cu(e,t,i,n,r);break e}else if(i!==r){r=Zn(Error(P(424)),t),t=Cu(e,t,i,n,r);break e}else for(Oe=Wt(t.stateNode.containerInfo.firstChild),Ve=t,ne=!0,ot=null,n=yd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kn(),i===r){t=kt(e,t,n);break e}ke(e,t,i,n)}t=t.child}return t;case 5:return wd(t),e===null&&Yo(t),i=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,o=r.children,Wo(i,r)?o=null:s!==null&&Wo(i,s)&&(t.flags|=32),$d(e,t),ke(e,t,o,n),t.child;case 6:return e===null&&Yo(t),null;case 13:return Kd(e,t,n);case 4:return $a(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Yn(t,null,i,n):ke(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rt(i,r),_u(e,t,i,r,n);case 7:return ke(e,t,t.pendingProps,n),t.child;case 8:return ke(e,t,t.pendingProps.children,n),t.child;case 12:return ke(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,q(os,i._currentValue),i._currentValue=o,s!==null)if(dt(s.value,o)){if(s.children===r.children&&!Be.current){t=kt(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Et(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Qo(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(P(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Qo(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ke(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Gn(t,n),r=Ze(r),i=i(r),t.flags|=1,ke(e,t,i,n),t.child;case 14:return i=t.type,r=rt(i,t.pendingProps),r=rt(i.type,r),wu(e,t,i,r,n);case 15:return Wd(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rt(i,r),Ur(e,t),t.tag=1,Ae(i)?(e=!0,is(t)):e=!1,Gn(t,n),Od(t,i,r),qo(t,i,r,n),ta(null,t,i,!0,e,n);case 19:return Yd(e,t,n);case 22:return Hd(e,t,n)}throw Error(P(156,t.tag))};function ff(e,t){return Lc(e,t)}function Qg(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ye(e,t,n,i){return new Qg(e,t,n,i)}function al(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zg(e){if(typeof e=="function")return al(e)?1:0;if(e!=null){if(e=e.$$typeof,e===za)return 11;if(e===Pa)return 14}return 2}function Kt(e,t){var n=e.alternate;return n===null?(n=Ye(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Vr(e,t,n,i,r,s){var o=2;if(i=e,typeof e=="function")al(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Pn:return dn(n.children,r,s,t);case Ta:o=8,r|=8;break;case So:return e=Ye(12,n,t,r|2),e.elementType=So,e.lanes=s,e;case Co:return e=Ye(13,n,t,r),e.elementType=Co,e.lanes=s,e;case Eo:return e=Ye(19,n,t,r),e.elementType=Eo,e.lanes=s,e;case wc:return Ds(n,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case xc:o=10;break e;case _c:o=9;break e;case za:o=11;break e;case Pa:o=14;break e;case Bt:o=16,i=null;break e}throw Error(P(130,e==null?e:typeof e,""))}return t=Ye(o,n,t,r),t.elementType=e,t.type=i,t.lanes=s,t}function dn(e,t,n,i){return e=Ye(7,e,i,t),e.lanes=n,e}function Ds(e,t,n,i){return e=Ye(22,e,i,t),e.elementType=wc,e.lanes=n,e.stateNode={isHidden:!1},e}function po(e,t,n){return e=Ye(6,e,null,t),e.lanes=n,e}function vo(e,t,n){return t=Ye(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qg(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ys(0),this.expirationTimes=Ys(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ys(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ll(e,t,n,i,r,s,o,a,l){return e=new qg(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ye(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ha(s),e}function Jg(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zn,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function hf(e){if(!e)return Qt;e=e._reactInternals;e:{if(_n(e)!==e||e.tag!==1)throw Error(P(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ae(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(P(171))}if(e.tag===1){var n=e.type;if(Ae(n))return fd(e,n,t)}return t}function mf(e,t,n,i,r,s,o,a,l){return e=ll(n,i,!0,e,r,s,o,a,l),e.context=hf(null),n=e.current,i=Me(),r=Xt(n),s=Et(i,r),s.callback=t??null,Ht(n,s,r),e.current.lanes=r,Ji(e,r,i),be(e,i),e}function Fs(e,t,n,i){var r=t.current,s=Me(),o=Xt(r);return n=hf(n),t.context===null?t.context=n:t.pendingContext=n,t=Et(s,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Ht(r,t,o),e!==null&&(ut(e,r,o,s),Ar(e,r,o)),o}function vs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ul(e,t){Nu(e,t),(e=e.alternate)&&Nu(e,t)}function ey(){return null}var pf=typeof reportError=="function"?reportError:function(e){console.error(e)};function cl(e){this._internalRoot=e}Ns.prototype.render=cl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(P(409));Fs(e,t,null,null)};Ns.prototype.unmount=cl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;gn(function(){Fs(null,e,null,null)}),t[zt]=null}};function Ns(e){this._internalRoot=e}Ns.prototype.unstable_scheduleHydration=function(e){if(e){var t=Hc();e={blockedOn:null,target:e,priority:t};for(var n=0;n<bt.length&&t!==0&&t<bt[n].priority;n++);bt.splice(n,0,e),n===0&&Xc(e)}};function dl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Is(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Iu(){}function ty(e,t,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=vs(o);s.call(u)}}var o=mf(t,i,e,0,null,!1,!1,"",Iu);return e._reactRootContainer=o,e[zt]=o.current,Oi(e.nodeType===8?e.parentNode:e),gn(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=vs(l);a.call(u)}}var l=ll(e,0,!1,null,null,!1,!1,"",Iu);return e._reactRootContainer=l,e[zt]=l.current,Oi(e.nodeType===8?e.parentNode:e),gn(function(){Fs(t,l,n,i)}),l}function Bs(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=vs(o);a.call(l)}}Fs(t,o,e,r)}else o=ty(n,t,e,r,i);return vs(o)}Gc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Si(t.pendingLanes);n!==0&&(Ra(t,n|1),be(t,de()),!($&6)&&(qn=de()+500,Jt()))}break;case 13:gn(function(){var i=Pt(e,1);if(i!==null){var r=Me();ut(i,e,1,r)}}),ul(e,1)}};Da=function(e){if(e.tag===13){var t=Pt(e,134217728);if(t!==null){var n=Me();ut(t,e,134217728,n)}ul(e,134217728)}};Wc=function(e){if(e.tag===13){var t=Xt(e),n=Pt(e,t);if(n!==null){var i=Me();ut(n,e,t,i)}ul(e,t)}};Hc=function(){return Y};$c=function(e,t){var n=Y;try{return Y=e,t()}finally{Y=n}};Io=function(e,t,n){switch(t){case"input":if(Po(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Ts(i);if(!r)throw Error(P(90));Cc(i),Po(i,r)}}}break;case"textarea":Tc(e,n);break;case"select":t=n.value,t!=null&&Un(e,!!n.multiple,t,!1)}};Fc=rl;Nc=gn;var ny={usingClientEntryPoint:!1,Events:[tr,Dn,Ts,Rc,Dc,rl]},yi={findFiberByHostInstance:an,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iy={bundleType:yi.bundleType,version:yi.version,rendererPackageName:yi.rendererPackageName,rendererConfig:yi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ac(e),e===null?null:e.stateNode},findFiberByHostInstance:yi.findFiberByHostInstance||ey,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zr.isDisabled&&zr.supportsFiber)try{ws=zr.inject(iy),gt=zr}catch{}}We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ny;We.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dl(t))throw Error(P(200));return Jg(e,t,null,n)};We.createRoot=function(e,t){if(!dl(e))throw Error(P(299));var n=!1,i="",r=pf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=ll(e,1,!1,null,null,n,!1,i,r),e[zt]=t.current,Oi(e.nodeType===8?e.parentNode:e),new cl(t)};We.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(P(188)):(e=Object.keys(e).join(","),Error(P(268,e)));return e=Ac(t),e=e===null?null:e.stateNode,e};We.flushSync=function(e){return gn(e)};We.hydrate=function(e,t,n){if(!Is(t))throw Error(P(200));return Bs(null,e,t,!0,n)};We.hydrateRoot=function(e,t,n){if(!dl(e))throw Error(P(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=pf;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=mf(t,null,e,1,n??null,r,!1,s,o),e[zt]=t.current,Oi(e),i)for(e=0;e<i.length;e++)n=i[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Ns(t)};We.render=function(e,t,n){if(!Is(t))throw Error(P(200));return Bs(null,e,t,!1,n)};We.unmountComponentAtNode=function(e){if(!Is(e))throw Error(P(40));return e._reactRootContainer?(gn(function(){Bs(null,null,e,!1,function(){e._reactRootContainer=null,e[zt]=null})}),!0):!1};We.unstable_batchedUpdates=rl;We.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Is(n))throw Error(P(200));if(e==null||e._reactInternals===void 0)throw Error(P(38));return Bs(e,t,n,!1,i)};We.version="18.3.1-next-f1338f8080-20240426";function vf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vf)}catch(e){console.error(e)}}vf(),pc.exports=We;var ry=pc.exports,Bu=ry;_o.createRoot=Bu.createRoot,_o.hydrateRoot=Bu.hydrateRoot;const sy="OREngine",oy=[0,0,0],ay=[0,0,0],ly=[1,1,1],uy={name:"root",uuid:"root",pos:[-1.75,0,0]},cy=[{uuid:"root",components:[{name:"BLidgeClient",props:{mode:"json","websocket/url":"ws://localhost:3100"}},{name:"Music"},{name:"TextureGenerator"},{name:"UniformControls"}]},{uuid:"d7b3bbdf",components:[{name:"MainCamera"}]},{uuid:"93978ccc",components:[{name:"HUD"}]},{uuid:"dcfcefc5",components:[{name:"HUD"}]},{uuid:"26751dfa",components:[{name:"Logo"}]},{uuid:"0f3c0a1f",components:[{name:"TruchetSushiLane"}]},{uuid:"f4a7a7e8",components:[{name:"TableStage"}]},{uuid:"72ce0867",components:[{name:"RandomSMG",props:{count:40,"Position Range/rangeX":14.999999999999991,"Position Range/rangeY":24.850000000000023,"Position Range/rangeZ":7.299999999999983,randomSeed:0,shaderType:"random","Movement/movementX":0,"Movement/movementY":0}}]},{uuid:"cebe8ad4",components:[{name:"ShaderMotionGraphics",props:{shaderName:"ikuraBGScreen",layers:5,layerSpacing:-.01,timeOffset:0}}]},{uuid:"67e890a6",components:[{name:"IkuraFluids"}]},{uuid:"2b281283",components:[{name:"IkuraGunKan"}]},{uuid:"c85f4ed4",components:[{name:"IkuraGunKan"}]},{uuid:"24df161a",components:[{name:"Kyuuri"}]},{uuid:"989f5be8",components:[{name:"DebaBouChou"}]},{uuid:"9aecb1bb",components:[{name:"RandomSMG",props:{count:24,"Position Range/rangeX":17.249999999999964,"Position Range/rangeY":7.899999999999973,"Position Range/rangeZ":11.149999999999986,randomSeed:30,shaderType:"random","Movement/movementX":0,"Movement/movementY":0}}]},{uuid:"29549b03",components:[{name:"Maguro"}]},{uuid:"c21a6cf1",components:[{name:"ShaderMotionGraphics",props:{shaderName:"maguroBGScreen",layers:3,layerSpacing:-.08999999999999662,timeOffset:0}}]},{uuid:"32dd0971",components:[{name:"MizuBall"}]},{uuid:"ef136354",components:[{name:"MizuBall"}]},{uuid:"cc506154",components:[{name:"MizuBall"}]},{uuid:"b6c68e95",components:[{name:"Nigiri",props:{sashimiType:"maguro"}}]},{uuid:"f2985235",components:[{name:"Nigiri",props:{sashimiType:"maguro"}}]},{uuid:"629afea1",components:[{name:"BreakDanceOnigiri"}]},{uuid:"b01f8327",components:[{name:"KaitenSushi"}]},{uuid:"76c75ce7",components:[{name:"Maguro"},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"dd391494",components:[{name:"Maguro"},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"ef245de7",components:[{name:"Salmon",props:{blockType:"saku"}},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"24a125ef",components:[{name:"Salmon",props:{blockType:"saku"}},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"96971d72",components:[{name:"Taiyaki"},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"b2ebb3cb",components:[{name:"SaraAudio",props:{samplePosition:.3}}]},{uuid:"dd9c0ac8",components:[{name:"SaraAudio",props:{samplePosition:.5}}]},{uuid:"0472d010",components:[{name:"SaraAudio",props:{samplePosition:.56}}]},{uuid:"651fdf32",components:[{name:"SaraAudio",props:{samplePosition:.2}}]},{uuid:"02e7b7ae",components:[{name:"SaraAudio",props:{samplePosition:.5}}]},{uuid:"526c1c65",components:[{name:"SushiGetaWithNigiri"}]},{uuid:"06a4626d",components:[{name:"SushiGetaWithNigiri"}]},{uuid:"b41b8d15",components:[{name:"TakoGate"},{name:"PartyTime",props:{isJumping:!1}}]},{uuid:"e63fb6c9",components:[{name:"TakoGate"},{name:"PartyTime",props:{isJumping:!1}}]},{uuid:"4dbbbcce",components:[{name:"Ukonpower"},{name:"PartyTime",props:{isJumping:!0}}]},{uuid:"7d90402e",components:[{name:"RandomSMG",props:{count:26,"Position Range/rangeX":18.449999999999935,"Position Range/rangeY":10.049999999999974,"Position Range/rangeZ":10,randomSeed:9,shaderType:"random","Movement/movementX":-3.1000000000000085,"Movement/movementY":-2.300000000000002}}]},{uuid:"06674a7c",components:[{name:"MizuBall"}]},{uuid:"768002b3",components:[{name:"Onigiri"}]},{uuid:"c51ba9ef",components:[{name:"Salmon",props:{blockType:"saku"}},{name:"SalmonSushi"}]},{uuid:"0dd05673",components:[{name:"Salmon",props:{blockType:"kirimi"}}]},{uuid:"78014334",components:[{name:"Salmon",props:{blockType:"saku"}},{name:"SalmonSushi"}]},{uuid:"cc48dd93",components:[{name:"ShaderMotionGraphics",props:{shaderName:"salmonBGScreen",layers:3,layerSpacing:-.09,timeOffset:0}}]},{uuid:"de897ba0",components:[{name:"RandomSMG",props:{count:24,"Position Range/rangeX":15.150000000000007,"Position Range/rangeY":5.950000000000014,"Position Range/rangeZ":10,randomSeed:0,shaderType:"random","Movement/movementX":0,"Movement/movementY":.25}}]},{uuid:"5e9cf8ad",components:[{name:"ShaderMotionGraphics",props:{shaderName:"takoBGScreen",layers:3,layerSpacing:-.04000000000000001,timeOffset:0}}]},{uuid:"27599264",components:[{name:"TakoGate"}]},{uuid:"77db9e8a",components:[{name:"TakoKosen"}]},{uuid:"f14b3580",components:[{name:"Nigiri",props:{sashimiType:"tako"}}]},{uuid:"2a16e1b2",components:[{name:"Nigiri",props:{sashimiType:"tako"}}]},{uuid:"727525da",components:[{name:"Ocean"}]},{uuid:"4afddbe4",components:[{name:"SkyBox",props:{skyboxType:"tsuri"}}]},{uuid:"d454a187",components:[{name:"Taiyaki"}]},{uuid:"ddc6e769",components:[{name:"Teibo"}]},{uuid:"69f163d9",components:[{name:"Teibo"}]},{uuid:"5fe0ec15",components:[{name:"Ukonpower"}]},{uuid:"60382d7c",components:[{name:"SkyBox",props:{skyboxType:"default"}}]}],dy={name:sy,position:oy,euler:ay,scale:ly,scene:uy,overrides:cy,"timeline/duration":4280,"timeline/fps":30};class xi extends W{constructor(n,i){const r=n.gl;super(r);c(this,"material");c(this,"_renderer");c(this,"_resolution");c(this,"_postProcess");c(this,"_frameBuffer");this._renderer=n,this._resolution=i.resolution||new M(1024,1024),this.setting({wrapS:r.REPEAT,wrapT:r.REPEAT,magFilter:r.LINEAR,minFilter:r.LINEAR}),this._frameBuffer=new Z(r).setTexture([this]).setSize(this._resolution),this.material=new Q(r,{...i,renderTarget:this._frameBuffer}),this._postProcess=new et({passes:[this.material]}),this.render()}render(){this._renderer.renderPostProcess(this._postProcess,void 0,this._resolution)}}class gf extends b{constructor(n){super(n);c(this,"target");c(this,"up");c(this,"entityWorldPos");c(this,"targetWorldPos");this.target=null,this.entityWorldPos=new M,this.targetWorldPos=new M,this.up=new M(0,1,0),this.order=9999}setTarget(n){this.target=n}beforeRenderImpl(n){if(this.target&&this._enabled){this.entity.matrixWorld.decompose(this.entityWorldPos),this.target.matrixWorld.decompose(this.targetWorldPos),this.entity.matrixWorld.lookAt(this.entityWorldPos,this.targetWorldPos,this.up);const i=this.entity.getComponentsByTag("camera")[0];i&&i.viewMatrix.copy(this.entity.matrixWorld).inverse()}}}const fy=2,hy=[[0,1,2],[3,4,5],[6,9],[7,8],[7],[10,11,12],[13,14],[15,16,17],[18],[19],[22,23],[24,25],[26],[27],[28,29],[30,31],[32,33,34],[35],[36,37],[38,39,40],[41],[42],[43,44,45,46],[47],[48,49,50,51],[52,53],[54],[55,56,57],[58],[59],[60,61],[62],[63],[64],[65,66,67],[68,69],[70,71],[72,75],[73,74],[75,76],[75],[77],[78],[80],[81],[82],[83],[84],[85],[86],[87],[88],[89,90],[91,92,93],[94],[95,96],[97,98,99],[100],[101,102],[103],[104,105,106],[107,108],[109],[111,112,113],[114,115],[116,117,118],[119,120,121],[122],[123,124,125],[126,127,128],[129]],my=[{axis:"x",k:[[1,[357,-.129]],[0,[1,-8.153]],[1,[87,7.915]],[0,[1,8.787]],[1,[99,3.404]],[0,[1,.705]],[1,[97,-2.281]],[1,[1,0]],[1,[74,99.945]],[0,[1153,-711.636]],[1,[305,-715.384]],[1,[1,-715.987]],[2,[287,-713.921,2463.958,-713.92,2473.5,-714.084]],[2,[80,-714.111,2524.646,-714.421,2570.577,-713.686]],[2,[74,-710.032,2597.768,-710.487,2638.886,-709.563]],[1,[70,-710.093,2667.346,-710.093]],[0,[65,5.331]],[1,[285,-5.259]],[1,[1,-11.108]],[0,[288,-5.937]],[1,[70,-4.204]],[1,[1,-1.349]],[1,[76,4.46]],[0,[80,-7.571]],[1,[65,5.82]],[1,[1,0]],[1,[577,-0]]]},{axis:"z",k:[[0,[48,336.142]],[1,[309,266.413]],[1,[1,84.442]],[1,[88,30.333]],[1,[100,2.386]],[0,[98,31.793]],[1,[72,33.136]],[0,[2,16.63]],[2,[260,9.524,786.959,16.465,1020.736,7.972]],[0,[49,-14.405,987.557,-13.102]],[0,[267,-20.248]],[2,[270,-20.248,1384.026,-20.248,1602.539,-20.248]],[0,[48,-46.982,1567.072,-44.794]],[1,[258,-52.944]],[1,[1,20.646]],[0,[306,-3.44]],[1,[286,-.762]],[2,[1,7.661,2463.953,7.661,2473.839,7.661]],[1,[224,-13.991,2654.913,-13.991]],[1,[65,17.9]],[1,[286,-11.771]],[0,[288,12.828]],[1,[70,13.173]],[1,[1,12.468]],[1,[76,14.665]],[1,[80,11.074]],[0,[66,30.716]],[1,[74,33.093]],[0,[1,56.347]],[1,[70,61.945]],[0,[1,110.359]],[0,[433,154.197]]]},{axis:"y",k:[[1,[120,3.791]],[1,[326,-1.549]],[1,[100,7.219]],[1,[98,1.799]],[1,[74,3.765]],[2,[545,3.765,1034.564,3.765,1319.823,3.765]],[0,[146,-17.766,1284.321,-15.841]],[2,[57,-18.4,1439.682,-18.113,1532.488,-19.125]],[1,[116,-37.554,1493.553,-37.047]],[1,[289,2.041]],[1,[306,2.244]],[2,[287,3.041,2463.953,3.041,2473.839,3.041]],[1,[224,.914,2654.913,.914]],[1,[65,3.947]],[0,[286,7.027]],[1,[287,5.779]],[0,[1,2.675]],[1,[70,2.724]],[0,[1,5.184]],[1,[75,5.673]],[0,[1,6.112]],[1,[79,2.015]],[1,[1,9.679]],[0,[66,4.947]],[0,[282,5.067]],[0,[297,5.786]]]},{axis:"x",k:[[1,[545,1.571]],[1,[1,1.377]],[1,[1325,1.571]],[1,[1168,1.653]],[1,[287,1.655]],[1,[1,1.399]],[0,[71,1.45]],[1,[75,1.71]],[0,[1,1.459]],[1,[79,1.506]],[0,[1,1.299]],[1,[65,1.325]],[1,[1,1.553]]]},{axis:"z",k:[[1,[358,0]],[0,[3040,-.094]],[1,[75,-.057]],[0,[1,-0]]]},{axis:"y",k:[[1,[358,0]],[1,[188,-.32]],[1,[98,0]],[1,[1532,0]],[1,[1,-1.577]],[1,[862,-1.051]],[0,[288,-.357]],[1,[70,-.475]],[0,[1,.47]],[1,[75,.475]],[0,[1,-.242]],[1,[79,-.249]],[0,[1,-.521]],[1,[65,.456]],[1,[1,-0]]]},{axis:"y",k:[[1,[358,0]],[1,[286,1]],[1,[1227,0]],[1,[593,1]],[1,[575,0]]]},{axis:"x",k:[[2,[53.001,0,-32.564,0,138.566,0]],[1,[190,1,179.667,1]],[1,[457,0]],[1,[18,1]],[1,[1153,0]],[2,[19,0,1427.07,0,1928.143,0]],[1,[120,1,1974.44,1]],[1,[2187,0]]]},{axis:"y",k:[[2,[3844,0,3807.333,0,3880.667,0]],[2,[110,5.128,3917.333,5.128,3990.667,5.128]]]},{axis:"x",k:[[2,[2648,17.297,2634.667,17.297,2661.333,17.297]],[1,[40,12.176,2674.667,13.026]],[1,[65,10.794]],[1,[801,5.962]],[1,[66,11.85]]]},{axis:"x",k:[[1,[69,0]],[1,[289,1.634]],[1,[360,100.066]],[1,[1152,100.074,1486,100.074,1870.333,100.074]],[1,[1,-712.978,1870.667,-712.977]],[1,[593,-713.061]],[1,[289,-.035]],[1,[286,-4.794]]]},{axis:"z",k:[[1,[69,-0]],[1,[289,-9.311]],[1,[360,-.013]],[2,[262,-.013,588.692,-.013,1024.434,-.013]],[1,[47,-30.021,979.267,-30.021]],[2,[537,-30.021,1200.558,-30.021,1602.539,-30.021]],[1,[48,-68.645,1566.693,-68.645]],[1,[258,-68.645,1784,-68.645,1870.333,-68.645]],[1,[1,-1.16,1870.667,-1.16]],[1,[593,-10.02]],[1,[289,.127]],[1,[286,-13.966]]]},{axis:"y",k:[[1,[69,1.139]],[1,[289,1.997]],[1,[360,3.899]],[2,[556,3.899,724.024,3.899,1308.17,3.899]],[0,[105,-22.476,1271.091,-21.528]],[2,[96,-23.12,1375.508,-22.393,1536.152,-23.566]],[1,[97,-37.458,1488.03,-37.047]],[1,[299,1.834]],[1,[593,.429]],[2,[214,.429,2636.471,.429,2686.539,.429]],[1,[38,2.843,2669.012,2.809]],[1,[37,4.69]],[1,[286,6.791]]]},{axis:"x",k:[[0,[1127,76.279]],[1,[134,-76.511]]]},{axis:"y",k:[[0,[1127,29.509]],[1,[134,-45.664]]]},{axis:"x",k:[[0,[1127,-.526]],[1,[134,.613]]]},{axis:"z",k:[[0,[1127,-.279]],[1,[134,.376]]]},{axis:"y",k:[[0,[1127,.048]],[1,[134,-.074]]]},{axis:"x",k:[[1,[108,0]],[1,[610,1]],[1,[2034,0]]]},{axis:"x",k:[[2,[255,0,220,0,290,0]],[1,[105,1,325,1]]]},{axis:"x",k:[[1,[108,0]],[1,[675,1]]]},{axis:"x",k:[[2,[258,0,223,0,293,0]],[2,[105,1,328,1,398,1]]]},{axis:"x",k:[[2,[724,-6.033,709.829,-6.158,738.171,-5.909]],[2,[91,-5.175,806.133,-4.992,827.056,-5.424]],[2,[24,-6.73,830.676,-7.338,843.502,-6.401]],[2,[14,3.052,841.332,2.978,860.882,3.102]],[2,[57,4.706,900.38,4.576,917.338,4.804]],[2,[24,-9.86,914.524,-9.86,953.476,-9.86]]]},{axis:"y",k:[[2,[798,-28.229,795.967,-28.229,800.033,-28.229]],[2,[22,-15.361,802.479,-12.435,829.271,-16.848]],[2,[19,-12.507,833.465,-12.493,842.11,-12.515]],[2,[19,-20.097,838.478,-20.097,866.884,-20.097]],[2,[37,-16.022,883.508,-16.022,901.602,-16.022]],[2,[15,-19.943,905.455,-19.943,914.171,-19.943]],[2,[24,-11.698,917.015,-11.698,950.985,-11.698]]]},{axis:"z",k:[[2,[816,-.087,805.81,-.071,826.896,-.103]],[2,[19,.311,827.474,.312,843.048,.309]],[2,[18,-1.485,842.964,-1.485,865.188,-1.485]],[2,[30,.236,870.167,.236,888.817,.236]],[2,[14,.094,891.505,.09,902.523,.098]],[2,[13,.579,901.798,.579,918.049,.579]],[2,[24,-.827,907.69,-.827,951.116,-.827]]]},{axis:"y",k:[[2,[798,-0,794.864,-0,801.136,-0]],[2,[35,-6.27,793.505,-6.306,840.658,-6.264]],[2,[30,-6.267,844.83,-6.293,882.035,-6.241]],[2,[41,-2.937,884.588,-2.983,923.412,-2.892]],[2,[39,-3.237,937.396,-3.234,948.604,-3.24]]]},{axis:"x",k:[[1,[717,1]],[1,[1,0]]]},{axis:"x",k:[[0,[1273,0]],[1,[104,1]]]},{axis:"x",k:[[1,[970,0]],[1,[130,1]]]},{axis:"y",k:[[0,[1288,0]],[0,[87,1]]]},{axis:"x",k:[[2,[1578,-.18,1548.301,-.18,1582.826,-.18]],[1,[13,2.022,1586.505,2.022]]]},{axis:"y",k:[[2,[1498,-33.378,1483.268,-37.264,1512.732,-29.492]],[2,[77,-27.141,1549.333,-27.141,1581.753,-27.141]],[1,[14,-28.024,1584.333,-28.024]]]},{axis:"x",k:[[2,[1498,.776,1470,.776,1526,.776]],[1,[84,.572,1554,.572]]]},{axis:"z",k:[[2,[1498,.431,1472,.431,1524,.431]],[2,[78,.018,1555.235,.04,1579.7,-.039]],[1,[9,-.299,1582.237,-.299]]]},{axis:"y",k:[[2,[1498,-.93,1470,-.93,1526,-.93]],[1,[84,-.404,1554,-.404]]]},{axis:"x",k:[[2,[1494,1,1471.672,1,1516.328,1]],[1,[88,0,1543.461,0]]]},{axis:"x",k:[[2,[1574,-2.944,1539.215,-2.944,1588.718,-2.944]],[1,[32,-7.055,1595.333,-7.055]]]},{axis:"y",k:[[2,[1574,-24.617,1547.333,-24.617,1587.488,-24.617]],[1,[31,-19.582,1594.667,-19.582]]]},{axis:"x",k:[[2,[1494,1.225,1466.667,1.225,1521.333,1.225]],[2,[82,.723,1548.667,.723,1580.667,.723]],[1,[12,.39,1584,.39]]]},{axis:"z",k:[[2,[1494,.171,1466.667,.171,1521.333,.171]],[1,[82,.139,1548.667,.139]]]},{axis:"y",k:[[2,[1494,1.082,1466.667,1.082,1521.333,1.082]],[2,[82,.59,1548.667,.59,1603.333,.59]]]},{axis:"x",k:[[2,[1491,1,1477.069,1,1504.931,1]],[1,[85,0,1533.62,0]]]},{axis:"x",k:[[1,[65,0]],[1,[293,1]]]},{axis:"x",k:[[2,[3912,0,3859.426,0,3964.575,0]],[1,[60,1,3933.802,1]]]},{axis:"y",k:[[2,[3947,0,3917.932,0,3976.068,0]],[1,[48,1,3960.361,1]]]},{axis:"z",k:[[2,[3966,0,3923.623,0,4008.377,0]],[1,[56,1,3978.308,1]]]},{axis:"w",k:[[1,[4004,0]],[1,[7,1]],[1,[3,0]],[1,[3,1]]]},{axis:"x",k:[[1,[3863,0]],[1,[334,1]]]},{axis:"x",k:[[2,[4059,0,4032.446,0,4083.737,0]],[2,[36,1,4067.522,1,4122.479,1]]]},{axis:"z",k:[[1,[4143,0]],[1,[2,1]],[1,[3,0]],[1,[3,1]]]},{axis:"y",k:[[2,[4092,0,4063.144,0,4120.856,0]],[2,[42,1,4105.19,1,4162.81,1]]]},{axis:"w",k:[[2,[4021,0,3992.252,0,4049.748,0]],[2,[37,1,4032.091,1,4083.909,1]]]},{axis:"x",k:[[2,[718,20.519,717.999,26.464,718.004,.212]],[2,[146,.119,815.388,.119,912.612,.119]],[2,[2682,.119,2652,.119,4440,.119]]]},{axis:"y",k:[[2,[718,-22.097,717.999,-29.168,718.001,-12.869]],[2,[146,-12.487,815.388,-12.487,912.612,-12.487]]]},{axis:"x",k:[[2,[718,6.721,717.996,23.388,718.001,2.205]],[2,[124,.063,792.496,.405,853.687,-1.088]],[2,[75,-6.283,814.736,-6.283,925.061,-6.283]],[2,[86,-11.703,900.736,-11.703,1105.264,-11.703]]]},{axis:"x",k:[[0,[840,0]],[0,[7,.831]]]},{axis:"y",k:[[2,[842,0,839.379,0,844.621,0]],[2,[19,1,831.427,1,890.573,1]]]},{axis:"z",k:[[0,[914,0]],[0,[4,.999]]]},{axis:"x",k:[[1,[718,0]],[1,[199,1]]]},{axis:"x",k:[[0,[704.129,0]],[1,[80.451,.998]],[0,[192,.998]],[1,[41,.15]]]},{axis:"x",k:[[0,[1091,4.766]],[0,[43,-4.299]]]},{axis:"y",k:[[0,[1091,-9.866]],[0,[43,-14.859]]]},{axis:"x",k:[[1,[1051,1]],[1,[31,0]]]},{axis:"x",k:[[2,[2677,0,2663.333,0,2690.667,0]],[1,[41,1.304,2704.333,1.304]]]},{axis:"x",k:[[0,[1555,0]],[1,[71,1]]]},{axis:"x",k:[[2,[1003,-28.103,976.667,-28.103,1029.333,-28.103]],[2,[79,-5.926,1059.599,-7.763,1104.401,-4.089]],[2,[97,-3.589,1160.059,-1.616,1229.317,-8.83]],[1,[88,-75.067,1237.667,-75.067]]]},{axis:"y",k:[[2,[1003,-20.062,983,-20.062,1023,-20.062]],[2,[60,-10.401,1031.678,-12.651,1121.884,-6.17]],[2,[150,-19.104,1178.234,-7.574,1240.422,-28.198]],[1,[54,-47.254,1249,-47.254]]]},{axis:"z",k:[[2,[1160,-11.533,1142.333,-11.533,1177.667,-11.533]],[1,[53,-70.541,1199.616,-64.508]],[1,[54,-75.954]]]},{axis:"z",k:[[2,[1213,-.368,1195,-.368,1231,-.368]],[1,[54,.4,1249,.4]]]},{axis:"y",k:[[2,[1160,3.138,1124.333,3.138,1195.667,3.138]],[2,[107,6.263,1231.333,6.263,1302.667,6.263]]]},{axis:"x",k:[[2,[993,-24.403,967.333,-24.403,1018.667,-24.403]],[2,[77,2.343,1045.276,-.085,1094.724,4.772]],[2,[87,2.343,1141.278,2.343,1172.722,2.343]],[2,[56,21.665,1175.849,21.665,1235.839,21.665]],[1,[75,-.142,1236.758,-.142]]]},{axis:"y",k:[[2,[993,-32.081,967.333,-32.081,1018.667,-32.081]],[2,[77,-16.908,1045.02,-18.717,1094.98,-15.098]],[2,[87,-16.908,1141.278,-16.908,1172.722,-16.908]],[2,[56,-8.224,1179.927,-8.224,1233.645,-8.224]],[1,[78,-16.065,1236.686,-16.065]]]},{axis:"y",k:[[1,[1158,0]],[1,[50,1]]]},{axis:"x",k:[[2,[993,-36.28,991.846,-36.28,994.154,-36.28]],[2,[48,.854,1008.173,-6.409,1060.309,5.126]],[2,[115,-.074,1136.725,-.074,1167.966,-.074]],[2,[41,19.658,1179.36,19.658,1210.293,19.658]],[1,[88,-.098,1221.092,-.098]]]},{axis:"y",k:[[2,[993,-27.842,991.846,-27.842,994.154,-27.842]],[2,[48,-12.461,1006.88,-15.549,1066.424,-10.16]],[2,[115,-12.423,1136.679,-12.423,1168.284,-12.423]],[2,[41,-3.475,1180.87,-3.475,1206.232,-3.475]],[1,[88,-12.036,1218.648,-12.036]]]},{axis:"x",k:[[0,[1111,0]],[2,[15,1,1121,1,1131,1]]]},{axis:"y",k:[[1,[1168,0]],[1,[24,1]]]},{axis:"x",k:[[0,[976,0]],[0,[73,1]],[0,[239,1]],[0,[77,2]]]},{axis:"x",k:[[1,[10,0]],[1,[694,1]],[1,[14,1]],[1,[2035,0]]]},{axis:"x",k:[[1,[10,0]],[1,[694,1]],[1,[14,1]]]},{axis:"x",k:[[1,[1254,1]],[1,[35,0]],[1,[300,1]]]},{axis:"x",k:[[1,[600,1]],[1,[118,0]],[1,[299,1]]]},{axis:"x",k:[[1,[411,1]],[1,[2342,0]]]},{axis:"x",k:[[1,[977,1]],[1,[15,0]],[1,[331,1]]]},{axis:"x",k:[[1,[1539,1]],[1,[38,0]],[1,[294,1]]]},{axis:"x",k:[[1,[1831,1]],[1,[40,0]],[1,[882,1]]]},{axis:"x",k:[[2,[263,0,223.667,0,302.333,0]],[1,[118,.085,336.132,.078]],[1,[324,1]],[1,[2048,.141]]]},{axis:"x",k:[[1,[717,1]],[1,[1,0]]]},{axis:"x",k:[[1,[717,1]],[1,[1,0]],[1,[2035,1]]]},{axis:"x",k:[[2,[915,2.74,912.258,2.74,917.742,2.74]],[2,[81,2.245,943.179,2.245,1048.821,2.245]]]},{axis:"y",k:[[2,[915,-14.149,907.217,-14.149,922.783,-14.149]],[2,[81,-13.728,949.47,-13.728,1042.53,-13.728]]]},{axis:"x",k:[[2,[915,-.613,913.046,-.613,916.954,-.613]],[2,[81,-.843,960.385,-.843,1031.615,-.843]]]},{axis:"z",k:[[2,[915,-.087,913.902,-.087,916.098,-.087]],[2,[81,-.696,950.01,-.696,1041.99,-.696]]]},{axis:"y",k:[[2,[915,.713,912.781,.713,917.219,.713]],[2,[81,.15,952.345,.15,1039.655,.15]]]},{axis:"x",k:[[1,[878,1]],[1,[37,0]]]},{axis:"x",k:[[2,[916,-2.114,911.511,-2.114,920.489,-2.114]],[2,[76,-2.439,894.514,-2.439,1003.575,-2.439]],[2,[14,-2.937,999.646,-2.937,1012.354,-2.937]]]},{axis:"y",k:[[2,[916,-13.294,915.521,-13.294,916.479,-13.294]],[2,[76,-12.498,896.023,-12.498,1006.349,-12.498]],[2,[14,-11.871,998.689,-11.871,1013.311,-11.871]]]},{axis:"x",k:[[2,[916,-.606,915.003,-.606,916.997,-.606]],[2,[76,-.446,963.778,-.446,1020.222,-.446]]]},{axis:"z",k:[[2,[916,-.712,915.491,-.712,916.509,-.712]],[2,[76,-.031,951.739,-.031,1032.261,-.031]]]},{axis:"y",k:[[2,[916,-1.052,915.131,-1.052,916.869,-1.052]],[2,[76,-.641,967.196,-.641,1016.804,-.641]]]},{axis:"x",k:[[1,[878,1]],[1,[38,0]]]},{axis:"x",k:[[2,[-650,0,-651,0,-649,0]]]},{axis:"y",k:[[1,[2741,0]],[1,[12,1]],[2,[867,1,3356.464,111.248,3621.65,.31]],[1,[89,0,3679.333,0]]]},{axis:"y",k:[[2,[2679,-12.409,2675.942,-12.898,2682.058,-11.921]],[1,[30,-7.348,2637.225,-7.434]]]},{axis:"x",k:[[2,[2679,.793,2676.628,.793,2681.372,.793]],[1,[29,.649,2689.798,.649]]]},{axis:"z",k:[[2,[2679,-0,2676.628,-0,2681.372,-0]],[1,[29,-.347,2689.798,-.347]]]},{axis:"y",k:[[2,[2679,0,2676.628,0,2681.372,0]],[1,[29,.398,2689.798,.398]]]},{axis:"x",k:[[2,[2661,0,2638.667,0,2683.333,0]],[2,[67,1,2692.086,1,2763.914,1]]]},{axis:"y",k:[[2,[2747,1,2746,1,2748,1]]]},{axis:"y",k:[[0,[3094,1.718]]]},{axis:"x",k:[[0,[3094,1.718]]]},{axis:"x",k:[[2,[1577,1,1571.337,1.293,1582.663,.707]],[1,[80,0,1604.182,0]]]},{axis:"y",k:[[2,[1583,0,1564.667,0,1601.333,0]],[2,[55,0,1633.19,0,1656.036,0]],[2,[44,1,1647.202,1,1711.01,1]],[2,[48,2,1696.097,2,1771.558,2]],[2,[53,3,1743.733,3,1822.267,3]],[1,[54,4,1797.733,4]]]},{axis:"z",k:[[2,[1749,.025,1732.667,.025,1765.333,.025]],[2,[49,1,1782.766,1,1800.328,1]],[1,[17,-.007,1801.602,-.007]]]},{axis:"x",k:[[2,[1748,0,1731.333,0,1764.667,0]],[2,[50,2.134,1775.519,2.12,1799.226,2.135]],[1,[27,2.956,1800.102,2.956]]]},{axis:"y",k:[[2,[1734,0,1731.333,0,1736.667,0]],[2,[8,1,1734,1,1750,1]],[2,[51,1,1791.649,1,1794.351,1]],[1,[37,0,1756.825,0]]]},{axis:"x",k:[[2,[1800,-.821,1774.667,-.821,1825.333,-.821]],[2,[76,-.821,1850.667,-.821,1901.333,-.821]]]},{axis:"z",k:[[2,[1800,-.063,1774.667,-.063,1825.333,-.063]],[2,[76,-.063,1850.667,-.063,1901.333,-.063]]]},{axis:"y",k:[[2,[1800,-.277,1794.706,-.277,1805.294,-.277]],[2,[76,-.796,1827.954,-.796,1924.046,-.796]]]},{axis:"x",k:[[2,[1800,-2.278,1797.745,-2.278,1802.255,-2.278]],[2,[76,-3.714,1842.09,-3.714,1909.91,-3.714]]]},{axis:"z",k:[[2,[1800,-1.202,1774.667,-1.202,1825.333,-1.202]],[2,[76,-1.206,1850.667,-1.206,1901.333,-1.206]]]},{axis:"y",k:[[2,[1800,-13.761,1794.866,-13.761,1805.134,-13.761]],[2,[76,-12.11,1827.667,-12.11,1924.333,-12.11]]]},{axis:"x",k:[[1,[1710,1]],[1,[90,0]]]},{axis:"x",k:[[2,[1800,1.152,1792.445,1.152,1807.503,1.152]],[2,[76,1.911,1827.833,1.894,1876.332,1.911]]]},{axis:"z",k:[[2,[1800,-5.469,1774.667,-5.469,1825.333,-5.469]],[1,[76,-5.457,1850.667,-5.457]]]},{axis:"y",k:[[2,[1800,-8.926,1792.445,-8.926,1807.555,-8.926]],[1,[76,-8.277,1837.471,-8.277]]]},{axis:"x",k:[[2,[1800,-.867,1795.011,-.867,1804.989,-.867]],[1,[76,-.821,1819.572,-.821]]]},{axis:"z",k:[[2,[1800,.213,1795.375,.213,1804.625,.213]],[1,[76,-.063,1822.14,-.063]]]},{axis:"y",k:[[2,[1800,1.807,1795.5,1.807,1804.5,1.807]],[1,[76,2.243,1815.225,2.243]]]},{axis:"x",k:[[1,[1710,1]],[1,[90,0]]]}],py={name:"root",parent:null,children:[{name:"Camera",uuid:"d7b3bbdf",type:"camera",animation:{position:0,rotation:1,state:2,uPP:3},param:{fov:38.262},uniforms:{uPP:3}},{name:"CamLook",uuid:"b89a78b8",position:[100.066,3.899,-30.021],rotation:[0,-.815,0],animation:{position:5},children:[{name:"CamDof",uuid:"42325580",position:[-.013,-.005,-0],animation:{}}]},{name:"HUD",uuid:"93978ccc",animation:{hide:12,uState:4},uniforms:{uState:4}},{name:"Outro",uuid:"dcfcefc5",position:[0,17.299,21.167],children:[{name:"Logo",uuid:"26751dfa",animation:{hide:23,state:22,state2:24}}]},{name:"SceneHome",uuid:"dbabc2b5",position:[0,0,-0],visible:!1,animation:{hide:42},children:[{name:"Lane",uuid:"0f3c0a1f",position:[-0,3.855,265.898],rotation:[1.571,0,0],visible:!1,animation:{hide:21}},{name:"Table",uuid:"f4a7a7e8",position:[0,0,-0],scale:[29.83,29.83,29.83],animation:{uState:58},uniforms:{uState:58},children:[]}]},{name:"SceneIkura",uuid:"5ea37a9e",position:[101.415,-11.404,-23.71],visible:!1,animation:{hide:43},children:[{name:"GraphIkura",uuid:"72ce0867",position:[-1.273,-16.472,-11.971],scale:[1.698,1.698,1.698]},{name:"IBG",uuid:"cebe8ad4",position:[-1.442,-24.389,-18.564],rotation:[-.322,-.06,.011],scale:[67.194,67.194,67.194],animation:{uState:13},uniforms:{uState:13}},{name:"IkuraFluids",uuid:"67e890a6",position:[-1.563,-11.712,-6.411],scale:[7.802,7.802,7.802],animation:{uState:14},uniforms:{uState:14}},{name:"IkuraGunKan_left",uuid:"2b281283",position:[-2.944,-24.617,-8.38],rotation:[1.225,1.082,.171],scale:[5.81,5.81,5.81],animation:{position:18,rotation:19,uState:20},uniforms:{uState:20}},{name:"IkuraGunKan_right",uuid:"c85f4ed4",position:[-.18,-33.378,-6.461],rotation:[.776,-.93,.431],scale:[5.252,5.252,5.252],animation:{position:15,rotation:16,uState:17},uniforms:{uState:17}},{name:"Kyuri",uuid:"24df161a",position:[-1.347,-11.439,-6.251],rotation:[-.26,-0,.218],scale:[6.953,6.953,6.953]}]},{name:"SceneIntro",uuid:"9df2d6d7",position:[0,0,-0]},{name:"SceneMaguro",uuid:"8d834b6f",position:[100,16.37,-0],visible:!1,animation:{hide:44},children:[{name:"DebaBouChou",uuid:"989f5be8",position:[-9.86,-11.698,2.819],rotation:[0,-3.237,-.827],scale:[5.625,5.625,5.625],animation:{position:10,rotation:11}},{name:"GraphMaguro",uuid:"9aecb1bb",position:[.204,-12.548,-2.134],scale:[1.886,1.886,1.886]},{name:"Maguro",uuid:"29549b03",position:[.119,-12.487,-.001],rotation:[-11.703,0,-.443],scale:[9.774,9.774,9.774],visible:!1,animation:{position:25,rotation:26,hide:28,uState:27},uniforms:{uState:27}},{name:"MBG",uuid:"c21a6cf1",position:[.146,-12.462,-9.085],scale:[73.019,73.019,73.019],animation:{uState:29},uniforms:{uState:29}},{name:"MizuBall",uuid:"32dd0971",position:[-7.423,-14.64,-1.212],scale:[1.658,1.658,1.658]},{name:"MizuBall.001",uuid:"ef136354",position:[-3.26,-7.261,-5.785],scale:[1.227,1.227,1.227]},{name:"MizuBall.002",uuid:"cc506154",position:[14.39,-11.728,-7.296],scale:[1.604,1.604,1.604]},{name:"Sushi",uuid:"b6c68e95",position:[-2.937,-11.871,-.026],rotation:[-.446,-.641,-.031],scale:[5.99,5.99,5.99],animation:{position:55,rotation:56,hide:57}},{name:"Sushi.001",uuid:"f2985235",position:[2.245,-13.728,-1.187],rotation:[-.843,.15,-.696],scale:[5.346,5.346,5.346],animation:{position:52,rotation:53,hide:54}}]},{name:"SceneParty",uuid:"dba88dd0",position:[0,16.458,6.4],visible:!1,animation:{hide:45},children:[{name:"BO",uuid:"629afea1",position:[-.056,-15.117,2.834],scale:[1.195,1.195,1.195]},{name:"KaitenSushi",uuid:"b01f8327",position:[0,-11.584,-20.722],scale:[3.625,3.625,3.625]},{name:"PartyMaguro",uuid:"76c75ce7",position:[-9.637,-14.129,-5.997],rotation:[-.711,3.215,-1.334],scale:[8.814,8.814,8.814]},{name:"PartyMaguro.001",uuid:"dd391494",position:[-9.637,-14.129,-1.584],rotation:[-.711,3.215,-1.334],scale:[8.814,8.814,8.814]},{name:"PartySalmon",uuid:"ef245de7",position:[10.088,-14.871,-7.183],rotation:[.446,.494,-1.376],scale:[9.941,9.941,9.941]},{name:"PartySalmon.001",uuid:"24a125ef",position:[10.088,-14.871,-.411],rotation:[.446,.494,-1.376],scale:[9.941,9.941,9.941]},{name:"PartyTai",uuid:"96971d72",position:[.415,-10.148,-6.367],rotation:[.454,1.86,.118],scale:[15.484,15.484,15.484]},{name:"Sara.001",uuid:"b2ebb3cb",position:[3.512,-15.622,3.205],scale:[2,2,2]},{name:"Sara.002",uuid:"dd9c0ac8",position:[3.186,-15.621,-11.01],scale:[2.721,2.721,2.721]},{name:"Sara.003",uuid:"0472d010",position:[-4.073,-15.76,3.197],scale:[2,2,2]},{name:"Sara.004",uuid:"651fdf32",position:[-3.207,-15.621,-12.204],scale:[2.721,2.721,2.721]},{name:"Sara.005",uuid:"02e7b7ae",position:[-4.292,-15.621,-8.977],scale:[2.721,2.721,2.721]},{name:"Spot.003",uuid:"3bf2b50c",position:[-12.028,-14.623,15.77],rotation:[-1.892,2.423,.08],type:"light",param:{shadow_map:!1,color:{x:1,y:1,z:1},intensity:1.26,type:"spot",angle:.785,blend:.15,distance:99.97}},{name:"Spot.004",uuid:"26373a5a",position:[10.375,-14.623,15.77],rotation:[-1.892,-2.446,.08],type:"light",param:{shadow_map:!1,color:{x:1,y:1,z:1},intensity:1.26,type:"spot",angle:.785,blend:.15,distance:99.97}},{name:"SushiGetaL",uuid:"526c1c65",position:[-3.44,-15.185,-.602],rotation:[0,.438,0],scale:[4.67,4.67,4.67]},{name:"SushiGetaR",uuid:"06a4626d",position:[3.449,-15.117,-1.002],rotation:[0,-.266,0],scale:[4.959,4.959,4.959]},{name:"Tako",uuid:"b41b8d15",position:[18.972,-2.219,-11.792],rotation:[-2.267,-.835,0],scale:[5.323,5.323,5.323],animation:{uState:62},uniforms:{uState:62}},{name:"Tako.001",uuid:"e63fb6c9",position:[-16.211,-2.015,-11.778],rotation:[-2.267,.935,-0],scale:[5.323,5.323,5.323],animation:{uState:62},uniforms:{uState:62}},{name:"ukp",uuid:"4dbbbcce",position:[68.097,-62.154,-10.403],rotation:[0,2.031,0],scale:[8.725,8.725,8.725]}]},{name:"SceneSalmon",uuid:"b1c3550e",position:[100.217,16.315,-23.661],animation:{hide:46},children:[{name:"GraphSalmon",uuid:"7d90402e",position:[-0,-12.412,-12.21],scale:[2.407,2.407,2.407]},{name:"MizuBall.003",uuid:"06674a7c",position:[4.766,-9.866,4.183],scale:[1.34,1.34,1.34],visible:!1,animation:{position:30,hide:31}},{name:"Onigiri",uuid:"768002b3",position:[76.279,29.509,-75.15],rotation:[-.526,.048,-.279],scale:[9.497,9.497,9.497],animation:{position:6,rotation:7}},{name:"Salmon",uuid:"c51ba9ef",position:[2.411,-11.612,-6.016],rotation:[-.002,3.138,-.368],scale:[7.953,7.953,7.953],animation:{position:38,uState:39},uniforms:{uState:39}},{name:"Salmon_sub1",uuid:"0dd05673",position:[-11.904,-10.726,-11.533],rotation:[.012,3.138,-.368],scale:[6.226,6.226,6.226],animation:{position:34,rotation:35,uState:40},uniforms:{uState:40}},{name:"Salmon_sub2",uuid:"78014334",position:[.005,-18.357,-11.151],rotation:[-.002,3.138,-.368],scale:[6.518,6.518,6.518],animation:{position:36,uState:37},uniforms:{uState:37}},{name:"SBG",uuid:"cc48dd93",position:[-.07,-12.406,-16.837],scale:[72.711,72.711,72.711],animation:{uState:41},uniforms:{uState:41}}]},{name:"SceneTako",uuid:"ba87ca2f",position:[100.656,-27.191,-70.038],visible:!1,animation:{hide:47},children:[{name:"GraphTako",uuid:"de897ba0",position:[-0,-7.78,-29.78],scale:[5.763,5.763,5.763]},{name:"Plane",uuid:"5e9cf8ad",position:[-.569,-11.168,-31.346],scale:[103.398,103.398,103.398],animation:{uState:33},uniforms:{uState:33}},{name:"TakoGate",uuid:"27599264",position:[-.72,-10.023,-3.232],scale:[5.593,5.593,5.593],animation:{uState:63},uniforms:{uState:63}},{name:"TakoKosen",uuid:"77db9e8a",position:[-.441,-9.975,-3.491],scale:[5.875,5.875,5.875],animation:{uState:64},uniforms:{uState:64}},{name:"TakoNigiri",uuid:"f14b3580",position:[1.152,-8.926,-5.469],rotation:[-.867,1.807,.213],scale:[13.213,13.213,13.213],visible:!1,animation:{position:68,rotation:69,hide:70}},{name:"TakoNigiri.001",uuid:"2a16e1b2",position:[-2.278,-13.761,-1.202],rotation:[-.821,-.277,-.063],scale:[10.71,10.71,10.71],visible:!1,animation:{position:66,rotation:65,hide:67}}]},{name:"SceneTsuri",uuid:"3cb58617",position:[-713.899,10.301,-.112],visible:!1,animation:{hide:48},children:[{name:"Ocean",uuid:"727525da",position:[.648,-10.253,-.914],animation:{uState:32},uniforms:{uState:32}},{name:"SkyBoxTuri",uuid:"4afddbe4",position:[.629,-10.301,-.599],rotation:[0,-3.577,0],scale:[.251,.251,.251]},{name:"Taiyaki",uuid:"d454a187",position:[.819,-12.409,-9.969],rotation:[.793,0,-0],scale:[5.456,5.456,5.456],animation:{position:59,rotation:60,uState:61},uniforms:{uState:61}},{name:"Teibo",uuid:"ddc6e769",position:[14.99,-9.752,1.378],scale:[34.744,2,4.351]},{name:"Teibo.001",uuid:"69f163d9",position:[18.571,-9.752,20.907],rotation:[0,-1.566,0],scale:[34.744,2,4.351]},{name:"ukonpower",uuid:"5fe0ec15",position:[1.489,-8.188,-.527],scale:[1.575,1.575,1.575]}]},{name:"SkyBox",uuid:"60382d7c",position:[46.874,3.846,11.143],scale:[1.235,1.235,1.235],animation:{uState:49},uniforms:{uState:49}},{name:"Spot",uuid:"d9fff7dc",position:[92.626,9.823,16.176],rotation:[.991,.069,.87],type:"light",animation:{hide:50},param:{shadow_map:!1,color:{x:1,y:1,z:1},intensity:2,type:"spot",angle:.785,blend:.15}},{name:"Spot.001",uuid:"3f8ac3fd",position:[-.436,31.409,7.075],rotation:[-.005,0,0],type:"light",visible:!1,animation:{hide:8,light:9},param:{shadow_map:!0,color:{x:1,y:1,z:1},intensity:.002,type:"spot",angle:2.119,blend:1,distance:400}},{name:"Spot.002",uuid:"cc736d54",position:[-.436,-158.07,436.502],rotation:[.965,0,-0],type:"light",param:{shadow_map:!1,color:{x:1,y:1,z:1},intensity:1.13,type:"spot",angle:1.864,blend:1,distance:361.31}},{name:"Sun",uuid:"130e1f31",position:[66.81,52.478,116.473],rotation:[.169,1.119,-.425],type:"light",animation:{hide:51},param:{shadow_map:!1,color:{x:1,y:1,z:1},intensity:1,type:"directional"}}],type:"empty",visible:!0},vy={start:1,end:4280,fps:30,playing:!1},Au={version:fy,animations:hy,fcurves:my,root:py,frame:vy};class yf extends b{constructor(n){super(n);c(this,"blidge");c(this,"type");c(this,"blidgeRoot");c(this,"entities");c(this,"animationState");c(this,"connection");c(this,"reloadTimerId");c(this,"saveSceneTimerId");c(this,"connectionTimeoutId");this.entities=new Map,this.type="websocket",this.connection={enabled:!0,url:"ws://localhost:3100"},this.reloadTimerId=null,this.saveSceneTimerId=null,this.connectionTimeoutId=null,this.animationState={playing:!1,scrubbing:!1,currentFrame:0},this.blidgeRoot=null,this.blidge=new mm(O);const i=this.onSyncScene.bind(this),r=d=>{if(this.entity){this.animationState.playing=d.playing||!1,this.animationState.scrubbing=d.scrubbing||!1,this.animationState.currentFrame=d.current;const h=!this.animationState.scrubbing;this.emit("update/blidge/frame",[d,{interpolate:h,scrubbing:this.animationState.scrubbing}])}},s=d=>{if(this.entity){const h=d.selected[0];if(h&&h.uuid){const f=this.entities.get(h.uuid);f&&this.emit("update/blidge/selection",[f])}}};this.blidge.on("sync/scene",i),this.blidge.on("sync/timeline",r),this.blidge.on("sync/selection",s),this.once("dispose",()=>{this.blidge.off("sync/scene",i),this.blidge.off("sync/timeline",r),this.blidge.off("sync/selection",s)});const o=async()=>{this.connectionTimeoutId!==null&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=null),this.type=="json"?(await this.blidge.loadScene(Au),this.emit("loaded")):(this.blidge.connect(this.connection.url),this.connectionTimeoutId=window.setTimeout(async()=>{console.warn("[BLidgeClient] WebSocket connection timeout. Falling back to JSON..."),await this.blidge.loadScene(Au),this.emit("loaded"),this.connectionTimeoutId=null},1e3))},a=()=>{this.reloadTimerId!==null&&clearTimeout(this.reloadTimerId),this.reloadTimerId=window.setTimeout(()=>{this.reloadTimerId=null,o()},500)};this.field("mode",()=>this.type,d=>{this.type=d,a()},void 0);const l=this.fieldDir("websocket",{hidden:()=>this.type!="websocket"});l.field("reconnect",()=>()=>o(),void 0,{label:"Reconnect"}),l.field("url",()=>this.connection.url,d=>this.connection.url=d),re.getInstance(O).registerBLidgeClient(this)}saveSceneToLocal(n){this.saveSceneTimerId!==null&&clearTimeout(this.saveSceneTimerId),this.saveSceneTimerId=window.setTimeout(async()=>{this.saveSceneTimerId=null;try{const i=await fetch("/api/writeScene",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sceneData:n})});if(!i.ok){const r=await i.text();throw new Error(`HTTP error! status: ${i.status}, body: ${r}`)}}catch(i){console.error("[BLidgeClient] Failed to save blidge-data.json:",i)}},1e3)}onSyncScene(n){this.connectionTimeoutId!==null&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=null);const i=new Date().getTime(),r=o=>{let a;if(o.uuid&&(a=this.entities.get(o.uuid)),a||(a=this.entities.get(o.name)),a||(a=new oe),o.type=="camera"){const u=o.param;a.userData.cameraParam=u}a.removeComponent(vt),a.addComponent(vt,{blidge:n,node:o}),o.children.forEach(u=>{const d=r(u);a.add(d)});const l=o.uuid||a.name;return this.entities.set(l,a),a.userData.updateTime=i,a},s=n.root&&r(n.root);s&&(s.name="blidgeRoot",this.blidgeRoot&&this.entity&&this.entity.remove(this.blidgeRoot),this.blidgeRoot=s,this.entity&&this.entity.add(this.blidgeRoot)),this.entities.forEach(o=>{if(o.userData.updateTime!=i){const a=o.parent;a&&a.remove(o),o.dispose(),this.entities.delete(o.name)}}),this.entity&&this.blidgeRoot&&(re.getInstance(O).applyProjectOverrides(this.blidgeRoot),this.emit("sceneCreated",[this.blidgeRoot]))}getAnimationState(){return{...this.animationState}}dispose(){super.dispose(),this.reloadTimerId!==null&&(clearTimeout(this.reloadTimerId),this.reloadTimerId=null),this.saveSceneTimerId!==null&&(clearTimeout(this.saveSceneTimerId),this.saveSceneTimerId=null),this.connectionTimeoutId!==null&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=null),this.blidgeRoot&&(this.blidgeRoot.disposeRecursive(),this.entity.remove(this.blidgeRoot),this.blidgeRoot=null)}}const gy=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/shaders/gaussBlur.fs
in vec2 vUv;uniform sampler2D uBackBuffer0;uniform vec2 uPPResolution;uniform bool uIsVertical;uniform float uBlurRange;
#ifdef USE_BACKBLURTEX
uniform sampler2D uBackBlurTex;
#endif
layout(location=0)out vec4 outColor;uniform float uWeights[GAUSS_WEIGHTS];vec3 u(sampler2D u){vec3 v=uWeights[0]*texture(u,vUv).xyz;for(int f=1;f<GAUSS_WEIGHTS;f++){vec2 U=(uIsVertical?vec2(0,f):vec2(f,0))*uBlurRange;v=v+uWeights[f]*texture(u,vUv+U/uPPResolution).xyz+uWeights[f]*texture(u,vUv-U/uPPResolution).xyz;}return v;}void main(){vec3 v=vec3(0);
#ifdef USE_BACKBLURTEX
v=u(uBackBlurTex);
#else
v=u(uBackBuffer0);
#endif
outColor=vec4(v,1);}`,yy=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/Bloom/shaders/bloomBright.fs
uniform sampler2D uSrcTexture1;uniform float uThreshold,uBrightness;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){outColor=vec4(max(texture(uSrcTexture1,vUv).xyz-uThreshold,vec3(0))/10.*uBrightness,1);}`,xy=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/Bloom/shaders/bloomComposite.fs
#include<common>
uniform sampler2D uBackBuffer0,uBloomTexture[4];in vec2 vUv;layout(location=0)out vec4 outColor;void main(){vec3 l=texture(uBackBuffer0,vUv).xyz;
#pragma loop_start 4
l+=texture(uBloomTexture[LOOP_INDEX],vUv).xyz*((float(LOOP_INDEX)+1.)/4.);
#pragma loop_end
outColor=vec4(l,1);}`;class _y extends et{constructor(t){const{pipeline:n,args:i}=t;let r=i&&i.srcTexture;if(!r){const v=n.entity.getComponent(Wr);if(r=v&&v.renderTarget.shadingBuffer.textures[0]||void 0,!r)throw new Error("Bloom requires RenderCamera component or srcTexture argument")}const s=4,o=[],a=[];for(let v=0;v<s;v++)o.push(new Z(O).setTexture([new W(O).setting({magFilter:O.LINEAR,minFilter:O.LINEAR})])),a.push(new Z(O).setTexture([new W(O).setting({magFilter:O.LINEAR,minFilter:O.LINEAR})]));let l=2;const u=new Q(O,{name:"bloom/bright/",frag:yy,passThrough:!0,uniforms:{uSrcTexture1:{value:r,type:"1i"},uThreshold:{value:1,type:"1f"},uBrightness:{value:1,type:"1f"}},resolutionRatio:1/l}),d=[];let h=u.renderTarget.textures;for(let v=0;v<s;v++){const x=o[v],_=a[v],z=8,g={name:"bloom/blur/"+v+"/v",renderTarget:x,frag:gy,uniforms:{uBackBlurTex:{value:h,type:"1i"},uIsVertical:{type:"1i",value:!0},uWeights:{type:"1fv",value:ct.gaussWeights(z)},uBlurRange:{value:2,type:"1f"}},defines:{GAUSS_WEIGHTS:z.toString(),USE_BACKBLURTEX:""},passThrough:!0,resolutionRatio:1/l};d.push(new Q(O,g)),d.push(new Q(O,{...g,name:"bloom/blur/"+v+"/h",renderTarget:_,uniforms:{...g.uniforms,uBackBlurTex:{value:x.textures[0],type:"1i"},uIsVertical:{type:"1i",value:!1}}})),h=_.textures,l*=2}const f=new Q(O,{name:"bloom/composite/",frag:xy,uniforms:{uBloomTexture:{value:a.map(v=>v.textures[0]),type:"1iv"}}});super({name:"Bloom",passes:[u,...d,f]})}get threshold(){return this.passes[0].uniforms.uThreshold.value}set threshold(t){this.passes[0].uniforms.uThreshold.value=t}get brightness(){return this.passes[0].uniforms.uBrightness.value}set brightness(t){this.passes[0].uniforms.uBrightness.value=t}}const wy=`// @shader-file: src/resources/Components/Camera/MainCamera/shaders/gaussBlur.fs
in vec2 vUv;uniform sampler2D uBackBuffer0;uniform vec2 uPPResolution;uniform bool uIsVertical;uniform float uBlurRange;
#ifdef USE_BACKBLURTEX
uniform sampler2D uBackBlurTex;
#endif
layout(location=0)out vec4 outColor;uniform float uWeights[GAUSS_WEIGHTS];vec3 u(sampler2D u){vec3 v=uWeights[0]*texture(u,vUv).xyz;for(int f=1;f<GAUSS_WEIGHTS;f++){vec2 U=(uIsVertical?vec2(0,f):vec2(f,0))*uBlurRange;v=v+uWeights[f]*texture(u,vUv+U/uPPResolution).xyz+uWeights[f]*texture(u,vUv-U/uPPResolution).xyz;}return v;}void main(){vec3 v=vec3(0);
#ifdef USE_BACKBLURTEX
v=u(uBackBlurTex);
#else
v=u(uBackBuffer0);
#endif
outColor=vec4(v,1);}`;class Sy extends et{constructor(n){const r={name:"bokeh/v",frag:wy,uniforms:{uIsVertical:{type:"1i",value:!0},uWeights:{type:"1fv",value:ct.gaussWeights(8)},uBlurRange:{value:6,type:"1f"}},defines:{GAUSS_WEIGHTS:"8"},resolutionRatio:1},s=new Q(O,r),o=new Q(O,{...r,name:"bokeh/h",uniforms:{...r.uniforms,uIsVertical:{type:"1i",value:!1}}});super({name:"Bokeh",passes:[s,o]});c(this,"bokehV");c(this,"bokehH");this.bokehV=s,this.bokehH=o,this.enabled=!0}}const Cy=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/ColorGrading/shaders/colorGrading.fs
#include<common>
uniform sampler2D uBackBuffer0;in vec2 vUv;layout(location=0)out vec4 outColor;void main(){outColor=vec4(texture(uBackBuffer0,vUv).xyz,1);}`;class Ey extends et{constructor(t){super({name:"ColorGrading",passes:[new Q(O,{name:"colorGrading",frag:Cy})]})}}const Ty=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/Finalize/shaders/finalize.fs
#include<common>
#include<random>
#include<noise_simplex>
uniform float uTimeEF;uniform sampler2D uBackBuffer0;uniform vec4 uPP;in vec2 vUv;layout(location=0)out vec4 outColor;vec2 l(vec2 l,float v){return l*(1.-v*dot(l,l));}void main(){vec3 v=vec3(0);vec2 u=vUv-.5;float f;
#pragma loop_start 8
f=-float(LOOP_INDEX)/8.*(.09*smoothstep(.4,.55,length(u)));v.x+=texture(uBackBuffer0,l(u*.98,f*0.)+.5+vec2((float(LOOP_INDEX)/8.-.5)*.002,0)).x;v.y+=texture(uBackBuffer0,l(u*.98,f*3.)+.5).y;v.z+=texture(uBackBuffer0,l(u*.98,f*6.)+.5).z;
#pragma loop_end
v.xyz/=8.;v*=smoothstep(1.2,.3,length(u));v.xyz+=random(vUv+floor(uTimeEF*18.)*.5)*.02;v.xyz*=uPP.x;outColor=vec4(v,1);}`;class zy extends et{constructor(t){const{pipeline:n}=t,i=n.entity.getComponent(vt),r=A.merge(R.time);i&&i.bindUniforms(r),super({name:"Finalize",passes:[new Q(O,{name:"finalize",frag:Ty,uniforms:r})]})}}const Py=`// @shader-file: src/resources/Components/Camera/MainCamera/PostProcess/FXAA/shaders/fxaa.fs
uniform sampler2D uBackBuffer0;uniform vec2 uPPPixelSize;in vec2 vUv;layout(location=0)out vec4 outColor;vec4 t(vec2 v){return texture(uBackBuffer0,vUv+v*uPPPixelSize);}
#define FXAA_REDUCE_MIN (1.0/128.0)
#define FXAA_REDUCE_MUL (1.0/16.0)
#define FXAA_SPAN_MAX 8.0
void main(){vec3 v=vec3(.299,.587,.114);float u=dot(t(vec2(-1,1)).xyz,v),m=dot(t(vec2(1)).xyz,v),z=dot(t(vec2(-1)).xyz,v),F=dot(t(vec2(1,-1)).xyz,v),a=dot(texture(uBackBuffer0,vUv).xyz,v);vec2 e;e.x=-u-m+z+F;e.y=u+z-m-F;float d=1./(min(abs(e.x),abs(e.y))+max((u+m+z+F)*(.25*FXAA_REDUCE_MUL),FXAA_REDUCE_MIN));e=min(vec2(FXAA_SPAN_MAX),max(vec2(-FXAA_SPAN_MAX,-FXAA_SPAN_MAX),e*d))*uPPPixelSize.xy;vec3 X=.5*(texture(uBackBuffer0,vUv+e*(1./3.-.5)).xyz+texture(uBackBuffer0,vUv+e*(2./3.-.5)).xyz),l=X*.5+.25*(texture(uBackBuffer0,vUv+e*-.5).xyz+texture(uBackBuffer0,vUv+e*.5).xyz);d=dot(l,v);outColor=d<min(a,min(min(u,m),min(z,F)))||d>max(a,max(max(u,m),max(z,F)))?vec4(X,1):vec4(l,1);}`;class ky extends et{constructor(t){super({name:"FXAA",passes:[new Q(O,{name:"fxaa",frag:Py})]})}}const xf=new De;new Promise(e=>{xf.once("createdCamera",t=>{e(t)})});class My extends b{constructor(n){super(n);c(this,"renderCamera");c(this,"_commonUniforms");c(this,"_renderTarget");c(this,"_lookAt");c(this,"_orbitControls");c(this,"postProcessPipeline");c(this,"_resolution");c(this,"_resolutionInv");c(this,"_tmpVector1");c(this,"_tmpVector2");c(this,"_dofTarget");c(this,"_bokeh");this._resolution=new M,this._resolutionInv=new M,this._commonUniforms=A.merge({uResolution:{type:"2f",value:this._resolution},uResolutionInv:{type:"2f",value:this._resolutionInv}}),this.renderCamera=this.entity.addComponent(Wr,{gl:O}),this._renderTarget=this.renderCamera.renderTarget,this._lookAt=this.entity.addComponent(gf),xf.emit("createdCamera",[this.renderCamera]),this.postProcessPipeline=this.entity.addComponent(lc),this.postProcessPipeline.add(ky);const i=this.postProcessPipeline.add(_y,{srcTexture:this.renderCamera.renderTarget.shadingBuffer.textures[0]});i.threshold=1,i.brightness=1,this.postProcessPipeline.add(Ey),this._bokeh=this.postProcessPipeline.add(Sy),this.postProcessPipeline.add(zy),this._dofTarget=null,this._tmpVector1=new M,this._tmpVector2=new M;const r=u=>{const d=u.findEntityByName("Camera")||null,h=d==null?void 0:d.getComponent(vt),f=this.entity.getComponent(vt);h&&f&&(h.transformAutoUpdate=f.transformAutoUpdate);const v=u.findEntityByName("CamLook")||null;this._lookAt.setTarget(v),this._dofTarget=u.findEntityByName("CamDof")||null},s=re.getInstance(O),o=s.root.getComponent(yf);o&&(o.on("sceneCreated",r),this.once("dispose",()=>{o.off("sceneCreated",r)})),s.setCamera(this.entity),R.gBuffer.uGBufferPos.value=this.renderCamera.gBuffer.textures[0],R.gBuffer.uGBufferNormal.value=this.renderCamera.gBuffer.textures[1];const a=this.entity.getRootEntity(),l=a.findEntityByName("CamLook")||null;this._lookAt.setTarget(l),this._dofTarget=a.findEntityByName("CamDof")||null}updateImpl(n){this.resize(n.resolution),this.updateCameraParams(),this.entity.matrixWorld.decompose(this._tmpVector1),this._dofTarget&&this._dofTarget.matrixWorld.decompose(this._tmpVector2),this.renderCamera.dofParams.focusDistance=this._tmpVector1.sub(this._tmpVector2).length();const i=this.entity.getComponent(vt);if(i){const r=i.uniforms.uPP;if(r){const s=r.value.y;this._bokeh.bokehV.uniforms.uBlurRange.value=s,this._bokeh.bokehH.uniforms.uBlurRange.value=s}}}resize(n){n.x==this._resolution.x&&n.y==this._resolution.y||(this._resolution.copy(n),this._resolutionInv.set(1/n.x,1/n.y,0,0),this.renderCamera.resize(this._resolution),this.postProcessPipeline.resize(n),this.updateCameraParams())}updateCameraParams(){this.renderCamera.aspect=this._resolution.x/this._resolution.y,this.renderCamera.near=.5,this.renderCamera.far=3e3,this.renderCamera.needsUpdateProjectionMatrix=!0;const n=this.entity.getComponent(vt);if(n){const i=n.animations.get("state");i&&(this.renderCamera.fov=2*Math.atan(12/(2*i.value.x))/Math.PI*180,this._lookAt.enabled=i.value.y>.5)}}}const Ry=`// @shader-file: src/resources/Components/Demo4/Common/DebaBouChou/shaders/debaBouChou.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<random>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform float uTimeE;uniform sampler2D uNoiseTex;SDFResult D(vec3 v){vec3 o=v;o.y-=.6;vec2 x=vec2(100,1);vec3 s=o;s.yz*=rotate(HPI);s.xyz*=.7;s.z+=-.13;s.z*=.1+length(s.z*.5);s.x-=pow(s.z,3.)*.3;vec3 u=s+vec3(-.4,0,0),l=s+vec3(.4,0,0);float f=.01*linearstep(.09,.02,length(max(vec2(0),s.xz)*vec2(1,.3))),z=sdCappedCylinder(u,.5,f);f=sdCappedCylinder(l,.5,f);x.x=opAnd(z,f);x.x=opAnd(x.x,sdBox(s+vec3(0,0,.49),vec3(.5)));x.x=opSmoothSub(sdBox(s+vec3(-.08,0,-.1),vec3(.1)),x.x,0.);s=o;s.x+=.03;s.y+=.6;s.x+=.05;x=opAdd(x,vec2(sdCappedCylinder(s,.08-s.y*.02,.3),2));return SDFResult(x.x,v,x.y,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,128,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec2 s=rayPos.xy*.5+.5;float x=dist.mat;vec3 o=vec3(1);float v=.5,f=0.;if(x==1.)o=vec3(.9,.92,.95),v=.01,f=1.;else if(x==2.)o=vec3(1,.7,.45),v=1.,f=0.;outNormal=normalize(outNormal+texture(uNoiseTex,s+texture(uNoiseTex,s).xy).xyz*.15);outColor.xyz=o;outRoughness=v;outMetalic=f;
#include<frag_out>
}`;class Dy extends b{constructor(n){super(n);c(this,"mesh");const i=new Je({height:2,depth:.2,width:.4}),r=new K().setFromTransform(new M(0,.6,0));i.applyMatrix(r);const s=new X({frag:Ry,uniforms:A.merge(R.resolution,R.time,R.noiseTex)});this.mesh=this.entity.addComponent(B,{geometry:i,material:s})}disposeImpl(){this._entity.removeComponent(B)}}const Fy=`// @shader-file: src/resources/Components/Demo4/Common/HUD/shaders/hud.fs
#include<common>
#include<packing>
#include<frag_h>
#include<rotate>
#include<sdf>
uniform float uTimeE;uniform vec4 uState;void main(){
#include<frag_in>
const mat2 m=mat2(1,.5,0,.865);vec2 l=vUv-.5;float u=uResolution.x/uResolution.y;vec2 v=abs(l);v.y/=u;v*=rotate(HPI*.8);v.y+=uTimeE*.01*sign(l.y);v*=15.57;vec2 f=v*mat2(1,-1./1.73,0,2./1.73);vec3 y=fract(vec3(f,1.-f.x-f.y)),a=floor(vec3(f,1.-f.x-f.y));if(length(y)>1.)y=1.-y;f=a.xy*m;float e=length(f+vec2(1,0)-v),r=length(f+vec2(.5,.865)-v),s=length(f+vec2(1.5,.865)-v),x=length(f+vec2(2,0)-v);a+=x<1.?vec3(2,0,0):s<1.?vec3(1,1,0):e<1.?vec3(1,0,0):r<1.?vec3(0,1,0):vec3(0);vec2 n=a.xy*m;float E=length(n-v),I=sin(E*PI*10.-sin(uTimeE*.3+length(n.x)*2.)*10.)*(smoothstep(3.6,8.,n.x)*.5);vec2 H=l;H.x*=u;H.y=abs(H.y);H.x=abs(H.x);float B=smoothstep(.009,.007,length(H+vec2(0,-.44)))+smoothstep(.009,.007,length(H+vec2(-.05,-.44)))+smoothstep(.009,.007,length(H+vec2(-1.08,0)))+smoothstep(.009,.007,length(H+vec2(-1.08,-.05)));I+=B*.4;I=max(I,smoothstep(.004,.002,abs(sdBox(H,vec2(1.1,.46))-.02))*.3);I*=uState.x;outColor=vec4(1,1,1,I);
#include<frag_out>
}`,Ny=`// @shader-file: src/resources/Components/Demo4/Common/HUD/shaders/hud.vs
#include<common>
#include<vert_h>
void main(){
#include<vert_in>

#include<vert_out>
gl_Position=vec4(position.xy,0,1);}`;function Se(e,t){const n=e.getComponent(vt);if(!n)return;let i;t instanceof B?i=t.material.uniforms:t instanceof X?i=t.uniforms:i=t,n.bindUniforms(i)}class Iy extends b{constructor(n){super(n);c(this,"material");const i=new yn({width:2,height:2});this.material=new X({phase:["ui"],vert:Ny,frag:Fy,depthTest:!1,depthWrite:!1,uniforms:A.merge(R.time,R.resolution)}),this.entity.addComponent(B,{geometry:i,material:this.material}),Se(this.entity,this.material)}}const By=`// @shader-file: src/resources/Components/Demo4/Common/MizuBall/shaders/mizuBall.fs
#include<common>
#include<frag_h>
#include<rotate>
#include<light>
#include<pmrem>
#include<noise_cyclic>
uniform sampler2D uEnvMap;void main(){
#include<frag_in>
vec3 n=normalize(vNormal);outNormal=n;outRoughness=.1;outMetalic=0.;outColor.xyz=vec3(0);
#ifdef IS_FORWARD

#include<lighting_forwardIn>
vec2 z=gl_FragCoord.xy/uResolution;float u=dot(geo.normal,geo.viewDir),t=fresnel(u);vec3 r=normalize(vViewNormal);for(int e=0;e<16;e++){vec2 u=-r.xy*(float(e+1)/4.*.015+.05);outColor.x+=texture(uDeferredTexture,z+u).x;outColor.y+=texture(uDeferredTexture,z+u*1.3).y;outColor.z+=texture(uDeferredTexture,z+u*1.6).z;}outColor.xyz/=16.;outColor.xyz*=vec3(.95,.95,1);outColor.w=1.;outColor.xyz+=t*2.;
#include<lighting_light>

#include<lighting_env>

#endif

#include<frag_out>
}`;class Ay extends b{constructor(t){super(t);const n=new xt({radius:1,widthSegments:16,heightSegments:16}),i=new X({frag:By,phase:["forward"],uniforms:A.merge(R.resolution,R.time)});this.entity.addComponent(B,{geometry:n,material:i})}}const by=`// @shader-file: src/resources/Components/Demo4/Maguro/Sashimi/shaders/sashimi.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform sampler2D uNoiseTex,uNoiseCyclicTex;uniform float uTimeE,uEmission;SDFResult D(vec3 v){vec3 o=v;o.y-=.2;vec3 s=o;s.yz*=rotate(smoothstep(0.,.8,abs(s.z))*sign(s.z)*.3);s.xy*=rotate(-smoothstep(0.,.3,abs(s.x))*sign(s.x)*.4);vec2 u=vec2(9999999,1);
#if defined(TAKO)
s.y+=texture(uNoiseTex,v.xz*.1-vec2(.1,.3)+texture(uNoiseTex,v.xz*.1-vec2(.1,.3)).xy*3.).x*.02;s.x*=1.2+sin(-HPI+s.z*4.)*.4;s.y-=(texture(uNoiseTex,s.xz*.1-vec2(.1,.3)+vec2(0,uTimeE*.01)).x-.45)*smoothstep(.05,.2,abs(s.x))*.3;s.x+=sin(s.z*30.)*.2*smoothstep(.1,1.,abs(s.x));u.x=sdBox(s,vec3(.25,.02,.4));
#else
s.y+=texture(uNoiseTex,v.xz*2.-vec2(.1,.3)).x*.02;u.x=sdBox(s,vec3(.2,.01+texture(uNoiseTex,v.xz*.1-vec2(.1,.3)).x*.08,.65));vec3 x=s;x.xz+=vec2(0);x.xz*=rotate(.3);u.x=opAnd(sdBox(x,vec3(1,.2,.4)),u.x);
#endif
return SDFResult(u.x,v,u.y,vec4(s,0));}
#include<subsurface>
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,64,0.001,0.7>
if(!hit)discard;vec4 s=texture(uNoiseTex,rayPos.xz*.1+.5),u=texture(uNoiseTex,rayPos.xz*4.+.5);float z=subsurface(rayPos,normalize(vec3(1,1,0)),.15);outNormal=N(rayPos,.01);outNormal=normalize(outNormal+(u.y-.5)*.4);
#include<rm_out_obj>
float v=dot(rayDir,-outNormal.xyz);vec3 o=vec3(1),x=vec3(0);
#if defined(SALMON)
o=vec3(1,.4,.2);x=vec3(1,.4,.1);
#elif defined(TAKO)
o=vec3(1,.95,.9);o.xyz=mix(o.xyz,vec3(.8,0,.1),smoothstep(.16,.23,abs(dist.matparam.x)));x=vec3(1,.8,.7);
#else
o=vec3(.9,.15,.1);x=vec3(.9,.1,.2);
#endif
outColor.xyz=o;outColor.xyz=mix(outColor.xyz,vec3(1),smoothstep(.8,1.,fract(length(rayPos.xz+.5+s.xy*.3)*5.))*s.y*.8);outEmission.xyz+=x*z*.9*smoothstep(1.5,0.,v);outRoughness=.4;outColor.xyz*=smoothstep(1.5,.4,length(rayPos));outRoughness=.2+u.y*.2;outMetalic=.3;outEmission*=1.+uEmission*3.;outEmission+=outColor.xyz*.2;
#include<frag_out>
}`;class _f extends b{constructor(n){super(n);c(this,"sashimiType");c(this,"material");this.sashimiType="maguro",this.material=new X({frag:by,uniforms:A.merge(R.resolution,R.time,R.tex,{uEmission:{value:0,type:"1f"}})}),this.field("sashimiType",()=>this.sashimiType,r=>{this.sashimiType=r;const s={};r==="salmon"?s.SALMON="":r==="ikura"?s.IKURA="":r==="tako"&&(s.TAKO=""),this.material.defines=s,this.material.requestUpdate()},void 0);const i=new Je({depth:1,width:.6,height:.3});i.applyMatrix(new K().setFromTransform(new M(0,.11,0))),this.entity.addComponent(B,{geometry:i,material:this.material})}set emission(n){this.material.uniforms.uEmission.value=n}}const Ly=`// @shader-file: src/resources/Components/Demo4/Common/Shari/shaders/shari.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<rm_h>
in vec4 vId,vId2;in mat4 vTransformMatrix;SDFResult D(vec3 v){vec3 r=vec3(.25,.5,.22)*2.;float m=sdSphere(v/r,.8)*min(min(r.x,r.y),r.z);vec2 d=vec2(m,0);return SDFResult(d.x,v,d.y,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>
mat4 v=inverse(vTransformMatrix);vec3 r=(v*vec4(rayPos,1)).xyz,d=normalize((v*vec4(rayDir,0)).xyz);SDFResult m;bool z=false;for(int e=0;e<64;e++){m=D(r);r+=m.d*d;if(m.d<.001){z=true;break;}}if(!z)discard;vec3 s=N(r,.01);outNormal=normalize((transpose(v)*vec4(s,0)).xyz);rayPos=(vTransformMatrix*vec4(r,1)).xyz;
#include<rm_out_obj>
outColor.xyz=vec3(1,.95,.9)*(.9+vId.y*.1);outRoughness=.3+vId.z*.2;outMetalic=0.;outEmission+=.15;
#include<frag_out>
}`,Uy=`// @shader-file: src/resources/Components/Demo4/Common/Shari/shaders/shari.vs
#include<common>
#include<vert_h>
layout(location=4)in vec4 id;layout(location=5)in vec4 id2;
#include<rotate>
#include<matrix>
uniform float uTime;out vec4 vId,vId2;out mat4 vTransformMatrix;void main(){
#include<vert_in>
vec3 v=id2.xyz-.5;v.xyz*=vec3(.225,.15,.55);float l=id.y*TPI,n=id.z*TPI;mat4 d=makeScale(.1),T=makeRotationXY(l),o=makeRotationYZ(n),i=makeTranslation(v);vTransformMatrix=i*o*T*d;outPos=(vTransformMatrix*vec4(outPos*1.8,1)).xyz;mat3 m=normalMatrix(o*T);outNormal=m*outNormal;
#include<vert_out>
vId=id;vId2=id2;}`;class wf extends b{constructor(t){super(t);const n=256,i=new Je({}),r=ct.randomSeed(1),s=[],o=[];for(let a=0;a<n;a++)s.push(a/n,r(),r(),r()),o.push(r(),r(),r(),r());i.setAttribute("id",new Float32Array(s),4,{instanceDivisor:1}),i.setAttribute("id2",new Float32Array(o),4,{instanceDivisor:1}),this._entity.addComponent(B,{geometry:i,material:new X({phase:["deferred","shadowMap"],vert:Uy,frag:Ly,uniforms:A.merge(R.time,R.resolution)})})}}class Qi extends b{constructor(n){super(n);c(this,"sashimiTypeValue","maguro");c(this,"emissionValue",0);c(this,"shariEntity");c(this,"sashimiEntity");c(this,"sashimiComponent");this.shariEntity=new oe,this.shariEntity.name="Shari",this.shariEntity.addComponent(wf),this.shariEntity.position.set(0,-0,0),this.entity.add(this.shariEntity),this.sashimiEntity=new oe,this.sashimiEntity.name="Sashimi",this.sashimiEntity.position.set(0,0,0),this.entity.add(this.sashimiEntity),this.sashimiComponent=this.sashimiEntity.addComponent(_f),this.field("sashimiType",()=>this.sashimiTypeValue,i=>{this.sashimiTypeValue=i,this.sashimiComponent.setField("sashimiType",i)},void 0),this.sashimiComponent.setField("sashimiType",this.sashimiTypeValue)}set sashimiType(n){this.setField("sashimiType",n)}set emission(n){this.emissionValue=n,this.updateEmissionUniforms()}updateEmissionUniforms(){this.sashimiComponent&&(this.sashimiComponent.emission=this.emissionValue)}disposeImpl(){this.entity.remove(this.shariEntity),this.shariEntity.dispose(),this.entity.remove(this.sashimiEntity),this.sashimiEntity.dispose()}}const jy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/ikuraBGScreen.fs
#include<common>
#include<packing>
#include<frag_h>
#include<noise_simplex>
in vec2 vLayerIndex;uniform float uTime;uniform vec4 uState;uniform sampler2D uNoiseTex;void main(){
#include<frag_in>
vec2 v=vUv;float o=smoothstep(0.,1.,((-1.+vLayerIndex.y)*.5-length(vec2(1.-v.x,v.y))*.5)*.3+uState.x*1.3);o=easeOut(o,2.5);float s=noiseSimplex(vec3((v*2.-1.)*1.5-vLayerIndex.x*vec2(.1,-.1)+vec2(.85,-.04),uTime*.098))*.5+.5,n=s-o+1.;if(n>.5-(1.-vLayerIndex.y)*.2)discard;vec3 e=mix(vec3(0,.6,0),vec3(0,.3,0),vLayerIndex.y);outColor=vec4(e,1);outRoughness=.3;outMetalic=.2;outEmission=e;outEnv=0.;outGradient=1.;
#include<frag_out>
}`,Oy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/maguroBGScreen.fs
#include<common>
#include<packing>
#include<frag_h>
#include<noise_simplex>
in vec2 vLayerIndex;uniform float uTime;uniform vec4 uState;uniform sampler2D uNoiseTex;void main(){
#include<frag_in>
vec2 v=vUv;float u=noiseSimplex(vec3((v*2.-1.)*2.5,vLayerIndex.x*10.+uTime*.2))*.5+.5,e=length(v-.5),o=smoothstep(0.,1.,((-1.+vLayerIndex.y)*.5-length(vec2(1.-v.x,v.y))*.5)*.3+uState.x*1.3);o=easeBounce(o,2.5);e=e+u*.1-(1.-o)*.5;if(e<.15+(1.-vLayerIndex.y)*.1)discard;vec3 s=mix(vec3(1,0,0),vec3(.5,0,0),vLayerIndex.y);outColor=vec4(s,1);outRoughness=.4;outMetalic=.3;outEmission=s;outEnv=0.;outGradient=1.;
#include<frag_out>
}`,Vy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/salmonBGScreen.fs
#include<common>
#include<packing>
#include<frag_h>
#include<noise_simplex>
in vec2 vLayerIndex;uniform float uTime;uniform vec4 uState;uniform sampler2D uNoiseTex;void main(){
#include<frag_in>
vec2 v=vUv,u=v-.5;float x=noiseSimplex(vec3((v*2.-1.)*2.+uTime*.4,vLayerIndex.x*10.+uTime*.2))*.5+.5,e=length(-u.x*.5+u.y),o=smoothstep(0.,1.,(-vLayerIndex.y*.5-length(vec2(1.-v.x,v.y))*.5)*.3+uState.x*1.3);o=easeBounce(o,2.5);e=e+x*.1-(1.-o)*.3;if(e<.15+(1.-vLayerIndex.y)*.05)discard;if(u.y-u.x*.4<-.7+max(0.,uState.x-1.)+x*.3)discard;vec3 s=mix(vec3(0,.7,1),vec3(0,.3,1),vLayerIndex.y);outColor=vec4(s,1);outRoughness=.4;outMetalic=.3;outEmission=s;outEnv=0.;outGradient=1.;
#include<frag_out>
}`,Gy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/takoBGScreen.fs
#include<common>
#include<packing>
#include<frag_h>
#include<noise_simplex>
in vec2 vLayerIndex;uniform float uTime;uniform vec4 uState;uniform sampler2D uNoiseTex;void main(){
#include<frag_in>
vec2 v=vUv;float o=smoothstep(0.,1.,((-1.+vLayerIndex.y)*.5-length(vec2(1.-v.x,v.y))*.5)*.3+uState.x*1.3);o=easeOut(o,2.5);float s=noiseSimplex(vec3((v*2.-1.)*1.5-vLayerIndex.x*vec2(.1,-.1)+vec2(.85,-.04),uTime*.098))*.5+.5,n=s-o+1.;if(n>.5-(1.-vLayerIndex.y)*.2)discard;vec3 e=mix(vec3(.3),vec3(0),vLayerIndex.y);outColor=vec4(e,1);outRoughness=.3;outMetalic=.2;outEmission=e;outEnv=0.;outGradient=1.;
#include<frag_out>
}`,Wy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/circle.fs
#include<common>
#include<packing>
#include<frag_h>
#include<rotate>
in vec2 vLayerIndex;uniform float uTime,uTimeOffset;uniform vec4 uState;void main(){
#include<frag_in>
float v=uTime*.2+uTimeOffset;vec2 l=vUv,i=l*2.-1.;i.xy*=rotate(v*20.+uTimeOffset*10.);float u=length(i),n=atan(i.y,i.x),s=(n+PI)/(2.*PI),I=fract(v*1.5),x=linearstep(.15,.3,I),E=linearstep(.7,.85,I);if(s>x)discard;if(1.-s>1.-E)discard;float f=.7+vLayerIndex.y*.1;if(smoothstep(f-.1-.01,f-.1+.01,u)-smoothstep(f-.01,f+.01,u)<.1)discard;outEmission=vec3(1);
#include<frag_out>
}`,Hy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/cross.fs
#include<common>
#include<packing>
#include<frag_h>
#include<sdf>
#include<rotate>
in vec2 vLayerIndex;uniform float uTime,uTimeOffset;uniform vec4 uState;void main(){
#include<frag_in>
vec2 f=vUv*2.-1.;float v=uTime*.5+uTimeOffset;f.xy*=rotate((floor(v)+exp(fract(v)*-5.))*HPI);float u=sdSegment(f,vec2(-.5),vec2(.5));u=min(u,sdSegment(f,vec2(.5,-.5),vec2(-.5,.5)));float e=step(u,.15);if(e<.5)discard;outEmission=vec3(1);
#include<frag_out>
}`,$y=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/border.fs
#include<common>
#include<packing>
#include<frag_h>
in vec2 vLayerIndex;uniform float uTime,uTimeOffset;uniform vec4 uState;void main(){
#include<frag_in>
vec2 u=vUv;float v=uTime+uTimeOffset*10.;u.x+=v*.3;float f=fract((u.x+u.y)*(3.+vLayerIndex.y*2.));if(step(.5,f)*((sin(v*1e2)*.5+.5)*.3+sin(v*2.))<.5)discard;outEmission=vec3(1);
#include<frag_out>
}`,Xy=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/dotGrid.fs
#include<common>
#include<packing>
#include<frag_h>
in vec2 vLayerIndex;uniform float uTime,uTimeOffset;uniform sampler2D uNoiseTex;uniform vec4 uState;void main(){
#include<frag_in>
float u=uTime+uTimeOffset*3.;vec2 v=vUv;float f=8.+vLayerIndex.y*4.;if(texture(uNoiseTex,floor(v*f)*.1+u*.05).x<sin(u*2.)*.3+.5)discard;float e=.4+vLayerIndex.y*.2;if(1.-smoothstep(e-.05,e+.05,length(fract(v*f)*2.-1.))<.5)discard;outEmission=vec3(1);
#include<frag_out>
}`,Nt=`// @shader-file: src/resources/Components/Demo4/Common/ShaderMotionGraphics/shaders/smg.vs
#include<common>
#include<vert_h>
layout(location=4)in vec2 layerIndex;uniform int uLayers;uniform float uLayerSpacing;out vec2 vLayerIndex;void main(){
#include<vert_in>
outPos.z+=layerIndex.x*uLayerSpacing;vLayerIndex=layerIndex;
#include<vert_out>
}`;class Sf extends b{constructor(n){super(n);c(this,"mesh");c(this,"shaderName");c(this,"layers");c(this,"layerSpacing");c(this,"timeOffset");c(this,"shaders");this.shaders=new Map([["ikuraBGScreen",{vert:Nt,frag:jy}],["maguroBGScreen",{vert:Nt,frag:Oy}],["salmonBGScreen",{vert:Nt,frag:Vy}],["takoBGScreen",{vert:Nt,frag:Gy}],["circle",{vert:Nt,frag:Wy}],["cross",{vert:Nt,frag:Hy}],["border",{vert:Nt,frag:$y}],["dotGrid",{vert:Nt,frag:Xy}]]),this.shaderName="ikuraBGScreen",this.layers=1,this.layerSpacing=.01,this.timeOffset=0,this.mesh=this._entity.addComponent(B),this.updateGeometry(),this.updateMaterial(),this.field("shaderName",()=>this.shaderName,i=>{this.shaderName=i,this.updateMaterial()},void 0),this.field("layers",()=>this.layers,i=>{this.layers=Math.max(1,Math.floor(i)),this.updateGeometry(),this.updateMaterial()}),this.field("layerSpacing",()=>this.layerSpacing,i=>{this.layerSpacing=i,this.updateMaterial()}),this.field("timeOffset",()=>this.timeOffset,i=>{this.timeOffset=i,this.updateMaterial()})}updateGeometry(){const n=new yn({width:1,height:1,widthSegments:8,heightSegments:8});if(this.layers>1){const i=[];for(let r=0;r<this.layers;r++)i.push(r,r/(this.layers-1));n.setAttribute("layerIndex",new Float32Array(i),2,{instanceDivisor:1})}this.mesh.geometry=n}updateMaterial(){const n=this.shaders.get(this.shaderName);n&&(this.mesh.material=new X({phase:["deferred"],vert:n.vert,frag:n.frag,uniforms:A.merge(R.time,R.resolution,R.tex,{uLayers:{value:this.layers,type:"1i"},uLayerSpacing:{value:this.layerSpacing,type:"1f"},uTimeOffset:{value:this.timeOffset,type:"1f"}})}),Se(this.mesh.entity,this.mesh))}updateImpl(n){}}class Ky extends b{constructor(n){super(n);c(this,"count");c(this,"rangeX");c(this,"rangeY");c(this,"rangeZ");c(this,"randomSeed");c(this,"shaderType");c(this,"movementX");c(this,"movementY");c(this,"shapeEntities");c(this,"initialPositions");c(this,"timeOffsets");this.count=10,this.rangeX=10,this.rangeY=5,this.rangeZ=10,this.randomSeed=0,this.shaderType="random",this.movementX=0,this.movementY=0,this.shapeEntities=[],this.initialPositions=[],this.timeOffsets=[],this.field("count",()=>this.count,s=>{this.count=Math.max(1,Math.floor(s)),this.regenerateShapes()});const i=this.fieldDir("Position Range");i.field("rangeX",()=>this.rangeX,s=>{this.rangeX=s,this.regenerateShapes()}),i.field("rangeY",()=>this.rangeY,s=>{this.rangeY=s,this.regenerateShapes()}),i.field("rangeZ",()=>this.rangeZ,s=>{this.rangeZ=s,this.regenerateShapes()}),this.field("randomSeed",()=>this.randomSeed,s=>{this.randomSeed=s,this.regenerateShapes()}),this.field("shaderType",()=>this.shaderType,s=>{this.shaderType=s,this.regenerateShapes()},void 0);const r=this.fieldDir("Movement");r.field("movementX",()=>this.movementX,s=>{this.movementX=s}),r.field("movementY",()=>this.movementY,s=>{this.movementY=s}),this.regenerateShapes()}getRandomShaderType(n){const i=["circle","cross","border","dotGrid"],r=Math.floor(n()*i.length);return i[r]}regenerateShapes(){for(let i=0;i<this.shapeEntities.length;i++)this.entity.remove(this.shapeEntities[i]),this.shapeEntities[i].dispose();this.shapeEntities=[],this.initialPositions=[],this.timeOffsets=[];const n=ct.randomSeed(this.randomSeed);for(let i=0;i<this.count;i++){const r=new oe;r.name=`ShaderMotionGraphics_${i}`;const s=(n()-.5)*this.rangeX,o=(n()-.5)*this.rangeY,a=(n()-.5)*this.rangeZ;r.position.set(s,o,a),this.initialPositions.push(new M(s,o,a));const l=n()*10;this.timeOffsets.push(l);const u=r.addComponent(Sf),d=this.shaderType==="random"?this.getRandomShaderType(n):this.shaderType;u.setField("shaderName",d),u.setField("timeOffset",l),this.entity.add(r),this.shapeEntities.push(r)}}updateImpl(n){if(!(this.movementX===0&&this.movementY===0))for(let i=0;i<this.shapeEntities.length;i++){const r=this.shapeEntities[i],s=this.initialPositions[i],o=this.movementX*n.timeCode,a=this.movementY*n.timeCode;let l=s.x+o,u=s.y+a;this.rangeX>0&&(l=((l+this.rangeX/2)%this.rangeX+this.rangeX)%this.rangeX-this.rangeX/2),this.rangeY>0&&(u=((u+this.rangeY/2)%this.rangeY+this.rangeY)%this.rangeY-this.rangeY/2),r.position.set(l,u,s.z)}}disposeImpl(){for(let n=0;n<this.shapeEntities.length;n++)this.entity.remove(this.shapeEntities[n]),this.shapeEntities[n].dispose();this.shapeEntities=[]}}const Yy=`// @shader-file: src/resources/Components/Demo4/Common/SkyBox/shaders/skybox.fs
#include<common>
#include<packing>
#include<frag_h>
#include<noise_value>
#include<rotate>
uniform float uTime,uAspectRatio;uniform sampler2D uNoiseTex;uniform vec4 uState;void main(){
#include<frag_in>
vec3 v=normalize(-vNormal);outRoughness=1.;
#ifdef TSURI
vec3 u=mix(vec3(.4,.7,1),vec3(.8,.9,1),smoothstep(-.5,.5,v.y));vec4 s=texture(uNoiseTex,vUv*.3+uTime*.01);u+=vec3(.2)*smoothstep(.5,.7,s.x);outEmission=u*1.5;
#else
outColor*=1.;outEmission=vec3(2);outEmission*=uState.x;
#endif

#ifdef IS_FORWARD

#ifdef TSURI
outColor=vec4(outEmission,1);
#else
vec4 T=texture(uNoiseTex,vUv*.2);outColor=vec4(outEmission*smoothstep(.2,.5,T.x),1);
#endif

#endif
outEnv=0.;
#include<frag_out>
}`;class Qy extends b{constructor(n){super(n);c(this,"skyboxType");c(this,"material");this.skyboxType="default",this.material=new X({phase:["deferred","envMap"],frag:Yy,cullFace:!1,uniforms:A.merge(R.time,R.tex)}),this.field("skyboxType",()=>this.skyboxType,r=>{this.skyboxType=r;const s={};r==="tsuri"&&(s.TSURI=""),this.material.defines=s,this.material.requestUpdate()},void 0);const i=this._entity.addComponent(B,{geometry:new xt({radius:500,widthSegments:32,heightSegments:32}),material:this.material});Se(i.entity,i)}}const Zy=`// @shader-file: src/resources/Components/Demo4/Common/TableStage/shaders/tableStage.fs
#include<common>
#include<packing>
#include<frag_h>
#include<sdf>
#include<rm_h>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
uniform float uTimeE;uniform vec4 uState;vec2 v=vec2(0);const vec2 s=vec2(1,1.6),o=vec2(s/2.)+vec2(0,.3);float f(vec2 r,vec2 x){r-=o;v=(floor((r+x*.001)/s)+.5)*s;r=(-r+v)/x+abs(.5*s/x);return min(r.x,r.y);}SDFResult f(vec3 v){vec3 r=v+vec3(-.05,-.08,.38),s=r;s.yz*=rotate(HPI);vec2 o=vec2(sdCappedCylinder(s,.01,.05),0);s=r+vec3(0,0,-.05);s.yz*=rotate(HPI);o=opAdd(o,vec2(sdCappedCylinder(s,.013,.003),1));s=r+vec3(0,-.03,-.025);s.yz*=rotate(.6);o=opAdd(o,vec2(sdCappedCylinder(s,.01,.035),0));r+=vec3(0,-.059,-.06);r.yz*=rotate(HPI+.6);r+=vec3(0,.0054,-.01);o=opAdd(o,vec2(sdCappedCylinder(r,.009,.015),0));return SDFResult(o.x,v,4.,vec4(v,0));}SDFResult r(vec3 v){vec3 r=v;r.x+=cos(r.z*30.)*.01;r+=vec3(0,.008,0);r.x=mod(r.x+uTimeE*.2,.1)-.045;float s=sdBox(r,vec3(.045,.005,.06));return SDFResult(s,v,3.,vec4(v,0));}SDFResult x(vec3 v){vec3 s=v+vec3(0,.05,.5);vec2 o=vec2(sdBox(s,vec3(.5,.2,.1)),1);o.x=opSub(o.x,sdBox(s+vec3(0,-.2,-.015),vec3(.5,.01,.07)));o=opAdd(o,vec2(r(s+vec3(0,-.2,-.015)).d,3));vec3 x=s+vec3(0,-.45,0);o=opAdd(o,vec2(sdBox(x,vec3(.5,.013,.1)),1));x+=vec3(0,0,.1);o=opAdd(o,vec2(sdBox(x,vec3(.5,2,.03)),6));x.x=abs(x.x);x+=vec3(-.5,0,-.01);o=opAdd(o,vec2(sdBox(x,vec3(.03,2,.03)),1));return SDFResult(o.x,v,o.y,vec4(s,0));}SDFResult d(vec3 v){vec2 o=vec2(sdBox(v,vec3(.2,.02,.4)),1);o=opAdd(o,vec2(sdCappedCylinder(v+vec3(0,.25,0),.03,.25),5));return SDFResult(o.x,v,o.y,vec4(v,0));}SDFResult t(vec3 v){vec3 o=v;o.x=abs(o.x);o+=vec3(-.4,.2,0);vec2 r=vec2(sdBox(o,vec3(.2,.06,.4)),1);vec3 s=o+vec3(-.12,-.26,0);r=opAdd(r,vec2(sdBox(s,vec3(.08,.2,.4)),1));vec3 x=o-vec3(.02,.27,0);r=opAdd(r,vec2(sdBox(x,vec3(.007,.15,.372))-.02,5));x=o-vec3(-.08,.08,0);r=opAdd(r,vec2(sdBox(x,vec3(.1,.007,.372))-.02,5));r=opAdd(r,vec2(sdBox(s+vec3(0,.4,0),vec3(.25,.1,.35)),1));return SDFResult(r.x,v,r.y,vec4(v,0));}SDFResult m(vec3 v){vec3 r=v;r.x=abs(r.x);r+=vec3(0,.45,0);float s=sdBox(r,vec3(.5,.05,.4));return SDFResult(s,v,0.,vec4(v,0));}SDFResult n(vec3 v){vec3 r=v+vec3(0,-.8,.55);r.x=mod(r.x,.1125)-.05625;float s=sdBox(r,vec3(.045,.15,.005));return SDFResult(s,v,1.,vec4(v,0));}SDFResult D(vec3 r){r.z+=pow(r.x,2.)*.03;r.xy-=o;r.xy-=v;r.y+=.3;SDFResult s=d(r),z=s;s=t(r);if(s.d<z.d)z=s;s=m(r);if(s.d<z.d)z=s;s=x(r);if(s.d<z.d)z=s;s=f(r);if(s.d<z.d)z=s;s=n(r);if(s.d<z.d)z=s;return z;}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_screen>
SDFResult r;bool s=false;for(int o=0;o<128;o++){float v=f(rayPos.xy,rayDir.xy);r=D(rayPos);if(r.d<.001){s=true;break;}v=min(r.d,v);rayPos+=rayDir*v;}if(!s)discard;outNormal=N(rayPos,.001);
#include<rm_out_obj>
vec3 o=r.matparam.xyz;vec4 v=vec4(fbm(rayPos*2.),fbm(rayPos*8.),fbm(rayPos*32.),fbm(rayPos*64.));outEmission=vec3(0);outRoughness=.7;outMetalic=0.;if(r.mat==0.)outColor.xyz=vec3(.85,.85,.88),outRoughness=.4;else if(r.mat==1.){float s=fract(length(o*vec3(.5,1,1)+vec3(-.1,.4,.1))*45.+v.x*20.);vec3 r=vec3(.8,.55,.25);outColor.xyz=mix(r,r*.95,s);outNormal=normalize(outNormal+s*0.);outRoughness=.2+s*.1;}else if(r.mat==2.)outColor.xyz=vec3(.95),outRoughness=.3;else if(r.mat==3.)outColor.xyz=vec3(1,.95,.85),outRoughness=.8;else if(r.mat==4.)outColor.xyz=vec3(.8,.8,.82),outRoughness=.15,outMetalic=.85;else if(r.mat==5.){float s=fract(v.w*20.);outColor.xyz=vec3(.3)*v.x+s*.01;outRoughness=.3+s*.3;outNormal=normalize(outNormal+vec3(s)*.05);}else if(r.mat==6.){float s=fract(v.x*40.)*v.z;outColor.xyz=vec3(.95,.9,.8);outColor.xyz*=.95+s*.1;outRoughness=.1+s;}else if(r.mat==7.)outColor.xyz=vec3(.25,.35,.5)+v.z*.1,outRoughness=.8+v.w*.2,outNormal=normalize(outNormal+vec3(v.yz,0)*.1);float x=length(rayPos)*15.;vec3 z=vec3(0);z.x=sin(x-uTimeE*10.);z.y=sin(x-uTimeE*20.-.5);z.z=sin(x-uTimeE*30.-1.);z=smoothstep(.9,1.,z)*(10.*uState.y);outEmission=z;
#include<frag_out>
}`,As=`// @shader-file: src/resources/shaders/screen.vs
#include<common>
#include<vert_h>
void main(){
#include<vert_in>
gl_Position=vec4(position.xy,0,1);}`;class qy extends b{constructor(n){super(n);c(this,"mesh");this.mesh=this._entity.addComponent(B,{geometry:new yn({width:2,height:2}),material:new X({phase:["deferred","shadowMap"],vert:As,frag:Zy,uniforms:A.merge(R.time,R.resolution)})});const i=new oe;this._entity.add(i),Se(this.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}const Jy=`// @shader-file: src/resources/Components/Demo4/Common/TruchetSushiLane/shaders/truchetSushiLane.fs
#include<common>
#include<packing>
#include<frag_h>
#include<sdf>
#include<hash>
#include<rm_h>
#include<rotate>
uniform float uTime;uniform sampler2D uNoiseTex;float n(vec2 m,vec2 v,vec2 z){float x=length(z-v);vec2 r=(z-v)/x;r=abs(mat2(r.x,-r.y,r.y,r.x)*(m-(v+z)*.5))-vec2(x,.35)*.5;return length(max(r,0.))+min(max(r.x,r.y),0.);}vec2 m;float n(vec2 m){return sdRing(m,vec2(-1,0),.5,.35);}float n(vec3 m,vec2 v){return min(n(m.xz,vec2(0),v),length(m.xz)-.175);}float n(vec3 m,vec2 v,vec2 r){return dot(v,r)<0.?n(m.xz,v,r):n(m.xz-(v+r)*.5);}float n(vec3 v,vec2 x,vec2 r,vec2 z){vec2 f=x,y=r,s=z;if(dot(f,y)>-.5)y=z,s=r;if(dot(f,y)>-.5)f=r,y=z,s=x;float d=min(n(v.xz,f,y),length(v.xz-s*.5)-.175);f=mix(f,y,step(hash12(m),.5));return min(d,n(v.xz-(s+f)*.5));}float n(vec3 v,vec2 x,vec2 z,vec2 r,vec2 y){v.xz*=rotate(HPI*step(hash12(m),.5));float f=n(v.xz-.5);return min(f,n(v.xz+.5));}float n(vec2 v,vec2 z){m=(floor((v+z*.001)/5.)+.5)*5.;v=(-v+m)/z+abs(2.5/z);return min(v.x,v.y);}SDFResult D(vec3 v){vec3 r=v;float f=floor(r.y/10.);r.y=mod(r.y,10.)-5.;v.xz-=m;vec2[4] x,y=vec2[4](vec2(0,1),vec2(1,0),vec2(0,-1),vec2(-1,0));int s=0;for(int v=0;v<4;v++){vec2 r=round((m+y[v]*.5*5.)*2.)*.5+f;if(hash12(r)<.8)x[s++]=y[v];}f=5./3.;if(s==1)f=min(f,n(v/5.,x[0]));if(s==2)f=min(f,n(v/5.,x[0],x[1]));if(s==3)f=min(f,n(v/5.,x[0],x[1],x[2]));if(s==4)f=min(f,n(v/5.,x[0],x[1],x[2],x[3]));vec2 z=vec2(f,abs(r.y)-.1);return SDFResult(min(max(z.x,z.y),0.)+length(max(z,0.)),v,0.,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_screen>
SDFResult v;bool r=false;float f=0.;for(int s=0;s<128;s++){v=D(rayPos);if(v.d<.001){r=true;break;}if(rayPos.y<0.)break;float m=n(rayPos.xz,rayDir.xz);m=min(v.d,m);f+=m;rayPos+=rayDir*m;}if(!r)discard;outNormal=N(rayPos,.001);vec3 m=N(rayPos,.05);float s=length(outNormal-m);
#include<rm_out_obj>
outColor=vec4(vec3(.85),1);outEmission=vec3(s*5.*smoothstep(.3,.7,texture(uNoiseTex,rayPos.xz*.05+uTime*.05).y));outRoughness=texture(uNoiseTex,rayPos.xz*.05).x;outColor*=1.-outRoughness*.1;
#include<frag_out>
}`;class ex extends b{constructor(t){super(t),this._entity.addComponent(B,{geometry:new Je({width:2,height:2,depth:2}),material:new X({phase:["deferred","shadowMap"],vert:As,frag:Jy,uniforms:A.merge(R.time,R.resolution,R.tex)})})}}const tx=`// @shader-file: src/resources/Components/Demo4/Common/Tsuri/TsuriZao/shaders/basic.fs
#include<common>
#include<packing>
#include<frag_h>
void main(){
#include<frag_in>
outColor=vec4(vec3(.3,.2,0),1);
#include<frag_out>
}`,Cf=`// @shader-file: src/resources/shaders/basic.vs
#include<common>
#include<vert_h>
void main(){
#include<vert_in>

#include<vert_out>
}`;class Ef extends b{constructor(n){super(n);c(this,"mesh");const i=1.7,r=new _s({radiusTop:.018,radiusBottom:.018,height:i,radSegments:8,heightSegments:16});r.applyMatrix(new K().setFromTransform(new M(0,i*.5,0)));const s=new X({vert:Cf,frag:tx,uniforms:A.merge(R.resolution,R.time)});this.mesh=this.entity.addComponent(B,{geometry:r,material:s})}disposeImpl(){this._entity.removeComponent(B)}}const nx=`// @shader-file: src/resources/Components/Demo4/Common/UKPAshi/shaders/basic.fs
#include<common>
#include<packing>
#include<frag_h>
void main(){
#include<frag_in>
outColor=vec4(0,0,0,1);
#include<frag_out>
}`;class Tf extends b{constructor(n){super(n);c(this,"cylinderMesh");c(this,"sphereBottomEntity");const i=new X({vert:Cf,frag:nx,uniforms:A.merge(R.resolution,R.time)}),r=1.1,s=new _s({height:r,radiusTop:.1,radiusBottom:.1,radSegments:16});s.applyMatrix(new K().setFromTransform(new M(0,-r/2,0))),this.cylinderMesh=this.entity.addComponent(B,{geometry:s,material:i}),this.sphereBottomEntity=new oe,this.sphereBottomEntity.position.set(0,-r,0),this.sphereBottomEntity.addComponent(B,{geometry:new xt({radius:.2}),material:i}),this.entity.add(this.sphereBottomEntity)}disposeImpl(){this._entity.removeComponent(B),this.entity.remove(this.sphereBottomEntity)}}const ix=`// @shader-file: src/resources/Components/Demo4/Common/Ukonpower/shaders/ukonpower.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
SDFResult D(vec3 v){vec3 s=v;float o=.4+noiseValue(s*5.)*.01;o+=fbm(s*20.)*.01;vec2 t=vec2(sdSphere(s,o),0);vec3 z=vec3(.05,.2,-.33);o=sdSphere(s-z*vec3(1),.01)-.02;float i=sdSphere(s-z*vec3(-1,1,1),.01)-.02;vec2 r=vec2(min(o,i),2);t=t.x<r.x?t:r;return SDFResult(t.x,v,t.y,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,32,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
outRoughness=1.;outMetalic=0.;if(dist.mat==0.)outColor.xyz=mix(vec3(.8,.6,.4),vec3(.3,.15,.05),smoothstep(.3,.7,fbm(dist.pos*3.))),outRoughness=.3;else if(dist.mat==1.)outColor.xyz=vec3(.15,.03,0),outRoughness=.1;else if(dist.mat==2.)outColor.xyz=vec3(.02),outRoughness=.2;float s=(1.-dot(outNormal.xyz,-rayDir))*.8;outEmission+=s*.3;
#include<frag_out>
}`;class rx extends b{constructor(n){super(n);c(this,"mesh");c(this,"ashiEntities",[]);c(this,"legInitialRotX",[]);c(this,"tsuriZaoEntity",null);const i=new xt({radius:.5}),r=new X({frag:ix,uniforms:A.merge(R.resolution,R.time)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r});const s=[{pos:[-.31,0,-.2],rot:[Math.PI/2,0,.5]},{pos:[.31,0,-.2],rot:[Math.PI/2,0,-.5]},{pos:[-.2,-.3,-.1],rot:[Math.PI/2*.9,0,0]},{pos:[.2,-.3,-.1],rot:[Math.PI/2*.9,0,0]}];for(let o=0;o<s.length;o++){const a=s[o],l=new oe;l.position.set(a.pos[0],a.pos[1],a.pos[2]),l.quaternion.setFromEuler(new En(a.rot[0],a.rot[1],a.rot[2])),l.scale.set(.3,.3,.3),l.addComponent(Tf),this.entity.add(l),this.ashiEntities.push(l),o>=2&&this.legInitialRotX.push(a.rot[0])}this.tsuriZaoEntity=new oe,this.tsuriZaoEntity.position.set(0,0,-.45),this.tsuriZaoEntity.quaternion.setFromEuler(new En(-Math.PI/4,0,0)),this.tsuriZaoEntity.addComponent(Ef),this.entity.add(this.tsuriZaoEntity)}updateImpl(n){const i=n.timeCode,r=this.ashiEntities[2],s=this.legInitialRotX[0]+Math.sin(i*3)*.3;r.quaternion.setFromEuler(new En(s,0,0));const o=this.ashiEntities[3],a=this.legInitialRotX[1]+Math.sin(i*3+Math.PI)*.3;o.quaternion.setFromEuler(new En(a,0,0))}disposeImpl(){this._entity.removeComponent(B);for(const n of this.ashiEntities)n.dispose();this.ashiEntities=[],this.tsuriZaoEntity&&(this.tsuriZaoEntity.dispose(),this.tsuriZaoEntity=null)}}const sx=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraFluids/shaders/ikuraFluids.fs
#include<common>
#include<packing>
#include<frag_h>
#include<light>
#include<pmrem>
uniform sampler2D uEnvMap;in vec4 vGPUVel,vGPUPos,vId;void main(){
#include<frag_in>
outColor.xyz=vec3(0);outRoughness=.2;outMetalic=.2;
#ifdef IS_FORWARD
vec3 r=normalize(vViewNormal);
#include<lighting_forwardIn>
vec2 v=gl_FragCoord.xy/uResolution;float u=dot(geo.normal,geo.viewDir),t=fresnel(u);for(int e=0;e<3;e++){vec2 s=-r.xy*(float(e+1)/4.*.015+.05);outColor.x+=texture(uDeferredTexture,v+s).x;outColor.y+=texture(uDeferredTexture,v+s*1.3).y;outColor.z+=texture(uDeferredTexture,v+s*1.6).z;}outColor.xyz/=3.;outColor.xyz=(outColor.xyz+vec3(.7,.3,0))*vec3(.7,.1,0);outColor.w=1.;outColor.xyz+=t*vec3(1,.5,0);
#include<lighting_light>
outColor.xyz*=1.+smoothstep(.02,.2,t)+smoothstep(.85,1.,vGPUVel.w)*55.;
#include<lighting_env>

#endif

#include<frag_out>
}`,ox=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraFluids/shaders/ikuraFluids.vs
#include<common>
#include<vert_h>
#include<rotate>
layout(location=3)in vec2 cuv;layout(location=4)in vec4 id;uniform sampler2D uGPUSampler0,uGPUSampler1;uniform vec4 uState;out vec4 vGPUVel,vGPUPos,vId;void main(){
#include<vert_in>
vGPUVel=texture(uGPUSampler1,cuv);vec4 v=texture(uGPUSampler0,cuv);outPos*=.06*(.7+id.z*.3)*uState.y;outPos*=smoothstep(0.,.5,sin(vGPUVel.w*PI));outPos*=.8+v.w*.4;float s=length(vGPUVel.xyz);vec3 u=normalize(vGPUVel.xyz+vec3(.001));outPos+=u*dot(outPos,u)*s*.2;outPos+=v.xyz;vGPUPos=v;vId=id;vec4 l=uProjectionMatrix*uViewMatrix*uModelMatrix*vec4(vGPUVel.xyz,0);
#include<vert_out>
vVelocity+=l.xy*.001;}`,ax=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraFluids/shaders/ikuraFluidsCompute.fs
#include<common>
#include<noise_cyclic>
#include<rotate>
layout(location=0)out vec4 outColor0;layout(location=1)out vec4 outColor1;uniform sampler2D uGPUSampler0,uGPUSampler1;uniform float uTimeE,uDeltaTime;uniform vec4 uState;in vec2 vUv;
#include<random>
void main(){vec4 v=texture(uGPUSampler0,vUv),u=texture(uGPUSampler1,vUv);float z=u.w+uDeltaTime/(5.+vUv.y);if(z>1.||uState.x<.5){float l=random(vUv+uTimeE)*2.,E=random(vUv*2.+uTimeE)*6.28318,n=random(vUv*3.+uTimeE)*3.14159;if(vUv.x<.05)v.xyz=vec3(l*sin(n)*cos(E),l*sin(n)*sin(E),l*cos(n));else v.xyz=vec3(l*sin(n)*cos(E),l*sin(n)*sin(E),l*cos(n))*.03+vec3(.7,.5,-.5);u.xyz=vec3(0);z=0.;if(uState.x<.5)z=random(vUv+uTimeE+10.);}u.xyz*=.998;vec3 l=noiseCyc(v.xyz*5.+vec3(0,0,uTimeE*.5+z+vUv.x*0.));u.xyz+=l*.01;float n=atan2(v.z,v.x)-1.;u.xz=mix(u.xz,vec2(sin(n),-cos(n)),.01);u.xyz+=normalize(-v.xyz)*length(v.xyz)*.005*vec3(1.4,.4,1);v.xyz+=u.xyz*uDeltaTime;u.w=z;outColor0=v;outColor1=u;}`;class lx extends b{constructor(n){super(n);c(this,"gpu");c(this,"mesh");const i=new M(64,64);this.gpu=new vm({passes:[new _m(O,{name:"ikuraFluids",size:i,dataLayerCount:2,frag:ax,uniforms:A.merge(R.time)})]}),Se(this.entity,this.gpu.passes[0]),this.gpu.passes[0].initTexture(a=>{if(a===0){const l=Math.random()*2,u=Math.random()*Math.PI*2,d=Math.random()*Math.PI;return[l*Math.sin(d)*Math.cos(u),l*Math.sin(d)*Math.sin(u),l*Math.cos(d),1]}else return[0,0,0,Math.random()*5]});const r=new xt({radius:.5,widthSegments:16,heightSegments:12}),s=[],o=[];for(let a=0;a<i.x;a++)for(let l=0;l<i.y;l++)s.push(a/i.x,l/i.y),o.push(Math.random(),Math.random(),Math.random(),Math.random());r.setAttribute("cuv",new Float32Array(s),2,{instanceDivisor:1}),r.setAttribute("id",new Float32Array(o),4,{instanceDivisor:1}),this.mesh=this.entity.addComponent(B,{geometry:r,material:new X({name:"ikuraFluids",phase:["shadowMap","forward"],vert:ox,frag:sx,uniforms:A.merge(R.time,this.gpu.passes[0].outputUniforms)})}),Se(this.entity,this.mesh)}updateImpl(n){this.gpu.compute(n.renderer)}disposeImpl(){this.entity.removeComponent(B),this.gpu.dispose()}}const ux=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraGunKan/GunkanShari/shaders/gunkanShari.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<rm_h>
#include<sdf>
#include<noise_cyclic>
#include<rotate>
uniform sampler2D uNoiseTex;uniform float uTime;uniform vec4 uState;SDFResult f(vec3 s){vec3 v=s;v.z*=.7;vec4 r=texture(uNoiseTex,v.xz*.5+.5);v.y-=r.y*.05-.1;float d=sdCappedCylinder(v,.25,.08);return SDFResult(d,s,0.,vec4(.95,.93,.88,1));}SDFResult r(vec3 s){vec3 v=s-vec3(0);v.z*=.7;vec3 r=noiseCyc(s*30.);float o=r.x*.003,d=sdCappedCylinder(v,o+.26,.15);o=sdCappedCylinder(v,o+.255,.16);return SDFResult(max(d,-o),s,1.,vec4(.05,.08,.05,1));}SDFResult s(vec3 v){float s=uState.x;v+=vec3(0,-.14,.2);v.y+=-uState.x*.4;v.xz*=rotate(s*.5);v.yz*=rotate(.3+s);v.xy*=rotate(.3+s);v.y-=sin(v.z*4.+HPI)*.05-.04;v.z*=.8;vec3 r=noiseCyc(v*40.);s=sdCappedCylinder(v,r.x*.002+.2,.015);r=mix(mix(vec3(.4,.7,.3),vec3(.05,.08,.05),smoothstep(0.,.3,length(v.xz))),vec3(.05,.08,.05),smoothstep(.19,.205,length(v.xz)));return SDFResult(s,v,2.,vec4(r,1));}SDFResult D(vec3 v){SDFResult o=f(v),t=o;o=r(v);if(o.d<t.d)t=o;o=s(v);if(o.d<t.d)t=o;return t;}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,64,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
outColor.xyz=dist.matparam.xyz;outEmission=vec3(0);outRoughness=.8;outMetalic=0.;if(dist.mat==0.)outRoughness=.8;else if(dist.mat==1.){float s=noiseCyc(rayPos*20.).x*.05;outColor.xyz+=s;outRoughness=.9;}else if(dist.mat==2.){float s=noiseCyc(dist.pos*25.).x*.08;outColor.xyz+=s;outRoughness=.7;}outColor.xyz*=smoothstep(2.,.5,length(rayPos));
#include<frag_out>
}`;class cx extends b{constructor(n){super(n);c(this,"mesh");const i=new Je({width:1,depth:1.3,height:.8,segmentsDepth:4,segmentsHeight:4,segmentsWidth:4});i.applyMatrix(new K().setFromTransform(new M(0,.2,0)));const r=new X({frag:ux,uniforms:A.merge(R.resolution,R.time,R.tex)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r}),Se(this.mesh.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}const dx=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraGunKan/Ikura/shaders/ikura.fs
#include<common>
#include<packing>
#include<frag_h>
#include<light>
#include<pmrem>
uniform sampler2D uEnvMap;in vec4 vId;void main(){
#include<frag_in>
outColor.xyz=vec3(0);outRoughness=.15;outMetalic=0.;
#ifdef IS_FORWARD
vec3 r=normalize(vViewNormal);
#include<lighting_forwardIn>
vec2 z=gl_FragCoord.xy/uResolution;float u=dot(geo.normal,geo.viewDir),t=fresnel(u);for(int e=0;e<16;e++){vec2 u=-r.xy*(float(e+1)/4.*.015+.05);outColor.x+=texture(uDeferredTexture,z+u).x;outColor.y+=texture(uDeferredTexture,z+u*1.3).y;outColor.z+=texture(uDeferredTexture,z+u*1.6).z;}outColor.xyz/=16.;outColor.xyz*=vec3(.7,.1,0);outColor.w=1.;outColor.xyz+=t*1.5;
#include<lighting_light>

#include<lighting_env>

#endif

#include<frag_out>
}`,fx=`// @shader-file: src/resources/Components/Demo4/Ikura/IkuraGunKan/Ikura/shaders/ikura.vs
#include<common>
#include<vert_h>
#include<rotate>
layout(location=4)in vec4 id;uniform float uTime;uniform vec4 uState;out vec4 vId;void main(){
#include<vert_in>
vec3 v=id.yzw,d=(vec4(vec3(0,pow(v.y,2.)*uState.x,0),1)*uModelMatrix).xyz;v=(v+d*.3*id.x)*.1;outPos*=.06;outPos+=v;
#include<vert_out>
vId=id;}`;class hx extends b{constructor(n){super(n);c(this,"mesh");const i=150,r=new xt({radius:1,widthSegments:16,heightSegments:12}),s=ct.randomSeed(1),o=[];for(let a=0;a<i;a++){const l=ct.randomInSphere(2,s);l.z*=1.5,l.y=Math.abs(l.y)*1.5,o.push(a/i,l.x,l.y,l.z)}r.setAttribute("id",new Float32Array(o),4,{instanceDivisor:1}),this.mesh=this._entity.addComponent(B,{geometry:r,material:new X({phase:["forward","shadowMap"],vert:fx,frag:dx,uniforms:A.merge(R.time,R.resolution)})}),Se(this.mesh.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}class gs extends b{constructor(n){super(n);c(this,"shariEntity");c(this,"ikuraEntity");this.shariEntity=new oe;const i=this.shariEntity.addComponent(cx);this._entity.add(this.shariEntity),Se(this.entity,i.entity.getComponent(B)),this.ikuraEntity=new oe;const r=this.ikuraEntity.addComponent(hx);this._entity.add(this.ikuraEntity),Se(this.entity,r.entity.getComponent(B))}dispose(){this.shariEntity.dispose(),this.ikuraEntity.dispose(),super.dispose()}}const mx=`// @shader-file: src/resources/Components/Demo4/Ikura/Kyuuri/shaders/kyuuri.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform float uTime;SDFResult D(vec3 r){vec3 o=r;o.y+=.4;float s=.09;s*=mix(1.,.7,linearstep(-.4,.4,r.y));float f=sin(atan2(r.x,r.z)*PI*3.)*.5+.5;s*=mix(1.,.9,f*smoothstep(.4,0.,abs(r.y)));o.x+=cos(r.y*2.)*.04;f=sdVerticalCapsule(o,.8,s);s=noiseCyc(o*15.+uTime*.1).x*.005;return SDFResult(f-s,r,0.,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,128,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec3 r=noiseCyc(rayPos*10.);float s=noiseValue(rayPos*5.);outRoughness=.4+r.y;outNormal=normalize(outNormal+r.xyz*.4);outMetalic=.1;outColor.xyz=vec3(.01,.3,.01)*mix(1.,0.,s)*mix(1.,.5,r.y);outColor.xyz*=smoothstep(1.5,.4,length(rayPos));
#include<frag_out>
}`;class px extends b{constructor(n){super(n);c(this,"mesh");const i=new xt({radius:.5}),r=new X({frag:mx,uniforms:A.merge(R.resolution,R.time)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r}),Se(this.mesh.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}const vx=`// @shader-file: src/resources/Components/Demo4/Maguro/Maguro/shaders/maguro.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<random>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform mat4 uModelViewMatrix;uniform float uTimeE;uniform sampler2D uNoiseTex;uniform vec4 uState;uniform float uParty;float s(vec3 s){vec3 o=s*.8;o.xz*=rotate(mix(sin(-s.x-.3+uTimeE)*.5*smoothstep(-1.,1.,s.x),sin(-s.x-.3+uTimeE*9.)*.9,uParty));s=o;s.z*=1.2;float v=sdVesicaSegment(s,vec3(-.5,0,0),vec3(.5,0,0),.2*cos(s.x+.5));s=o+vec3(.5,-.05,0);v=opSmoothSub(sdTriPrism(s,vec2(.14,.2)),v,0.);s=o+vec3(-.1,.09,0);s.x+=s.y*.3;s.xy*=rotate(PI);v=opSmoothAdd(sdTriPrism(s,vec2(.14,.01))-.002,v,.04);s=o+vec3(-.1,-.2,0);s.x*=1.2;s.x-=pow(s.y,2.)*2.;v=opSmoothAdd(sdTriPrism(s,vec2(.1,.001))-.002,v,.04);s=o;s.z=abs(s.z);s+=vec3(0,.01,-.14);s.y+=pow(s.x,2.);s.x+=.03;s.xz*=rotate(.5+sin(uTimeE*3.-s.x*5.)*.2);s.x-=.03;s.xy*=rotate(-1.7);s.y*=.5;v=opSmoothAdd(sdTriPrism(s,vec2(.05,.001))-.002,v,.01);s=o;s.y=abs(s.y);s.x-=pow(s.y,2.)*1.3;s+=vec3(-.5,-.05,0);s.y*=.24;v=opSmoothAdd(sdTriPrism(s,vec2(.03,.01))-.002,v,.04);s=o;s.y=abs(s.y);float z=cos(s.x*PI);s.y-=z*.17;s.x=mod(s.x,.05)-.025;z=smoothstep(.15,.1,abs(o.x-.3));return opSmoothAdd(sdTriPrism(s,vec2(.015*z,.005*z)),v,.01);}float e(vec3 s){s.x-=.03;s.y-=.06;s.x*=1.2;s.z*=1.5;s.x+=texture(uNoiseTex,(s.xz+s.x)*.4).x*.05;s.z+=fract(length((s.xy+vec2(-.02,0))*vec2(1,1.2)*(1.+length(s.xy)*1.5))*40.)*.002;vec3 v=s;v.yz*=rotate(HPI);v.z+=.89;float o=sdCappedCylinder(v,1.,.2);v=s;v.y+=.14;v.xy*=rotate(.5);o=opAnd(o,sdBox(v,vec3(.1))-.05);o-=.01;v=s;v.z=abs(v.z);v.z-=.23;return opSub(o,sdBox(v,vec3(1,1,.1)));}SDFResult D(vec3 v){float o=s(v);o=opSmoothSub(sdBox(v+vec3(1.8-uState.x*2.1,0,0),vec3(1,.5,.5)),o,0.);float f=e(v*mix(1.,.4,uState.y));f=opSmoothSub(sdBox(v+vec3(-1.8+uState.z*2.1,0,0),vec3(1,.5,.5)),f,0.);float z=opSmoothAdd(o,f,.1);f=o<f?0.:1.;return SDFResult(z,v,f,vec4(0));}
#include<subsurface>
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>
SDFResult s;bool v=false;for(int o=0;o<128;o++){if(uParty>.5&&o>32)break;s=D(rayPos);rayPos+=s.d*rayDir*.7;if(s.d<.001){v=true;break;}}if(!v)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec2 z=rayPos.xy*.5+.5;vec4 o=texture(uNoiseTex,z),r=texture(uNoiseTex,z+o.xy);if(s.mat<.5){outRoughness=smoothstep(.2,1.,o.x);outNormal=normalize(outNormal+r.xyz*.3);vec3 s=vec3(1);float v=smoothstep(.01,.08,rayPos.y-cos(rayPos.x*PI+.15)*.06-texture(uNoiseTex,z*4.).x*.05+.04);s.xyz=mix(s,vec3(0),v);outColor.xyz=s;outMetalic=.2;}else{float z=subsurface(rayPos,normalize((vec4(0,1,0,0)*uModelViewMatrix).xyz),.3);outRoughness=.5;outNormal=normalize(outNormal+r.xyz*.1);float v=smoothstep(.35,.1,length(rayPos.xy+vec2(-.08,-.11))),s=length(rayPos.xy+vec2(-.02,-1.27)),o=smoothstep(1.398,1.415,s);outColor.xyz=mix(vec3(1,.1,.1),vec3(.6,0,0),v);outEmission.xyz+=vec3(.9,.1,.2)*z*1.7*(1.-o);outMetalic=0.;outRoughness=.2;outColor.xyz=mix(outColor.xyz,vec3(1,.7,.7),o);outColor.xyz=mix(outColor.xyz,vec3(0),smoothstep(1.41,1.43,s));}
#include<frag_out>
}`;class gx extends b{constructor(t){super(t);const n=new Je({width:1.5,height:.8,depth:1}),i=new X({frag:vx,uniforms:A.merge(R.resolution,R.time,R.tex)}),r=this.entity.addComponent(B,{geometry:n,material:i});Se(r.entity,r)}}const yx=`// @shader-file: src/resources/Components/Demo4/Music/shaders/music.fs
void main(){}`,xx=`// @shader-file: src/resources/Components/Demo4/Music/shaders/music.vs
#include<common>
#include<noise_value>
in float aTime;out float o_left,o_right;uniform float uDuration,uSampleRate,uTimeOffset,uBPM;float f(float f){return fract(sin(dot(vec2(f),vec2(12.9898,78.233)))*43758.5453);}float t(float f){return fract(-f)*2.-1.;}vec2 t(vec2 f){return vec2(t(f.x),t(f.y));}float p(float f){return sin(f*TPI);}vec2 p(vec2 f){return vec2(p(f.x),p(f.y));}float r(float f){return 440.*pow(1.06,f);}bool f(float f,float s,float v){return s<=f&&f<v;}vec4 f(float f,float s){float m=mod(f,s);return vec4(m,floor(f/s),m/s,f/s);}const float v[]=float[](10.,6.,8.,3.,10.,6.,8.,3.);float s=1.;float p(float f,float m,float s){float i=0.;f=fract(f);i+=(fbm(m*32e2)-.5)*exp(-250.*f*s);return i+(fbm(m*48e2)-.5)*exp(-3e2*f*s)*.5;}vec2 p(float m,float s){return vec2(0)+p(f(m,2.).z-.5,fract(s),.25);}vec2 r(float m,float s){vec2 y=vec2(0);vec4 v=f(m,2.);for(int i=0;i<16;i++){float m=v.z-float(i)/16.,x=f(v.y*2e2+float(i));bool t=i==8;if(t||x>.5)y+=p(m,fract(s),t?1.:1.5)*(t?1.2:.5+x*.5);}return y*.9;}float n(float f){f=fract(f);return noiseValue(vec3(f*22e3))*max(0.,1.-min(.85,f*4.25)-(f-.25)*.3);}vec2 d(float m){vec2 i=vec2(0);vec4 s=f(m*16.,4.);i+=n(s.z)*(step(.4,f(s.y))*.5+.5);i+=n(s.z-.5)*step(.5,f(s.y*10.+.1));return i*.02;}float d(float f,float s){f=fract(f);return sin((s-.05*exp(-1e2*f))*r(5.))*exp(-20.*f)*smoothstep(0.,5e-4,f)*.3;}float n(float f,float s){f=fract(f);return sin((s-.06*exp(-1e2*f))*r(2.))*exp(-50.*f)*smoothstep(0.,5e-4,f)*.3;}float t(float f,float i){f=fract(f);i-=.08*exp(-1e2*f);return(sin(i*r(5.))*exp(-30.*f)+sin(i*r(8.))*exp(-45.*f)*.5+sin(i*r(12.))*exp(-60.*f)*.25)*smoothstep(0.,.008,f)*.25;}vec2 i(float m,float s){vec2 i=vec2(0);vec4 v=f(m,4.),t=f(m,8.);for(int f=0;f<3;f++){float m=v.z-float(f)/(16./3.);if(f!=2||t.z>.5)i+=d(m,s);}return i*1.15;}vec2 x(float m,float s){vec2 i=vec2(0);vec4 v=f(m,4.),t=f(m,8.);for(int f=0;f<6;f++){float m=v.z-float(f)/(16./3.);if(f!=2||t.z>.5)i+=n(m,s);}return i*1.15;}vec2 m(float m,float s){vec2 i=vec2(0);vec4 v=f(m,2.);for(int m=0;m<16;m++){float y=v.z-float(m)/16.,x=f(v.y*1e2+float(m));bool p=m%4==0;if(p||x>.35)i+=t(y,s)*(p?1.:.6+x*.4);}return i*.85;}float d(float m,float f,vec4 s){return m-(f*16.+max(0.,s.y-f*2.)*8.)*(60./uBPM);}vec2 d(float m,float i,float y){vec2 x=vec2(0);int t[]=int[](0,4,7,12,7,4);float e=v[int(mod(f(m,32.).x/4.*s,8.))];y+=e+float(t[int(mod(floor(m*4.),6.))]);m=fract(m*4.);e=exp(-m*8.)*smoothstep(0.,.005,m);for(int f=0;f<2;f++){float s=float(f)*.003;x+=p(i*r(y)*(1.+s)+vec2(float(f)*.3,0))*e;}return x*.08;}vec2 e(float m,float i){vec2 y=vec2(0);int t[]=int[](0,4,7,12),x=int(mod(floor(m*8.),4.));float e=v[int(mod(f(m,32.).x/4.*s,8.))];m=fract(m*8.);y+=p(i*r(e+float(t[x])))*(exp(-m*12.)*smoothstep(0.,.003,m));e=float(x)/4.;y.x*=1.+e*.3;y.y*=1.-e*.3;return y*.06;}vec2 a(float m,float i){vec2 y=vec2(0);vec4 t=f(m,32.);int x=int(mod(t.x/4.*s,8.));float e=v[x],o=fract(t.z/4.);o=smoothstep(0.,.01,o)*smoothstep(1.,.7,o);int u[3];if(x==0||x==4)u[0]=0,u[1]=3,u[2]=7,u[0]=0,u[1]=4,u[2]=7;else u[0]=0,u[1]=4,u[2]=7;for(int f=0;f<3;f++){float m=e+float(u[f])-12.;for(int f=0;f<3;f++){float s=(float(f)-1.)*.004,x=float(f)*.2;y+=p(i*r(m)*(1.+s)+x)*o;}}e=p(m*.1)*.5;y.x*=1.+e;y.y*=1.-e;return y*.03;}vec2 o(float m,float s){vec2 i=vec2(0);float x=fract(m*4.),e=exp(-x*30.)*smoothstep(0.,.001,x);int y=int(mod(floor(m*4.),8.)),u[8]=int[](0,4,7,4,0,-3,0,4),o=int(f(m,32.).x/4.)%8;x=v[o]+float(u[y])+(x<.08?7.*(x/.08):7.*exp((-x+.08)*20.));int a[3];if(o==0||o==4)a[0]=0,a[1]=3,a[2]=7;else a[0]=0,a[1]=4,a[2]=7;for(int f=0;f<3;f++){float m=x+float(a[f]);for(int v=0;v<2;v++){float y=float(v)*.004,x=float(v)*.1;x=p(s*r(m)*(1.+y)+x);y=t(s*r(m)*(1.+y));i+=vec2(clamp(mix(x,y,.4)*1.5,-.7,.7))*e/float(f+1);}}i*=.8+(sin(s*3.)*.5+.5)*.2;x=float(y)/4.-1.;i.x*=1.+x*.6;i.y*=1.-x*.6;return i*.08;}vec2 u(float m,float i){vec2 y=vec2(0);float x=v[int(mod(f(m,32.).x/4.*s,8.))],t=x-36.,e=fract(m*.25);x=exp(-e*3.)*smoothstep(0.,.01,e);for(int f=0;f<4;f++){float m=float(f+1),v=p(i*r(t));y+=v*x/m;}x=sin(m*8.);y.x*=1.+x*.3;y.y*=1.-x*.3;return y*.05;}vec2 w(float m,float i){vec2 y=vec2(0);float x=v[int(mod(f(m,32.).x/4.*s,8.))],e=fract(m*4.);e=exp(-e*2.)*smoothstep(0.,.003,e);int t=int(mod(floor(m*4.),4.)),u[4]=int[](0,0,0,7);x=x+float(u[t])-36.;for(int f=0;f<4;f++){float m=float(f+1),s=p(i*r(x-12.)*m);y+=vec2(mix(s,abs(2.*fract(i*r(x)*m*.5-.25)-1.)*2.-1.,.5))*e/(m*.8);}x=float(t)/4.-.5;y.x*=1.+x*.3;y.y*=1.-x*.3;return y*.2;}vec2 B(float m,float i){vec2 y=vec2(0);vec4 x=f(m,2.);int u[8]=int[](0,4,7,4,0,-5,0,4);m=v[int(mod(f(m,32.).x/4.*s,8.))];int e=int(mod(x.w*8.,8.));m=m+float(u[e])+12.;float o=fract(x.w*8.);o=exp(-o*16.)*smoothstep(0.,.002,o);for(int f=0;f<3;f++){float x=(float(f)-1.)*.003,s=1.+float(f)*.5,v=float(f)*.1;v=p(i*r(m)*(1.+x)+v);x=t(i*r(m)*(1.+x));y+=vec2(mix(v,x*.5,.3)*o/s);}y*=1.+sin(i*5.)*.002;o=float(e)/4.;y.x*=1.+o*.4;y.y*=1.-o*.4;return y*.12;}vec2 B(){float y=aTime/uSampleRate+uTimeOffset,v=max(0.,y*(uBPM/60.)-4.);vec2 t=vec2(0);vec4 b=f(v,4.),I=f(v,8.),c=f(v,16.);if(f(c.y,0.,1.))y=d(y,0.,I),t+=d(v,y,0.),t+=a(v,y)*.3;if(f(c.y,1.,2.))y=d(y,1.,I),t+=d(v,y,0.),t+=d(v,y,12.)*.5,t+=i(v,y),t+=a(v,y)*.6;if(f(b.y,8.,9.)){y=d(y-16.,0.,I);vec2 f=vec2(0);f+=d(v,y,-12.);float m=step(I.x,2.);f*=m;t+=p(v,y)*.8*(1.-m);t+=f;}v-=36.;b=f(v,4.);I=f(v,8.);c=f(v,16.);if(f(c.y,0.,4.)){y=d(y,0.,I);vec2 f=vec2(0)+x(v,y)*1.2;f+=p(v,y)*.8;f+=a(v,y)*.6;f+=u(v,y);f+=d(v,y,0.);if(c.y>=1.)f+=d(v,y,12.)*.5;if(c.y>=2.)f+=a(v,y)*.4;t+=f*smoothstep(4.,3.98,c.w);}v-=65.;b=f(v,4.);I=f(v,8.);c=f(v,16.);if(f(c.y,0.,1.))y=d(y,6.,I),t+=a(v,y)*.6;if(f(c.y,1.,3.)){vec2 f=vec2(0);y=d(y,6.,I);f+=d(v,y,-12.)*.8;f+=e(v,y)*1.2;f+=d(v,y,12.)*.6;f+=p(v,y)*.5;f+=d(v)*.8;f+=a(v,y)*.6;t+=f*smoothstep(2.75,2.74,c.w);}v-=48.;b=f(v,4.);I=f(v,8.);c=f(v,16.);if(f(c.y,0.,3.)){s=1.;y=d(y,0.,I);vec2 f=vec2(0)+m(v,y);f+=r(v,y);f+=d(v);f+=u(v,y);f+=e(v,y)*1.2;f+=d(v,y,12.)*.6;f+=e(v,y)*1.2;f+=w(v,y);f+=o(v,y)*.5;f+=B(v,y);t+=f;}if(f(c.y,3.,5.)){s=1.;y=d(y,0.,I);vec2 f=vec2(0);f+=u(v,y);t+=e(v,y)*1.2;f+=a(v,y)*.4;f+=B(v,y)*.4;t+=f;}return t;}void main(){vec2 f=B();o_left=f.x;o_right=f.y;}`,zf=100,Pr=60*(8*33/zf);class Pf extends b{constructor(n){super(n);c(this,"power");c(this,"gl");c(this,"isAudioBufferReady");c(this,"audioContext");c(this,"audioBuffer");c(this,"implusBuffer");c(this,"audioSrcNode");c(this,"convolverNode");c(this,"gainNode");c(this,"analyser");c(this,"frequencyData");c(this,"frequencyTexture");c(this,"bufferLength");c(this,"blockLength");c(this,"numSampleBlocks");c(this,"bufferIn");c(this,"bufferL");c(this,"bufferR");c(this,"tmpOutputArrayL");c(this,"tmpOutputArrayR");c(this,"progress");c(this,"timeCode");c(this,"playStartTime");c(this,"forcePlay");c(this,"currentRender");this.power=W0,this.gl=this.power.gl,this.audioSrcNode=null,this.isAudioBufferReady=!1,this.timeCode=0,this.playStartTime=-1,this.forcePlay=!1,this.audioContext=new AudioContext,this.bufferLength=Math.floor(this.audioContext.sampleRate*Pr),this.progress=[0,0];let i=1024;this.blockLength=Math.min(i,this.bufferLength),this.numSampleBlocks=Math.ceil(this.audioContext.sampleRate*Pr/this.blockLength),this.tmpOutputArrayL=new Float32Array(this.blockLength),this.tmpOutputArrayR=new Float32Array(this.blockLength),this.audioBuffer=this.audioContext.createBuffer(2,this.bufferLength,this.audioContext.sampleRate),this.bufferIn=new Dr(this.gl),this.bufferIn.setData(new Float32Array(new Array(this.blockLength).fill(0).map((o,a)=>a)),"vbo"),this.bufferL=new Dr(this.gl),this.bufferL.setData(new Float32Array(this.bufferLength),"vbo",this.gl.DYNAMIC_COPY),this.bufferR=new Dr(this.gl),this.bufferR.setData(new Float32Array(this.bufferLength),"vbo",this.gl.DYNAMIC_COPY),this.currentRender=this.render(),this.implusBuffer=this.audioContext.createBuffer(2,this.audioContext.sampleRate*1.5,this.audioContext.sampleRate);for(let o=0;o<this.implusBuffer.length;o++){const a=o/this.implusBuffer.length;this.implusBuffer.getChannelData(0)[o]=(Math.random()*2-1)*.9*Math.exp(-a*7),this.implusBuffer.getChannelData(1)[o]=(Math.random()*2-1)*.9*Math.exp(-a*7)}this.convolverNode=this.audioContext.createConvolver(),this.convolverNode.buffer=this.implusBuffer,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1.3,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=512,this.frequencyData=new Uint8Array(this.analyser.frequencyBinCount),this.frequencyTexture=new W(this.gl),this.frequencyTexture.setting({type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.LUMINANCE,format:this.gl.LUMINANCE,magFilter:this.gl.LINEAR,minFilter:this.gl.LINEAR,wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE}),this.frequencyTexture.attach({width:this.analyser.frequencyBinCount,height:1,data:this.frequencyData}),R.music.uMusicFreqTex.value=this.frequencyTexture;const r=re.getInstance(O),s=r.renderer&&r.renderer.deferredRenderer;s&&A.assign(s.shading.uniforms,R.music)}render(){this.progress=[0,0],this.currentRender&&this.currentRender.stop(),this.stop(),this.isAudioBufferReady=!1;const n=new ac(this.gl),i=new om(this.gl);i.setBuffer("left",this.bufferL,0),i.setBuffer("right",this.bufferR,1),i.bind(()=>{n.setShader(Hr(xx),Hr(yx),{transformFeedbackVaryings:["o_left","o_right"]})}),n.setUniform("uDuration","1f",[Pr]),n.setUniform("uBPM","1f",[zf]),n.setUniform("uSampleRate","1f",[this.audioContext.sampleRate]);const r=n.getVAO();let s=!0;const o=()=>{s=!1};return r&&(r.setAttribute("aTime",this.bufferIn,1),(()=>{this.isAudioBufferReady=!0;for(let l=0;l<this.numSampleBlocks;l++){if(!s)return;n.setUniform("uTimeOffset","1f",[this.blockLength*l/this.audioContext.sampleRate]),n.use(()=>{n.uploadUniforms(),i.use(()=>{this.gl.beginTransformFeedback(this.gl.POINTS),this.gl.enable(this.gl.RASTERIZER_DISCARD),r.use(()=>{this.gl.drawArrays(this.gl.POINTS,0,r.vertCount)}),this.gl.disable(this.gl.RASTERIZER_DISCARD),this.gl.endTransformFeedback()}),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bufferL.buffer),this.gl.getBufferSubData(this.gl.ARRAY_BUFFER,0,this.tmpOutputArrayL),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bufferR.buffer),this.gl.getBufferSubData(this.gl.ARRAY_BUFFER,0,this.tmpOutputArrayR),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null);for(let u=0;u<this.blockLength;u++){const d=l*this.blockLength+u,h=d<Pr*this.audioContext.sampleRate?1:0;this.audioBuffer.getChannelData(0)[d]=this.tmpOutputArrayL[u]*h,this.audioBuffer.getChannelData(1)[d]=this.tmpOutputArrayR[u]*h}})}})()),{stop:o}}updateImpl(n){if(this.timeCode=n.timeCode,!n.playing||n.timeCode<0){this.stop();return}this.play(n.timeCode,this.forcePlay),this.forcePlay=!1,this.analyser&&this.frequencyData&&this.frequencyTexture&&n.playing&&(this.analyser.getByteFrequencyData(this.frequencyData),this.frequencyTexture.attach({width:this.analyser.frequencyBinCount,height:1,data:this.frequencyData}))}notice(){queueMicrotask(()=>{this.entity&&this.emit("update/music",[this.audioBuffer,this.progress])})}play(n=0,i){this.audioSrcNode&&!i&&Math.abs(this.audioSrcNode.context.currentTime-this.playStartTime-n)<.1||(this.stop(),this.isAudioBufferReady&&(this.audioSrcNode=this.audioContext.createBufferSource(),this.audioSrcNode.buffer=this.audioBuffer,this.audioSrcNode.loop=!1,this.audioSrcNode.start(0,n),this.playStartTime=this.audioSrcNode.context.currentTime-(n||0),this.audioSrcNode.connect(this.gainNode),this.audioSrcNode.connect(this.convolverNode),this.convolverNode.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination),this.analyser&&this.gainNode.connect(this.analyser)))}stop(){this.audioSrcNode&&(this.audioSrcNode.stop(),this.audioSrcNode.disconnect(this.gainNode),this.audioSrcNode=null),this.convolverNode&&this.convolverNode.disconnect()}dispose(){super.dispose(),this.stop(),this.frequencyTexture&&(this.frequencyTexture.dispose(),this.frequencyTexture=null),this.analyser&&(this.analyser.disconnect(),this.analyser=null)}}const _x=1e3,bu={_ic_body:{l:365,i:"x"},_ic_yoji:{l:100,i:"z"},_ic_mayo:{l:150,i:"y"},_ic_eye:{l:0,i:"w"}},Lu={_sub_path1:{l:200,i:"y"},_sub_path2:{l:85,i:"x"},_sub_path3:{l:70,i:"x"},_sub_path4:{l:85,i:"x"},_sub_circle1:{l:0,i:"z"},_sub_circle2:{l:0,i:"z"},_sub_circle3:{l:0,i:"z"},_sub_circle4:{l:0,i:"z"}};class wx extends b{constructor(n){super(n);c(this,"svgWrap");c(this,"elms");c(this,"blidger");c(this,"icGroup");if(this.blidger=null,this.icGroup=null,this.svgWrap=document.createElement("div"),this.svgWrap.innerHTML=`
<svg width="100%" viewBox="0 -50 345 254" fill="none">
<g id="ic">
<path id="ic_body" d="M85.3 30.7C117.2 30.7 143.1 56.8 143.1 89S117.2 147.3 85.3 147.3 27.5 121.2 27.5 89 53.4 30.7 85.3 30.7Z" stroke="#fff" stroke-width="12" stroke-linecap="round"/>
<path id="ic_yoji" d="M153.5 6L99.5 88.8" stroke="#fff" stroke-width="12" stroke-linecap="round"/>
<path id="ic_mayo" d="M4.5 94.7C10.4 85 25.1 62.2 39.4 62.2 57.4 62.2 42.4 98 54.9 98S73.5 67.2 92.9 65.5" stroke="#fff" stroke-width="9" stroke-linecap="round"/>
<g id="ic_eye">
<circle cx="68.3" cy="50.2" fill="#fff" r="4"/>
<circle cx="81.7" cy="50.2" fill="#fff" r="4"/>
</g>
</g>
<g id="sub">
<path id="sub_path1" d="M339.5 127.5C333.7 139.6 321.2 148 306.8 148 286.8 148 270.5 131.9 270.5 112S286.8 76 306.8 76C321.2 76 333.7 84.4 339.5 96.5" stroke="#fff" stroke-width="11" stroke-linecap="round"/>
<path id="sub_path2" d="M239.5 127C233.7 139.4 221.3 148 207 148S180.3 139.4 174.5 127" stroke="#fff" stroke-width="11" stroke-linecap="round"/>
<path id="sub_path3" d="M174.5 96L239.5 127" stroke="#fff" stroke-width="11" stroke-linecap="round"/>
<path id="sub_path4" d="M239.5 96C233.7 84.2 221.3 76 207 76S180.3 84.2 174.5 96" stroke="#fff" stroke-width="11" stroke-linecap="round"/>
<circle id="sub_circle1" cx="211.5" cy="98" fill="#fff" r="4"/>
<circle id="sub_circle2" cx="223.9" cy="98" fill="#fff" r="4"/>
<circle id="sub_circle3" cx="298.5" cy="103" fill="#fff" r="4"/>
<circle id="sub_circle4" cx="286.5" cy="103" fill="#fff" r="4"/>
<g>
</svg>
`,this.svgWrap.style.position="absolute",this.svgWrap.style.width="20%",this.svgWrap.style.top="50%",this.svgWrap.style.left="50%",this.svgWrap.style.transform="translate(-57%,-50%)",this.svgWrap.style.pointerEvents="none",this.svgWrap.style.strokeDasharray=_x+"",this.elms=new Map,[...Object.keys(bu),...Object.keys(Lu)].map(r=>r.slice(1)).forEach(r=>{const s=this.svgWrap.querySelector("#"+r);s&&this.elms.set(r,s)}),this.blidger=this.entity&&this.entity.getComponent(vt)||null,this.icGroup=this.svgWrap.querySelector("#ic"),O.canvas instanceof HTMLCanvasElement){const r=O.canvas.parentElement;r&&r.appendChild(this.svgWrap)}}updateImpl(){if(!this.blidger)return;const n=this.blidger.animations.get("hide");n&&(this.svgWrap.style.display=n.value.x>.5?"none":"block");const i=(o,a)=>{this.elms.forEach((l,u)=>{const d=a["_"+u];if(!d)return;const h=o.value[d.i];l.style.opacity=ct.smoothstep(0,.05,h)*100+"%",d.l&&(l.style.strokeDasharray=d.l+"",l.style.strokeDashoffset=(1-h)*d.l+"")})},r=this.blidger.animations.get("state"),s=this.blidger.animations.get("state2");if(r&&i(r,bu),s&&i(s,Lu),s&&this.icGroup){const o=1-s.value.w,a=o*110,l=o*360;this.icGroup.style.transformOrigin="85px 89px",this.icGroup.style.transform=`translate(${a}px, 0) rotate(${l}deg)`}}dispose(){super.dispose(),this.svgWrap&&this.svgWrap.parentElement&&this.svgWrap.parentElement.removeChild(this.svgWrap),this.blidger=null}}const Sx=`// @shader-file: src/resources/Components/Demo4/Salmon/Onigiri/shaders/onigiri.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
SDFResult D(vec3 v){vec2 r=vec2(udTriangle(v,vec3(0,.5,0),vec3(-.5,-.35,0),vec3(.5,-.35,0)),0);r-=.3;return SDFResult(r.x,v,r.y,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,128,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
outColor.xyz=vec3(1);outRoughness=.5;outColor.xyz*=smoothstep(1.5,.4,length(rayPos));outColor.xyz*=smoothstep(0.,.03,sdBox(rayPos.xy+vec2(0,.4),vec2(.25,.3)));
#include<frag_out>
}`;class ha extends b{constructor(n){super(n);c(this,"mesh");const i=new xt({radius:1}),r=new X({frag:Sx,uniforms:A.merge(R.resolution,R.time)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r})}disposeImpl(){this._entity.removeComponent(B)}}class Cx extends b{constructor(n){super(n);c(this,"onigiri");c(this,"basePosition");c(this,"baseRotation");this.basePosition=this.entity.position.clone(),this.baseRotation=this.entity.euler.clone(),this.onigiri=this.entity.addComponent(ha)}updateImpl(n){const i=n.timeCode;this.entity.euler.y=this.baseRotation.y+Math.sin(i*1)*50,this.entity.euler.x=this.baseRotation.x+Math.sin(i*5)*1,this.entity.euler.z=this.baseRotation.z+Math.cos(i*6.5)*1,this.entity.position.y=this.basePosition.y+Math.abs(Math.sin(i*1))*.1,this.entity.position.x=this.basePosition.x+Math.cos(i*1),this.entity.position.z=this.basePosition.z+Math.sin(i*.5)}disposeImpl(){this._entity.removeComponent(ha)}}const Ex=`// @shader-file: src/resources/Components/Demo4/Party/GreetingCard/shaders/greeting.fs
#include<common>
#include<frag_h>
uniform float uTime;uniform sampler2D uTex;void main(){
#include<frag_in>
vec4 u=texture(uTex,vUv);vec2 v=min(vUv,1.-vUv);float m=length(vUv-.5)*10.;outRoughness=1.;outEmission=(1.-u.x+step(min(v.x*.4,v.y),.05)*.2*sin(uTime*40.))*vec3(.5+.5*cos(m-uTime*20.),.5+.5*cos(m-uTime*25.+2.09439),.5+.5*cos(m-uTime*30.+4.18879))*10.;
#include<frag_out>
}`,Tx=`// @shader-file: src/resources/Components/Demo4/Party/GreetingCard/shaders/greeting.vs
#include<common>
#include<vert_h>
void main(){
#include<vert_in>

#include<vert_out>
}`;class kf extends b{constructor(n){super(n);c(this,"texture",null);c(this,"material",null);c(this,"nameValue","");const i=.3,r=.9,s=new yn({width:i,height:r});this.material=new X({vert:Tx,frag:Ex,uniforms:A.merge(R.time,{uTex:{value:null,type:"1i"}})}),this.entity.addComponent(B,{geometry:s,material:this.material})}set name(n){if(this.nameValue!==n&&(this.nameValue=n,this.texture&&(this.texture.dispose(),this.texture=null),n)){const i=document.createElement("canvas");i.width=128,i.height=384;const r=i.getContext("2d");if(!r)return;r.fillStyle="#FFF",r.fillRect(0,0,i.width,i.height),r.fillStyle="#000",r.textAlign="center",r.textBaseline="middle";const s=n.toUpperCase(),o=i.height-40;let a=42,l=44;s.length*l>o&&(l=o/s.length,a=Math.min(42,l-2)),r.font=`bold ${a}px Noto Sans JP`;const d=(i.height-(s.length-1)*l)/2;for(let h=0;h<s.length;h++){const f=s[h],v=d+h*l;r.fillText(f,i.width/2,v)}this.texture=new W(O).attach(i),this.material&&(this.material.uniforms.uTex.value=this.texture)}}disposeImpl(){this.texture&&(this.texture.dispose(),this.texture=null)}}const zx=`// @shader-file: src/resources/Components/Demo4/Party/Sara/shaders/sara.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
in vec4 vId,vId2;in mat4 vTransformMatrix;in float vDiscard;SDFResult D(vec3 v){vec3 s=v*.8;vec2 o=vec2(length(s.xz)-.3,s.y),r=vec2(1e4,0),i=o;i.xy*=rotate(-1.4);i.y+=.21;r=opAdd(r,vec2(sdBox(vec3(i,0),vec3(.01,.28,1)),0));o.x+=.4;o.y+=.05;r=opAdd(r,vec2(sdBox(vec3(o,0),vec3(.3,.04,.1)),0));return SDFResult(r.x,v,r.y,vec4(0));}
#include<rm_normal>
void main(){if(vDiscard>.5)discard;
#include<frag_in>

#include<rm_ray_obj>
mat4 v=inverse(vTransformMatrix);vec3 r=(v*vec4(rayPos,1)).xyz,s=normalize((v*vec4(rayDir,0)).xyz);SDFResult o;bool z=false;for(int e=0;e<128;e++){o=D(r);r+=o.d*s;if(o.d<.001){z=true;break;}}if(!z)discard;vec3 i=N(r,.01);outNormal=normalize((transpose(v)*vec4(i,0)).xyz);rayPos=(vTransformMatrix*vec4(r,1)).xyz;
#include<rm_out_obj>
float l=vId.x;vec3 m=mix(mix(vec3(.1,.15,.3),vec3(.6,.2,0),smoothstep(0.,.3,l)),vec3(1,.6,0),smoothstep(.3,1.,l));outColor.xyz=mix(m,vec3(.8,.7,.6),smoothstep(.35,.3,length(r)));outRoughness=.3;outEmission.xyz=m*10.*pow(l,3.);outMetalic=0.;
#include<frag_out>
}`,Px=`// @shader-file: src/resources/Components/Demo4/Party/Sara/shaders/sara.vs
#include<common>
#include<vert_h>
layout(location=4)in vec4 id;layout(location=5)in vec4 id2;
#include<rotate>
#include<matrix>
uniform float uTime,uVisibleCount;out vec4 vId,vId2;out mat4 vTransformMatrix;out float vDiscard;void main(){
#include<vert_in>
vec3 v=vec3(0,id.x*2.2,0);v.y+=step(uVisibleCount,id.x*15.)*1e2;mat4 d=makeTranslation(v);vTransformMatrix=d;outPos=(vTransformMatrix*vec4(outPos,1)).xyz;
#include<vert_out>
vId=id;vId2=id2;}`;class ys extends b{constructor(n){super(n);c(this,"uniforms");const i=15,r=new _s({radiusTop:.5,radiusBottom:.5,height:.2}),s=ct.randomSeed(2),o=[],a=[];for(let u=0;u<i;u++)o.push(u/i,s(),s(),s()),a.push(s(),s(),s(),s());r.setAttribute("id",new Float32Array(o),4,{instanceDivisor:1}),r.setAttribute("id2",new Float32Array(a),4,{instanceDivisor:1}),this.uniforms={uVisibleCount:{value:i,type:"1f"}};const l=new X({phase:["deferred","shadowMap"],vert:Px,frag:zx,uniforms:A.merge(R.resolution,R.time,this.uniforms)});this.entity.addComponent(B,{geometry:r,material:l})}}class Mf extends b{constructor(n){super(n);c(this,"saraEntity");c(this,"sushiEntity");c(this,"nigiriComponent",null);c(this,"ikuraGunkanComponent",null);c(this,"greetingEntity");c(this,"greetingComponent");c(this,"sashimiTypeValue","maguro");this.saraEntity=new oe,this.saraEntity.name="Sara";const i=this.saraEntity.addComponent(ys);this.entity.add(this.saraEntity),i&&i.uniforms&&(i.uniforms.uVisibleCount.value=1),this.sushiEntity=new oe,this.sushiEntity.name="Sushi",this.sushiEntity.position.set(0,.15,0),this.entity.add(this.sushiEntity),this.updateSushiComponent(this.sashimiTypeValue),this.greetingEntity=new oe,this.greetingEntity.name="GreetingCard",this.greetingEntity.position.set(-.4,.49,0),this.greetingEntity.euler.y=-Math.PI/4,this.entity.add(this.greetingEntity),this.greetingComponent=this.greetingEntity.addComponent(kf),this.field("sashimiType",()=>this.sashimiTypeValue,r=>{this.sashimiTypeValue=r,this.updateSushiComponent(r)},void 0)}set sashimiType(n){this.setField("sashimiType",n)}set greetingName(n){this.greetingComponent.name=n}updateSushiComponent(n){const i=n==="ikura";if(!(i&&this.ikuraGunkanComponent)){if(!i&&this.nigiriComponent){this.nigiriComponent.sashimiType=n;return}this.nigiriComponent&&(this.sushiEntity.removeComponent(Qi),this.nigiriComponent=null),this.ikuraGunkanComponent&&(this.sushiEntity.removeComponent(gs),this.ikuraGunkanComponent=null),i?(this.ikuraGunkanComponent=this.sushiEntity.addComponent(gs),this.sushiEntity.scale.setScalar(.8)):(this.nigiriComponent=this.sushiEntity.addComponent(Qi),this.nigiriComponent.sashimiType=n,this.nigiriComponent.emission=1,this.sushiEntity.scale.setScalar(1))}}disposeImpl(){this.entity.remove(this.greetingEntity),this.greetingEntity.dispose(),this.entity.remove(this.saraEntity),this.saraEntity.dispose(),this.entity.remove(this.sushiEntity),this.sushiEntity.dispose()}}const Uu=["0b5vr","conspiracy","ctrl-alt-test","doxas","draw();","gam0022","kinakomochi","logicoma","mrdoob","renard","saina","SESSIONS","totetmatt"];class kx extends b{constructor(n){super(n);c(this,"sushiEntities",[]);c(this,"sushiComponents",[]);c(this,"speed",.1);c(this,"rangeX",40);c(this,"sushiCount",18);c(this,"sashimiTypes",["maguro","salmon","ikura","tako"]);this.createSushi()}createSushi(){for(let n=0;n<this.sushiEntities.length;n++)this.entity.remove(this.sushiEntities[n]),this.sushiEntities[n].dispose();this.sushiEntities=[],this.sushiComponents=[];for(let n=0;n<this.sushiCount;n++){const i=new oe;i.name="SushiSara_"+n,this.entity.add(i);const r=i.addComponent(Mf);r.sashimiType=this.sashimiTypes[n%this.sashimiTypes.length],r.greetingName=Uu[n%Uu.length],this.sushiEntities.push(i),this.sushiComponents.push(r)}}updateImpl(n){const i=n.timeCode;for(let r=0;r<this.sushiEntities.length;r++){const s=r/this.sushiCount,o=(i*this.speed+s)%1,a=this.rangeX/2-o*this.rangeX,l=-Math.pow(a,2)*.003;this.sushiEntities[r].position.x=a,this.sushiEntities[r].position.z=l}}disposeImpl(){for(let n=0;n<this.sushiEntities.length;n++)this.entity.remove(this.sushiEntities[n]),this.sushiEntities[n].dispose();this.sushiEntities=[],this.sushiComponents=[]}}class Mx extends b{constructor(n){super(n);c(this,"basePosition");c(this,"isJumping");c(this,"speed");c(this,"height");this.basePosition=this.entity.position.clone(),this.isJumping=!0,this.speed=9,this.height=3;const i=this.entity.getComponent(B);i&&i.material&&i.material.uniforms&&(i.material.uniforms.uParty={value:1,type:"1f"}),this.field("isJumping",()=>this.isJumping,r=>this.isJumping=r)}updateImpl(n){if(!this.isJumping){this.entity.position.y=this.basePosition.y;return}const i=Math.abs(Math.sin(n.timeElapsed*this.speed));this.entity.position.y=this.basePosition.y+i*this.height}}class Rx extends b{constructor(n){super(n);c(this,"musicComponent");c(this,"frequencyData");c(this,"saraEntity");c(this,"samplePosition");this.musicComponent=null,this.frequencyData=null,this.saraEntity=null,this.samplePosition=.5,this.setupSara(),this.field("samplePosition",()=>this.samplePosition,i=>{this.samplePosition=i})}setupSara(){this.saraEntity=new oe,this.saraEntity.name="Sara",this.saraEntity.addComponent(ys),this.entity.add(this.saraEntity)}setupMusicReference(){const n=this.entity.getRootEntity(),i=s=>{const o=s.getComponent(Pf);if(o)return o;for(let a=0;a<s.children.length;a++){const l=i(s.children[a]);if(l)return l}return null},r=i(n);r&&(this.musicComponent=r,this.frequencyData=this.musicComponent.frequencyData)}updateImpl(n){if(!this.musicComponent&&n.playing&&this.setupMusicReference(),this.frequencyData&&n.playing&&this.saraEntity){const i=Math.floor(this.samplePosition*(this.frequencyData.length-1)),r=5;let s=0,o=0;for(let d=-r;d<=r;d++){const h=i+d;h>=0&&h<this.frequencyData.length&&(s+=this.frequencyData[h],o++)}const a=s/o,l=Math.floor(a*2/255*1.2*15),u=this.saraEntity.getComponent(ys);u&&u.uniforms&&(u.uniforms.uVisibleCount.value=l)}}dispose(){super.dispose(),this.saraEntity&&(this.saraEntity.dispose(),this.saraEntity=null)}}const Dx=`// @shader-file: src/resources/Components/Demo4/Party/SushiGeta/shaders/sushiGeta.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
SDFResult D(vec3 v){vec3 r=v;float o=sdBox(r,vec3(.5,.05,.35))-.01;r.x=abs(r.x);r.x-=.3;r.y+=.1;o=opAdd(o,sdBox(r,vec3(.05,.05,.35))-.01);return SDFResult(o,v,0.,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,64,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
outColor.xyz=vec3(1);outRoughness=.5;float o=fbm(rayPos*.4),v=fract(length(rayPos*vec3(.5,1,1)+vec3(-.1,.4,.1))*45.+o*20.);vec3 r=vec3(.8,.55,.25);outColor.xyz=mix(r,r*.9,v);outNormal=normalize(outNormal+v*.2);
#include<frag_out>
}`;class Rf extends b{constructor(n){super(n);c(this,"mesh");const i=new Je({width:1.1,height:.4,depth:1.1}),r=new X({frag:Dx,uniforms:A.merge(R.resolution,R.time)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r})}disposeImpl(){this._entity.removeComponent(B)}}class Fx extends b{constructor(n){super(n);c(this,"getaEntity");c(this,"sushiEntities",[]);this.getaEntity=new oe,this.getaEntity.name="SushiGeta",this.getaEntity.addComponent(Rf),this.entity.add(this.getaEntity);const r=this.entity.name.endsWith("R")?["maguro","salmon","ikura","tako"]:["tako","ikura","salmon","maguro"],s=.25,o=-(r.length-1)*s/2;for(let a=0;a<r.length;a++){const l=new oe;if(l.name="Sushi_"+a,l.position.set(o+a*s,.12,0),l.euler.set(0,-.5,0),l.scale.setScalar(.6),this.entity.add(l),r[a]==="ikura")l.addComponent(gs),l.scale.setScalar(.45);else{const u=l.addComponent(Qi);u.sashimiType=r[a]}this.sushiEntities.push(l)}}disposeImpl(){this.entity.remove(this.getaEntity),this.getaEntity.dispose();for(let n=0;n<this.sushiEntities.length;n++)this.entity.remove(this.sushiEntities[n]),this.sushiEntities[n].dispose()}}const Nx=`// @shader-file: src/resources/Components/Demo4/Salmon/Salmon/shaders/salmon.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<random>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform mat4 uModelViewMatrix;uniform float uTimeE;uniform sampler2D uNoiseTex;uniform vec4 uState;uniform float uParty;float e(vec3 v){vec3 o=v*.8;o.y-=.05;o.xz*=rotate(mix(sin(-v.x-.3+uTimeE*12.)*.5*smoothstep(-1.,1.,v.x),sin(-v.x-.3+uTimeE*12.)*.5,uParty));v=o;v.z*=1.3;v.y+=cos(v.x*PI)*.05;float u=sdVesicaSegment(v,vec3(-.5,0,0),vec3(.5,0,0),.13*cos(v.x+.5));v=o+vec3(.5,0,0);v.y+=pow(v.x,2.)*1.5;v.x*=.1;u=opSmoothSub(sdTriPrism(v,vec2(.022,.2)),u,0.);v=o+vec3(-.26,.13,0);v.x*=.5;v.x-=pow(v.y,2.)*5.;v.xy*=rotate(PI+.6);v.x-=pow(v.y,2.);u=opSmoothAdd(sdTriPrism(v,vec2(.05,.001))-.002,u,.01);v=o+vec3(-.03,-.07,0);v.x*=.5;v.x-=pow(v.y,2.)*6.;v.x-=pow(v.y,2.);u=opSmoothAdd(sdTriPrism(v,vec2(.065,.001))-.002,u,.01);v=o;v.z=abs(v.z);v+=vec3(.14,.09,-.08);v.y+=pow(v.x,2.);v.x+=.03;v.xz*=rotate(.5+sin(uTimeE*3.-v.x*5.)*.2);v.x-=.03;v.xy*=rotate(-1.7);v.y*=.3;u=opSmoothAdd(sdBox(v,vec3(.02+v.y*.5,.03-v.x*.3,.001)),u,.01);v=o;v.y=abs(v.y);v.x-=pow(v.y,1.19)*1.3;v+=vec3(-.48,0,0);v.xy*=rotate(0.);return opSmoothAdd(sdTriPrism(v,vec2(.1,.001))-.002,u,.07);}vec4 s(vec3 x){vec3 v=x*.4,o,u;float s=0.;
#ifdef BLOCK_KIRIMI
v.x+=texture(uNoiseTex,(v.xz+v.x)*.4).x*.05;v.x-=.05;v.y+=.05;o=v;o.y*=1.+cos(o.x*PI*1.3-.6);o.yz*=rotate(HPI);u=o;s=sdCappedCylinder(o,.2,.02);s=opSmoothSub(sdBox(v+vec3(.1,.5,0),vec3(.5)),s,.02);o=v;o.y+=.15;o.x-=.02;o.yz*=rotate(HPI);s=opSmoothSub(sdCappedCylinder(o,.18,.5),s,.01);
#endif

#ifdef BLOCK_SAKU
v.yz*=rotate(.5);v.z+=sin(-uTimeE*6.+v.x*8.)*.03;v.y+=(texture(uNoiseTex,(v.xz+v.x)*.3).x-.3)*.03;v.z+=(texture(uNoiseTex,(v.xy+v.x)*.1).y-.3)*.03;o=v;u=o;o.y+=o.z*.3;s=sdBox(o,vec3(.15,.07,.03));
#endif
return vec4(s,u);}SDFResult D(vec3 v){float o=e(v);o=opSmoothSub(sdBox(v+vec3(1.8-uState.x*2.1,0,0),vec3(1,.5,.5)),o,0.);vec4 u=s(v);u.x=opSmoothSub(sdBox(v+vec3(-.2-uState.x*2.1,0,0),vec3(1,.5,.5)),u.x,0.);float x=opAdd(o,u.x);o=o<u.x?0.:1.;return SDFResult(x,v,o,vec4(u.yyzw));}
#include<subsurface>
#include<rm_normal>
void main(){if(uState.y>=1.)discard;
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,32,0.001,0.7>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec3 v=dist.matparam.yxz;v.yz*=rotate(.5);vec2 x=v.yz*.5+.5;vec4 u=texture(uNoiseTex,x*4.);if(dist.mat<.5){outRoughness=smoothstep(.2,1.,texture(uNoiseTex,x).x);outNormal=normalize(outNormal+u.xyz*.3);vec3 v=vec3(1);float s=smoothstep(.01,.08,rayPos.y-cos(rayPos.x*PI+.15)*.06-u.x*.05+.04);v.xyz=mix(v,vec3(.5),s);outColor.xyz=v;outMetalic=.2;}else{float x=subsurface(rayPos,normalize((vec4(0,1,0,0)*uModelViewMatrix).xyz),.15);outRoughness=.5;outNormal=normalize(outNormal+u.xyz*.5);float v=smoothstep(.19,.2,length(dist.matparam.yzw));outColor.xyz=vec3(1,.4,.2);outEmission.xyz+=vec3(1,.4,.1)*x*1.7*(1.-v);outMetalic=.1;outRoughness=.2;vec3 o=dist.matparam.yzw;outColor.xyz+=smoothstep(.5,1.,fract(length(o*vec3(2,1,1)+vec3(.05+sin(o.y),0,0))*30.))*.1;outColor.xyz=mix(outColor.xyz,vec3(.9)*smoothstep(-.4,.8,rayPos.x),v);}
#include<frag_out>
}`;class Ix extends b{constructor(n){super(n);c(this,"blockType","saku");c(this,"material");this.field("blockType",()=>this.blockType,o=>{this.blockType=o,this.updateMaterialDefines()},{format:void 0});const i=new Je({width:1.5,height:.8,depth:1}),r=new X({frag:Nx,uniforms:A.merge(R.resolution,R.time,R.tex),defines:this.getDefines()}),s=this.entity.addComponent(B,{geometry:i,material:r});Se(s.entity,s),this.material=r}getDefines(){const n={};return this.blockType==="kirimi"?n.BLOCK_KIRIMI="":this.blockType==="saku"&&(n.BLOCK_SAKU=""),n}updateImpl(n){}updateMaterialDefines(){this.material&&(this.material.defines=this.getDefines(),this.material.requestUpdate())}}class Bx extends b{constructor(n){super(n);c(this,"sushiEntity",null);c(this,"blidger",null);this.blidger=this.entity.getComponent(vt)||null,this.sushiEntity=new oe,this.sushiEntity.name="Nigiri",this.sushiEntity.euler.set(0,Math.PI/2,0);const i=this.sushiEntity.addComponent(Qi);i.sashimiType="salmon",this.entity.add(this.sushiEntity)}updateImpl(){if(this.blidger&&this.sushiEntity){const n=this.blidger.animations.get("uState");n&&(this.sushiEntity.visible=n.value.y==1)}}disposeImpl(){this.sushiEntity&&(this.entity.remove(this.sushiEntity),this.sushiEntity.dispose(),this.sushiEntity=null),this.blidger=null}}const Ax=`// @shader-file: src/resources/Components/Demo4/Tako/TakoGate/shaders/takogate.fs
#include<common>
#include<packing>
#include<frag_h>
#include<sdf>
#include<rm_h>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<random>
uniform mat4 uModelViewMatrix;uniform vec4 uState,uPrevState;uniform float uTime,uTimeE,uParty;SDFResult D(vec3 r){float u=1.-uState.x,y=random(gl_FragCoord.xy/1e3),s=mix(uState.y,uPrevState.y,y),z=min(s,1.),v=clamp(s-1.,0.,1.),o=clamp(s-2.,0.,1.);y=clamp(s-3.,0.,1.);for(int e=0;e<4;e++){if(v>.2)r.x=abs(r.x);r.x-=v*.5;r.yz*=rotate(v*PI);r.xz*=rotate(-v*PI/4.+y*.4);r.z-=o*.5;r.yz*=rotate(o*PI);}r.xy*=rotate(u*-length(r.yx)*.4*(1.-z)+uTime*.2);r.xy=pmod(r.xy,1.+z*7.);r.y+=uState.x*5.+sin(uTime+r.y*.5)*.05;u=linearstep(.4,1.,u);r.xz*=rotate(sin(r.y*2.-uTime*2.-1.)*.5*smoothstep(.3,1.,r.y)*u);y=uTimeE*3.*uParty;y=floor(y)+1.-exp(fract(y)*-5.);r.z+=sin(r.y+uTime-y*6.)*.3*u-r.y*.2;r.xz*=1.+noiseValue(vec3(r.y*1.5))*.15;vec3 e=noiseCyc(r*.6);u=1.+1./(linearstep(2.3,-2.3,r.y)+.01);r.xz*=u;y=(.55+e.x*.1)*.5;y=sdRoundedCylinder(r,y,y,10.);r.y*=1.+u*.3;e=r;e.z-=.4;e.x=abs(e.x)-.25;e.y=mod(e.y,.5)-.25;e.xz*=rotate(-.1);e.yz*=rotate(HPI);y=opSmoothAdd(y,sdRoundedCylinder(e,.11,.04,.12+length(e.xz)*.2),.2);y=opSmoothSub(sdSphere(e-vec3(0,.2,0),.05),y,.05);y=opSmoothAdd(sdSphere(e-vec3(0,.13,0),.06),y,.02);y/=u;return SDFResult(y,r.xyz,0.,vec4(0));}
#include<subsurface>
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_screen>
SDFResult r;bool y=false;for(int e=0;e<64;e++){if(uParty>.5&&e>32)break;r=D(rayPos);rayPos+=r.d*rayDir*.7;if(r.d<.001){y=true;break;}}if(!y)discard;outRoughness=.02;outMetalic=0.;vec3 e=r.pos;e.xy*=rotate(HPI/2.);e.yz*=rotate(HPI/2.);outNormal=N(rayPos,.01);vec3 u=r.pos;float z=noiseCyc(u+.5).x,s=smoothstep(.59,.55,u.z);outColor.xyz=mix(vec3(1),vec3(.6,.2,.2)*(.4+z*.5)*.5,s);float o=subsurface(rayPos,normalize(vec4(normalize(-rayPos.xyz),0).xyz),.5);o+=uParty*10.*exp(fract(uTimeE*4.+z*.7)*-5.);outEmission+=outColor.xyz*s;outEmission.xyz+=o*(outColor.xyz+vec3(.5,.1,0))*s;
#include<rm_out_obj>

#include<frag_out>
}`;class bx extends b{constructor(n){super(n);c(this,"mesh");c(this,"prevState");this.prevState=new M,this.mesh=this._entity.addComponent(B,{geometry:new yn({width:2,height:2}),material:new X({phase:["deferred"],vert:As,frag:Ax,uniforms:A.merge(R.time,R.resolution,{uPrevState:{value:this.prevState,type:"4f"}})})}),Se(this.mesh.entity,this.mesh)}afterRenderImpl(n){const i=this.mesh.material.uniforms.uState;i&&i.value&&this.prevState.copy(i.value)}disposeImpl(){this._entity.removeComponent(B)}}const Lx=`// @shader-file: src/resources/Components/Demo4/Tako/TakoKosen/shaders/takokosen.fs
#include<common>
#include<packing>
#include<frag_h>
uniform vec4 uState;void main(){
#include<frag_in>
outColor.xyz+=10.;outColor.w*=uState.y;
#include<frag_out>
}`,Ux=`// @shader-file: src/resources/Components/Demo4/Tako/TakoKosen/shaders/takokosen.vs
#include<common>
#include<vert_h>
uniform vec4 uState;void main(){
#include<vert_in>
outPos.xyz*=uState.x;
#include<vert_out>
}`;class jx extends b{constructor(n){super(n);c(this,"mesh");this.mesh=this._entity.addComponent(B,{geometry:new xt({radius:.5,widthSegments:32,heightSegments:32}),material:new X({phase:["forward"],vert:Ux,frag:Lx,uniforms:A.merge(R.time,R.resolution)})}),Se(this.entity,this.mesh)}updateImpl(n){}disposeImpl(){this._entity.removeComponent(B)}}const Ox=`// @shader-file: src/resources/Components/Demo4/Tsuri/Ocean/shaders/ocean.fs
#include<common>
#include<packing>
#include<frag_h>
#include<sdf>
#include<noise_cyclic>
#include<rm_h>
uniform float uTime;uniform vec4 uState;float n(vec3 e){float f=0.,v=1.,o=1.;for(int u=0;u<4;u++){vec3 s=noiseCyc(e*o*.5+vec3(uTime*.2,0,uTime*.3));f+=v*s.x;v*=.5;o*=2.;}return f;}SDFResult D(vec3 v){float u=0.;vec2 f=v.xz-vec2(0,-9);float o=length(f);if(v.y<.1)u=n(v*.5+vec3(0,sin(o*7.-uTime*15.)*smoothstep(5.,0.,o)*.2,0))*.1;v.y-=sin(clamp(o*3.-uState.x*PI*5.+PI*3.,0.,PI*3.))*.7*smoothstep(4.,0.,o);o=sdPlane(v,vec3(0,1,0),u);return SDFResult(o,v,0.,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_screen>

#include<rm_loop,128,0.05,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec3 o=vec3(0,.3,.5);float v=abs(rayPos.y);o=mix(o,vec3(0,.1,.2),clamp(v,0.,1.));outColor=vec4(o,1);outEmission=vec3(0);outRoughness=.1;outGradient=1.;
#include<frag_out>
}`;class Vx extends b{constructor(n){super(n);c(this,"mesh");this.mesh=this._entity.addComponent(B,{geometry:new Je({width:2,height:2}),material:new X({phase:["deferred"],vert:As,frag:Ox,uniforms:A.merge(R.time,R.resolution)})}),Se(this.mesh.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}const Gx=`// @shader-file: src/resources/Components/Demo4/Tsuri/Taiyaki/shaders/taiyaki.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
#include<rm_h>
uniform mat4 uModelViewMatrix;uniform float uTime,uTimeE,uParty;uniform sampler2D uNoiseTex;uniform vec4 uState;SDFResult D(vec3 s){vec3 v=s;float e=sin(-v.x*3.-.3+uState.x*30.)*.4*uState.y,z=sin(-v.x*3.-.3+uTimeE*10.)*.5*uParty;v.xz*=rotate(z+e);v.yz*=rotate(PI/2.);v.xy*=rotate(PI/2.);vec2 x=v.xz*15.*1.73/2.;x.x*=-1.;vec2 u=x*mat2(1,-1./1.73,0,2./1.73);vec3 o=vec3(u,1.-u.x-u.y),r=floor(o);o=fract(o);if(length(o)>1.)o=1.-o;u=r.xy*mat2(1,.5,0,.865);e=length(u+vec2(1,0)-x);z=length(u+vec2(.5,.865)-x);float f=length(u+vec2(1.5,.865)-x),l=length(u+vec2(2,0)-x);r+=l<1.?vec3(2,0,0):f<1.?vec3(1,1,0):e<1.?vec3(1,0,0):z<1.?vec3(0,1,0):vec3(0);u=x-r.xy*mat2(1,.5,0,.865);o=v;o.x+=.08;o.x*=.7;f=-u.x*1.5*smoothstep(.195,.2,length(o.xz*vec2(1,.7)+vec2(.27,.05)));f=sdRoundedCylinder(o,.12,.04+f*.012,.01);o=v;o.xz*=rotate(-.2);o.xz+=vec2(-.3,.01);o.z*=1.-o.x*2.;o.x+=abs(sin(o.z*37.))*.02;o.x+=cos(o.z*10.)*.05;l=sin(o.z*180.);o.y-=l*.002;f=opSmoothAdd(f,sdRoundBox(o,vec3(.15,.05,.16),.03),.05);o=v;o.xz+=vec2(.3,.07);l=sdRoundedCylinder(o,.015,.02,.045);f=opSmoothAdd(f,l,.01);r=o;l=.04*smoothstep(-.08,.05,length(o.xz));l=sdRoundedCylinder(r,.025,.02,l);f=opSmoothAdd(f,l,.003);o=v;o.xz+=vec2(.39,0);o.xz*=rotate(.25);o.z=abs(o.z);o.z-=.01;o.xz*=rotate(-.25);l=sdRoundBox(o,vec3(.05,.06,.015),.015);f=opSmoothAdd(f,l,.005);o=v;o.xz+=vec2(-.01,.22);o.xz*=rotate(.25);l=sdRoundBox(o,vec3(.15,.035+sin(o.x*2e2)*.002,.07),.03);f=opSmoothAdd(f,l,.015);o=v;o.xz+=vec2(-.1,-.19);o.xz*=rotate(-.5);l=sdRoundBox(o,vec3(.1,.035+sin(o.x*2e2)*.002,.05),.03);f=opSmoothAdd(f,l,.02);o=v;o.xz+=vec2(.11,-.12);o.z*=1.-o.x*3.;float m=.073+o.x*.1+sin(o.z*2e2)*.002,a=sdRoundBox(o,vec3(.1,m,.06),.01);f=opSmoothAdd(f,a,.003);return SDFResult(f,s,0.,vec4(v,0));}
#include<subsurface>
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,50,0.001,0.8>
if(!hit)discard;outNormal=N(rayPos,.002);
#include<rm_out_obj>
vec2 z=dist.matparam.xz+.5;vec4 o=texture(uNoiseTex,z),v=texture(uNoiseTex,z*4.);float f=subsurface(rayPos,normalize((vec4(0,1,0,0)*uModelViewMatrix).xyz),.1);outColor.xyz=mix(vec3(.9,.55,.2),vec3(1,.2,0),o.x*.2+v.x*.1);outColor.xyz=mix(outColor.xyz,vec3(.6,.2,0),smoothstep(.1,.01,abs(dist.matparam.y))*.5);outRoughness=.1+o.x*.3+v.x*.2;outNormal=normalize(outNormal+texture(uNoiseTex,z*8.).xyz*.3);
#include<frag_out>
}`;class Wx extends b{constructor(n){super(n);c(this,"mesh");const i=new Je({width:.4,height:1,depth:1,segmentsDepth:8,segmentsHeight:8,segmentsWidth:2}),r=new X({frag:Gx,uniforms:A.merge(R.resolution,R.time,R.tex)});this.mesh=this.entity.addComponent(B,{geometry:i,material:r}),Se(this.entity,this.mesh)}disposeImpl(){this._entity.removeComponent(B)}}const Hx=`// @shader-file: src/resources/Components/Demo4/Tsuri/Teibo/shaders/teibo.fs
#include<common>
#include<frag_h>
#include<light>
#include<pmrem>
#include<sdf>
#include<rotate>
#include<noise_cyclic>
#include<noise_value>
uniform sampler2D uNoiseTex;
#include<rm_h>
SDFResult D(vec3 v){vec3 s=v,r=noiseCyc(s*vec3(5,1,1));vec2 f=vec2(sdBox(s,vec3(.5,.49-r.x*5e-4,.49-r.x*5e-4))-.005,0);return SDFResult(f.x,v,f.y,vec4(0));}
#include<rm_normal>
void main(){
#include<frag_in>

#include<rm_ray_obj>

#include<rm_loop,32,0.001,1.0>
if(!hit)discard;outNormal=N(rayPos,.01);
#include<rm_out_obj>
vec3 s=rayPos.xyz*3.;vec4 v=vec4(fbm(s*vec3(40,1,7)),fbm(s*vec3(20,1,7)+1e2),fbm(s*vec3(10,1,1)*30.+30.),fbm(s*vec3(10,1,1)*2.+30.));vec3 f=mix(mix(mix(vec3(.5),vec3(.1),v.x*smoothstep(-.5,.7,rayPos.y)*(1.-dot(outNormal,vec3(0,1,0)))),vec3(0),smoothstep(.2,-.3,rayPos.y+smoothstep(.3,1.,v.y)*.3)),vec3(.1),v.z*dot(outNormal,vec3(0,1,0))*v.w);outColor.xyz=f;outRoughness=.7;outColor.xyz*=smoothstep(1.5,.4,length(rayPos));
#include<frag_out>
}`;class $x extends b{constructor(n){super(n);c(this,"mesh");const i=new Je({width:1,height:1,depth:1,segmentsDepth:8,segmentsHeight:8,segmentsWidth:8}),r=new X({frag:Hx,uniforms:A.merge(R.resolution,R.time,{uNoiseTex:R.tex.uNoiseTex})});this.mesh=this.entity.addComponent(B,{geometry:i,material:r})}disposeImpl(){this._entity.removeComponent(B)}}const Xx=`// @shader-file: src/resources/Components/Texture/TextureGenerator/shaders/hash.fs
#include<common>
#include<frag_h>
#include<noise_value>
layout(location=0)out vec4 outColor;void main(){vec2 l=vUv*4e2;outColor.x=hashv(l);outColor.y=hashv(l+1.);outColor.z=hashv(l+2.);outColor.w=hashv(l+3.);}`,Kx=`// @shader-file: src/resources/Components/Texture/TextureGenerator/shaders/noise.fs
#include<common>
#include<frag_h>
#include<noise_value>
layout(location=0)out vec4 outColor;void main(){vec2 v=vUv*15.,f=abs(vUv-.5)*15.;float I=sin(vUv.x*PI)*sin(vUv.y*PI);outColor.x+=mix(fbm(vec3(f,0)),fbm(vec3(v,0)),I);outColor.y+=mix(fbm(vec3(f,100)),fbm(vec3(v,100)),I);outColor.z+=mix(fbm(vec3(f,200)),fbm(vec3(v,200)),I);outColor.w+=mix(fbm(vec3(f,300)),fbm(vec3(v,300)),I);}`,ju=`// @shader-file: src/resources/Components/Texture/TextureGenerator/shaders/noiseCyclic.fs
#include<common>
#include<noise_cyclic>
layout(location=0)out vec4 outColor;in vec2 vUv;uniform float uTimeE;void main(){vec3 v=noiseCyc(vec3(vUv*3.,uTimeE*.5));outColor.xyz=v;}`,Yx=`// @shader-file: src/resources/Components/Texture/TextureGenerator/shaders/noiseSimple.fs
#include<common>
#include<frag_h>
#include<noise_simplex>
uniform float uTimeE;layout(location=0)out vec4 outColor;void main(){vec3 v=vec3(vUv*4.,uTimeE*.3);outColor.x=noiseSimplex(v)*.5+.5;outColor.y=noiseSimplex(v+vec3(100,0,0))*.5+.5;outColor.z=noiseSimplex(v+vec3(0,100,0))*.5+.5;outColor.w=noiseSimplex(v+vec3(0,0,100))*.5+.5;}`;class Qx extends b{constructor(n){super(n);c(this,"updateTextures");this.updateTextures=[];const r=re.getInstance(O).renderer,s=new xi(r,{frag:Kx,resolution:new M(1024,1024)});re.resources.addTexture("noise",s),R.tex.uNoiseTex={type:"1i",value:s};const o=new xi(r,{frag:ju,resolution:new M(1024,1024)});re.resources.addTexture("noiseCyclic",o),R.tex.uNoiseCyclicTex={type:"1i",value:o};const a=new xi(r,{frag:Xx,resolution:new M(512,512)});a.setting({magFilter:O.NEAREST,minFilter:O.NEAREST}),a.render(),re.resources.addTexture("hash",a),R.tex.uHashTex={type:"1i",value:a};const l=new xi(r,{frag:ju,uniforms:re.getInstance(O).uniforms,resolution:new M(512,512)});l.setting({wrapS:O.REPEAT,wrapT:O.REPEAT}),re.resources.addTexture("noiseCyclic_anime",l),this.updateTextures.push(l);const u=new xi(r,{frag:Yx,uniforms:re.getInstance(O).uniforms,resolution:new M(512,512)});u.setting({wrapS:O.REPEAT,wrapT:O.REPEAT}),re.resources.addTexture("noiseSimple_anime",u),R.tex.uNoiseSimpleTex={type:"1i",value:u},this.updateTextures.push(u);const d=r.deferredRenderer;d&&A.assign(d.shading.uniforms,R.tex),this.once("dispose",()=>{this.updateTextures.forEach(h=>{h.dispose()}),this.updateTextures=[]})}updateImpl(){for(let n=0;n<this.updateTextures.length;n++)this.updateTextures[n].render()}}class Zx extends b{constructor(t){super(t)}updateImpl(t){R.time.uTime.value=t.timeCode,R.time.uTimeF.value=t.timeCode%1,R.time.uTimeE.value=t.timeElapsed,R.time.uTimeEF.value=t.timeElapsed%1,R.resolution.uAspectRatio.value=t.resolution.x/t.resolution.y}}const qx={Camera:{MainCamera:My},Demo4:{Common:{DebaBouChou:Dy,HUD:Iy,MizuBall:Ay,Nigiri:Qi,RandomSMG:Ky,ShaderMotionGraphics:Sf,Shari:wf,SkyBox:Qy,TableStage:qy,TruchetSushiLane:ex,Tsuri:{TsuriZao:Ef},UKPAshi:Tf,Ukonpower:rx},Ikura:{IkuraFluids:lx,IkuraGunKan:gs,Kyuuri:px},Maguro:{Maguro:gx,Sashimi:_f},Music:Pf,Outro:{Logo:wx},Party:{BreakDanceOnigiri:Cx,GreetingCard:kf,KaitenSushi:kx,PartyTime:Mx,Sara:ys,SaraAudio:Rx,SushiGeta:Rf,SushiGetaWithNigiri:Fx,SushiSara:Mf},Salmon:{Onigiri:ha,Salmon:Ix,SalmonSushi:Bx},Tako:{TakoGate:bx,TakoKosen:jx},Tsuri:{Ocean:Vx,Taiyaki:Wx,Teibo:$x}},ObjectControls:{LookAt:gf},Texture:{TextureGenerator:Qx},Utilities:{BLidgeClient:yf,UniformControls:Zx}},Jx=()=>{re.resources.clear();const e=(r,s)=>{const o=Object.keys(r);for(let a=0;a<o.length;a++){const l=o[a],u=r[l];if(typeof u=="function")s.addComponent(l,u);else{const d=s.createGroup(l);e(u,d)}}};re.resources.addComponentGroup("Light").addComponent("Light",Tn);const n=qx,i=Object.keys(n);for(let r=0;r<i.length;r++){const s=i[r],o=n[s],a=re.resources.addComponentGroup(s);e(o,a)}},e2="orengine/";class t2 extends De{constructor(){super()}set(t,n){try{const i=JSON.stringify(n);return localStorage.setItem(e2+t,i),fetch("/api/data/save/"+t,{method:"POST",headers:{"Content-Type":"application/json"},body:i})}catch(i){return console.error(i),Promise.reject(i)}}async get(t){try{return await(await fetch("/api/data/get/"+t)).json()}catch{return}}}const kr=new t2;Jx();const n2=()=>{const[e,t]=S.useState(),[n,i]=S.useState();return S.useEffect(()=>{kr.get("project.json").then(r=>{r&&t(r)}),kr.get("editor.json").then(r=>{r&&i(r)}),t(dy)},[]),m.jsx(J0,{gl:O,project:e,children:m.jsx(Z0,{editorData:n,onSave:(r,s)=>{kr.set("project.json",r),kr.set("editor.json",s)}})})};_o.createRoot(document.getElementById("root")).render(m.jsx(m.Fragment,{children:m.jsx(n2,{})}));
